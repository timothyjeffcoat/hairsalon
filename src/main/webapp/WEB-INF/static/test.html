<!DOCTYPE HTML SYSTEM "about:legacy-compat">
<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
<meta content="IE=8;IE=9" http-equiv="X-UA-Compatible" />
<link href="/shop/resources/dojo-1.9.3/dojo/resources/dojo.css"
	type="text/css" rel="stylesheet"></link>
<link href="/shop/resources/dojo-1.9.3/dijit/themes/tundra/tundra.css"
	type="text/css" rel="stylesheet"></link>
<link
	href="/shop/resources/dojo-1.9.3/dojox/grid/enhanced/resources/EnhancedGrid.css"
	type="text/css" rel="stylesheet"></link>
<link
	href="/shop/resources/dojo-1.9.3/dojox/grid/enhanced/resources/tundra/EnhancedGrid.css"
	type="text/css" rel="stylesheet"></link>
<link href="/shop/resources/styles/standard.css" media="screen"
	type="text/css" rel="stylesheet"></link>
<link href="/shop/images/favicon.ico" rel="SHORTCUT ICON"></link>
<script type="text/javascript"
	dojoConfig="parseOnLoad: true, locale: 'en_US'"
	src="/shop/resources/dojo-1.9.3/dojo/dojo.js"></script>
<script type="text/javascript" src="/shop/resources/spring/Spring.js"></script>
<script type="text/javascript"
	src="/shop/resources/spring/Spring-Dojo.js"></script>
<title>Welcome to Scheduleem shop</title>
</head>
<body class="tundra spring">
	<div id="wrapper">
		<div version="2.0" id="header">
			<a title="Home" name="Home" href="/shop/"><div
					style="font-family: 'Rosario', sans-serif; color: 'dark grey'; display: block; font-size: 54px; padding: 2px 0 8px; text-decoration: none; text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.3);"
					class="logo col_7 col">
					Schedule'<i>em</i>
				</div></a>
		</div>
		<div version="2.0" id="menu">
			<ul id="_s_menu">
				<li id="c_shop"><h2></h2>
					<ul>
						<li id="i_shop_schedule"><a title="Schedule"
							href="/shop/myschedule">Schedule</a></li>
						<li id="i_shop_clients"><a title="Clients"
							href="/shop/clients">Clients</a></li>
						<li id="i_shop_staff"><a title="Staff" href="/shop/mystaff">Staff</a></li>
						<li id="i_shop_services"><a title="Services"
							href="/shop/services">Services</a></li>
						<li id="i_shop_settings"><a title="Settings"
							href="/shop/settings">Settings</a></li>
						<li id="i_shop_reports"><a title="Reports"
							href="/shop/reports">Reports</a></li>
						<li id="i_shop_audit"><a title="Recent history"
							href="/shop/audit">Recent history</a></li>
						<li id="security_logout"><a title="Logout"
							href="/shop/static/j_spring_security_logout">Logout</a></li>
					</ul></li>
			</ul>
		</div>
		<div id="main">
			<div version="2.0">
				<link href="/shop/styles/datatables/demo_table.css" type="text/css"
					rel="stylesheet"></link>
				<link href="/shop/styles/datatables/demo_page.css" type="text/css"
					rel="stylesheet"></link>
				<script src="/shop/scripts/jquery-1.5.2.min.js"
					type="text/javascript"></script>
				<script src="/shop/scripts/fullcalendar/gcal.js"
					type="text/javascript" />
				<script src="/shop/scripts/jquery-ui-1.8.11.custom.min.js"
					type="text/javascript" />
				<script src="/shop/scripts/jquery-ui-1.8.11.custom.min.js"
					type="text/javascript"></script>
				<script src="/shop/scripts/datatables/jquery.dataTables.js"
					type="text/javascript"></script>
				<script src="/shop/scripts/able/_loader.js" type="text/javascript"></script>
				<link href="/shop/scripts/jcal/jCal.css" type="text/css"
					rel="stylesheet"></link>
				<script src="/shop/scripts/jcal/jquery.animate.clip.js"
					type="text/javascript"></script>
				<script src="/shop/scripts/jcal/jCal.js" type="text/javascript"></script>
				<script type="text/javascript">
					dojo.provide("dojox");
					dojo.provide("dojo.xhrGet");
					dojo.provide("dojox.io.xhrPlugins");
					dojo.require("dojo.AdapterRegistry");
					dojo.require("dojo._base.xhr");
					dojo.require("dojo.request.xhr");
					dojo.require("dojo.json");
					dojo.require("dijit._Widget");
					dojo.require("dojox.widget.Standby");
					dojo.require("dijit");
					dojo.require("dijit/registry");
					dojo.require("dijit._Contained");
					dojo.require("dijit.layout._LayoutWidget"); // for dijit.layout.marginBox2contentBox()

					dojo.require("dojo.parser");
					dojo.require("dojo.string");
					dojo.require("dojo.html");

					dojo.require("dijit.Dialog");
					dojo.require("dojo.data.ItemFileReadStore");
					dojo.require("dojo.data.ItemFileWriteStore");
					dojo.require("dojox.grid.DataGrid");
					dojo.require("dojox.grid.EnhancedGrid");
					dojo.require("dijit.form.Form");
					dojo.require("dijit.form.Button");
					dojo.require("dijit.form.FilteringSelect");
					dojo.require("dijit.form.ValidationTextBox");
					dojo.require("dijit.form.TextBox");
					dojo.require("dijit.form.DateTextBox");
					dojo.require("dijit.form.CheckBox");
					dojo.require("dijit.form.SimpleTextarea");
					dojo.require("dijit.layout.ContentPane");
					dojo.require("dijit.layout.TabContainer");

					dojo.require("dojox.rpc.Client");
					dojo
							.require("dojox.grid.enhanced.plugins.IndirectSelection");
					dojo.require("dijit.form.RadioButton");
					dojo.require("dijit.Calendar");
					dojo.require("dijit.form.NumberSpinner");
					dojo.require("dojo.date");
					dojo.require("dijit.form.CurrencyTextBox");
					dojo.require("dojo.ready");
				</script>
				<script type="text/javascript">
					var editservicecounter = 0;
					var jCalTargetValue = "";
					var currentselecteddate = "";
					var global_selected_staff = "";
					function appointmentobject(staffid, appointmentstatus,
							appointmentid, appointmentdate, serviceid,
							servicename, price, clientid, firstname, lastname,
							notes, fnctbeginhr, fnctbeginmin, fnctbeginampm,
							fnctendhr, fnctendmin, fnctendampm, service1type,
							recur_parent, request_indicator) {
						this.staffid = staffid;
						this.appointmentstatus = appointmentstatus;
						this.appointmentdate = appointmentdate;
						this.appointmentid = appointmentid;
						this.serviceid = serviceid;
						this.servicename = servicename;
						this.service1type = service1type;
						this.price = price;
						this.clientid = clientid;
						this.firstname = firstname;
						this.lastname = lastname;
						this.notes = notes;
						this.beginhr = fnctbeginhr;
						this.beginmin = fnctbeginmin;
						this.beginampm = fnctbeginampm;
						this.endhr = fnctendhr;
						this.endmin = fnctendmin;
						this.endampm = fnctendampm;
						this.recur_parent = recur_parent;
						this.request_indicator = request_indicator;
					}
					function clientobject(clientid, fullname) {
						this.clientid = clientid;
						this.fullname = fullname;
					}
					function serviceobject(serviceid, description, amountoftime) {
						this.serviceid = serviceid;
						this.description = description;
						this.amountoftime = amountoftime;
					}
					function categoryserviceobject(categoryid, serviceid,
							description, amountoftime) {
						this.categoryid = categoryid;
						this.serviceid = serviceid;
						this.description = description;
						this.amountoftime = amountoftime;
					}
					function servicepriceobject(serviceid, cost) {
						this.serviceid = serviceid;
						this.cost = cost;
					}
					function customservicepriceobject(appointmentid, serviceid,
							cost) {
						this.appointmentid = appointmentid;
						this.serviceid = serviceid;
						this.cost = cost;
					}

					var appointmentsArray = [];
					var clientsArray = [];
					var servicesArray = [];
					var categoryservicesArray = [];
					var servicespricesArray = [];
					var customServicesPricesArray = [];

					var placeholder = "202=Hill Billy";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "3=Jane Doe";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "=";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "4443=Jacket Black";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "1133=Tim Coat";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "194=Sam Walton";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "8200=jeremy benson";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "934=Junior Sayes";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "3421=Dallas Cowboy";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "208=James Brown";
					if (placeholder != "=") {
						var clientcoln = placeholder.indexOf('=');
						var clientid = placeholder.substring(0, clientcoln);
						var clientname = placeholder.substring(clientcoln + 1,
								placeholder.length);
						var newclient = new clientobject(clientid, clientname);
						clientsArray.push(newclient);
					}

					var placeholder = "393223=0.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "=";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "393224=0.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "2=50.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "1=5.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "32774=20.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "393216=250.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "393227=5.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "393225=20.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "393226=10.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "360457=20.0";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var serviceprice = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var serviceprice = new servicepriceobject(serviceid,
								serviceprice);
						servicespricesArray.push(serviceprice);
					}

					var placeholder = "393223=Rest (0)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "=";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "393224=Rest (0)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "2=Rainbow Trout (45)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "1=Haircut (30)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "32774=Red Hair (15)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "393216=Bluehair (90)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "393227=Rest De (60)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "393225=Orange (15)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "393226=White Wash (15)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					var placeholder = "360457=Qst (15)";
					if (placeholder != "=") {
						var servicecoln = placeholder.indexOf('=');
						var serviceid = placeholder.substring(0, servicecoln);
						var servicedescription = placeholder.substring(
								servicecoln + 1, placeholder.length);
						var servicecoln2 = servicedescription.indexOf('(');
						var servicecoln3 = servicedescription.indexOf(')');
						var servicetime = servicedescription.substring(
								servicecoln2 + 1, servicecoln3);
						servicedescription = servicedescription.substring(0,
								servicecoln2);
						var service = new serviceobject(serviceid,
								servicedescription, servicetime);
						servicesArray.push(service);
					}

					function toTitleCase(str) {
						return str.replace(/\w\S*/g, function(txt) {
							return txt.charAt(0).toUpperCase()
									+ txt.substr(1).toLowerCase();
						});
					}
					var StillNeedsValidating = true;
					var svcstandbydlg;
					var standby;
					var av1standby;
					var standbydlg;
					var week_already_loaded = 'false';
					var month_already_loaded = 'false';
					var usethisstore;
					var svcid = "";
					var svcname = "";
					var inputEvents = []; //Global var

					function loadCreate() {
						var createwdgt = dijit.byId("createTab");
						if (createwdgt.get("display") == "none") {
							createwdgt.set("display", "show");
						} else {
							createwdgt.set("display", "block");
						}
						var rawdate = dijit.byId("c_editselectdate").attr(
								"value");
						var postdate = dojo.date.locale.format(rawdate, {
							datePattern : "yyyy-MM-dd",
							selector : "date"
						})
						displayEditTodaysAgenda(postdate);
					}

					function loadMonth() {
						var date = new Date();
						var d = date.getDate();
						var m = date.getMonth();
						var y = date.getFullYear();
						var exists = false;
						try {
							if ($('#monthcalendar').children().length > 0) {
								exists = true;
								$('#monthcalendar').fullCalendar(
										'refetchEvents');
								$('#monthcalendar').fullCalendar(
										'rerenderEvents')
							}
						} catch (e) {
							window.console && console.log(e);
						}
						if (exists == false) {

							$('#monthcalendar')
									.fullCalendar(
											{
												defaultView : 'month',
												editable : true,
												events : function(start, end,
														callback) {
													start = $.fullCalendar
															.formatDate(start,
																	"yyyy-MM-dd");
													end = $.fullCalendar
															.formatDate(end,
																	"yyyy-MM-dd");
													standby.show();
													$.ajaxSetup({
														cache : false
													});
													$
															.getJSON(
																	"myschedule/calendar?date="
																			+ start
																			+ "&enddate="
																			+ end,
																	function(
																			data) {

																		//window.console && console.log("the data: "+data);
																		var events = [];
																		var tdata = JSON
																				.stringify(data);
																		var parsedobjectdata;
																		var isJSON;
																		try {
																			//window.console && console.log(tdata);
																			parsedobjectdata = JSON
																					.parse(tdata);
																			//window.console && console.log(parsedobjectdata);
																			isJSON = true;
																		} catch (e) {
																			isJSON = false;
																		}

																		//window.console && console.log(parsedobjectdata);
																		if (parsedobjectdata.constructor == Array) {
																			var eventcolorbackground = 'yellow';
																			var cntr = 0;
																			for ( var key in parsedobjectdata) {
																				if (global_selected_staff != '') {
																					if (parsedobjectdata[key].staff.id != global_selected_staff) {
																						continue;
																					}
																				}
																				if (parsedobjectdata[key].status == 'CANCELED') {
																					continue;
																				}
																				if (parsedobjectdata[key].status == 'DELETED') {
																					continue;
																				}
																				if (parsedobjectdata[key].status == 'ACTIVE') {
																					eventcolorbackground = 'active';
																				}
																				if (parsedobjectdata[key].status == 'NO_SHOW') {
																					eventcolorbackground = 'no_show';
																				}
																				if (parsedobjectdata[key].status == 'CHECKED_OUT') {
																					eventcolorbackground = 'checked_out';
																				}

																				var month = parsedobjectdata[key].month_ApptDate;
																				var day = parsedobjectdata[key].day_ApptDate;
																				var year = parsedobjectdata[key].year_ApptDate;
																				var bhour = data[key].fc_beginHour;
																				var bminute = data[key].fc_beginMinute;
																				var ehour = data[key].fc_endHour;
																				var eminute = data[key].fc_endMinute;

																				var apptdate = new Date(
																						year,
																						month - 1,
																						day,
																						bhour,
																						bminute);
																				var enddate = new Date(
																						year,
																						month - 1,
																						day,
																						ehour,
																						eminute);

																				var titledesc = "";
																				if (parsedobjectdata[key].client != null) {
																					titledesc = parsedobjectdata[key].client.firstName
																							+ " "
																							+ parsedobjectdata[key].client.lastName
																							+ " ";
																					titledesc = titledesc
																							+ parsedobjectdata[key].servicename1
																							+ " "
																							+ parsedobjectdata[key].service1cost;
																				} else {
																					titledesc = " TIME BLOCK "
																							+ parsedobjectdata[key].personallabel;
																					eventcolorbackground = "timeblock";
																				}

																				//window.console && console.log(apptdate);
																				events
																						.push({
																							title : titledesc,
																							start : apptdate,
																							end : enddate,
																							className : eventcolorbackground,
																							allDay : false
																						});
																			}

																			callback(events);

																		}
																		//window.console && console.log("after jsonify "+tdata);
																		standby
																				.hide();
																	});
													// when data is ready use callback(events);

												},
												eventClick : function(calEvent,
														jsEvent, view) {
													if (event.url) {
														//window.open(event.url);
														alert('event click');
														return false;
													}
												}

											});
						}
					}
					function loadWeek() {
						var date = new Date();
						var d = date.getDate();
						var m = date.getMonth();
						var y = date.getFullYear();
						var variablemintime = 0;
						var variablemaxtime = 24;
						var exists = false;
						try {
							if ($('#weekcalendar').children().length > 0) {
								exists = true;
								$('#weekcalendar')
										.fullCalendar('refetchEvents');
								$('#weekcalendar').fullCalendar(
										'rerenderEvents')
							}
						} catch (e) {
							window.console && console.log(e);
						}
						if (exists == false) {

							$('#weekcalendar')
									.fullCalendar(
											{
												header : {
													left : 'prev,next today',
													center : 'title',
													right : ''
												},
												defaultView : 'agendaWeek',
												editable : true,
												slotMinutes : 15,
												aspectRatio : 0.9,
												firstHour : 10,
												minTime : variablemintime,
												maxTime : variablemaxtime,
												selectable : true,
												selectHelper : true,
												eventClick : function(event) {
													if (event.url) {
														//window.open(event.url);
														alert('event click');
														return false;
													}
												},
												eventRender : function(event,
														element, view) {
													element
															.bind(
																	'click',
																	function() {
																		var day = ($.fullCalendar
																				.formatDate(
																						event.start,
																						'dd'));
																		var month = ($.fullCalendar
																				.formatDate(
																						event.start,
																						'MM'));
																		var year = ($.fullCalendar
																				.formatDate(
																						event.start,
																						'yyyy'));
																		//alert(year+'-'+month+'-'+day);
																	});
												},
												// Clicked on day
												dayClick : function(date,
														allDay, jsEvent, view) {
													//alert('entered day click');
													if (allDay) {
														//alert('Clicked on the entire day: ' + date);
													} else {
														//alert('Clicked on the slot: ' + date);
													}

												},
												// Selected a Time
												select : function(startDate,
														endDate, allDay,
														jsEvent, view) {
													//alert(startDate);
												},
												events : function(start, end,
														callback) {
													start = $.fullCalendar
															.formatDate(start,
																	"yyyy-MM-dd");
													end = $.fullCalendar
															.formatDate(end,
																	"yyyy-MM-dd");
													standby.show();
													$.ajaxSetup({
														cache : false
													});
													$
															.getJSON(
																	"myschedule/calendar?date="
																			+ start
																			+ "&enddate="
																			+ end,
																	function(
																			data) {
																		window.console
																				&& console
																						.log("the data: "
																								+ data);
																		var events = [];
																		var tdata = JSON
																				.stringify(data);
																		var parsedobjectdata;
																		var isJSON;
																		try {
																			window.console
																					&& console
																							.log(tdata);
																			parsedobjectdata = JSON
																					.parse(tdata);
																			window.console
																					&& console
																							.log(parsedobjectdata);
																			isJSON = true;
																		} catch (e) {
																			isJSON = false;
																		}

																		window.console
																				&& console
																						.log(parsedobjectdata);
																		if (parsedobjectdata.constructor == Array) {
																			var eventcolorbackground = 'yellow';
																			var cntr = 0;
																			for ( var key in parsedobjectdata) {
																				if (global_selected_staff != '') {
																					if (parsedobjectdata[key].staff.id != global_selected_staff) {
																						continue;
																					}
																				}
																				if (parsedobjectdata[key].status == 'CANCELED') {
																					continue;
																				}
																				if (parsedobjectdata[key].status == 'DELETED') {
																					continue;
																				}
																				if (parsedobjectdata[key].status == 'ACTIVE') {
																					eventcolorbackground = 'active';
																				}
																				if (parsedobjectdata[key].status == 'NO_SHOW') {
																					eventcolorbackground = 'no_show';
																				}
																				if (parsedobjectdata[key].status == 'CHECKED_OUT') {
																					eventcolorbackground = 'checked_out';
																				}
																				var month = parsedobjectdata[key].month_ApptDate;
																				var day = parsedobjectdata[key].day_ApptDate;
																				var year = parsedobjectdata[key].year_ApptDate;
																				var bhour = data[key].fc_beginHour;
																				var bminute = data[key].fc_beginMinute;
																				var ehour = data[key].fc_endHour;
																				var eminute = data[key].fc_endMinute;

																				var apptdate = new Date(
																						year,
																						month - 1,
																						day,
																						bhour,
																						bminute);
																				var enddate = new Date(
																						year,
																						month - 1,
																						day,
																						ehour,
																						eminute);
																				var titledesc = "";
																				if (parsedobjectdata[key].client != null) {
																					titledesc = parsedobjectdata[key].client.firstName
																							+ " "
																							+ parsedobjectdata[key].client.lastName
																							+ " ";
																					titledesc = titledesc
																							+ parsedobjectdata[key].servicename1
																							+ " "
																							+ parsedobjectdata[key].service1cost;
																				} else {
																					titledesc = " TIME BLOCK "
																							+ parsedobjectdata[key].personallabel;
																					eventcolorbackground = "timeblock";
																				}

																				window.console
																						&& console
																								.log(apptdate);
																				events
																						.push({
																							title : titledesc,
																							start : apptdate,
																							end : enddate,
																							editable : true,
																							className : eventcolorbackground,
																							allDay : false
																						});
																			}

																			callback(events);

																		}
																		window.console
																				&& console
																						.log("after jsonify "
																								+ tdata);
																		standby
																				.hide();
																	});
													// when data is ready use callback(events);

												},
											});
						}
					}
					function destroy(col) {
						window.console
								&& console
										.log('agenda view display: '
												+ $('#agendaview' + col).is(
														':visible'));
						if ($('#agendaview' + col).is(':visible')) {
							toggleVis(col, false);
							//$('#divcollabel'+col).hide();
							//$('#agendaview'+col).fullCalendar( 'destroy' );
							//$('#agendaview'+col).hide();
						} else {
							toggleVis(col, true);
							//$('#divcollabel'+col).show();
							//$('#agendaview'+col).fullCalendar( 'render' );
							//$('#agendaview'+col).fullCalendar('refetchEvents');
							$('#agendaview' + col).fullCalendar(
									'rerenderEvents')

							//$('#agendaview'+col).show();
						}
					}
					function isNumber(n) {
						return !isNaN(parseFloat(n)) && isFinite(n);
					}
					function loadAgenda1(optional_day) {
						window.console
								&& console.log("optional_day: " + optional_day);
						var date = null;
						if (optional_day == undefined) {
							window.console
									&& console
											.log("about to do a new date on jCalTarget");

							window.console
									&& console.log("jCalTarget"
											+ jCalTargetValue);
							date = new Date(jCalTargetValue);

						} else {
							date = optional_day;
						}

						window.console
								&& console.log("loadAgenda1 date: " + date);
						var d = date.getDate();
						if (date != 'Invalid Date') {
							//d = d + 1;
						}
						var m = date.getMonth();
						var y = date.getFullYear();
						var variablemintime = 0;
						var variablemaxtime = 24;
						var exists = false;
						if (av1standby == null) {
							av1standby = new dojox.widget.Standby({
								target : "agendaview1"
							});
							document.body.appendChild(av1standby.domNode);
						}
						try {
							if ($('#agendaview1').children().length > 0) {
								exists = true;
								if (isNumber(y) && isNumber(m) && isNumber(d)) {
									$('#agendaview1').fullCalendar('gotoDate',
											y, m, d);
								}

								$('#agendaview1').fullCalendar('refetchEvents');
								$('#agendaview1')
										.fullCalendar('rerenderEvents');

							}
						} catch (e) {
							window.console && console.log(e);
						}
						if (exists == false) {

							$('#agendaview1')
									.fullCalendar(
											{
												header : {
													left : '',
													center : 'title',
													right : ''
												},
												resources : [

												{
													id : 4603,
													name : 'Blue Clouds'
												}

												,

												{
													id : 4508,
													name : 'Yellow Hat'
												}

												,

												{
													id : 4584,
													name : 'Venus Flytrap'
												}

												,

												{
													id : 4469,
													name : 'White Elephant'
												}

												,

												{
													id : 4527,
													name : 'Silver Back'
												}

												,

												{
													id : 10,
													name : 'Tim Jeffcoat'
												}

												,

												{
													id : 4546,
													name : 'Refresh Anew'
												}

												,

												{
													id : 5980,
													name : 'Dears Sears'
												}

												,

												{
													id : 4450,
													name : 'Black Sheep'
												}

												,

												{
													id : 4489,
													name : 'Hairy Monkey'
												}

												,

												{
													id : 4565,
													name : 'Hard Times'
												}

												],
												defaultView : 'resourceDay',
												editable : true,
												allDaySlot : false,
												axisFormat : 'h(:mm)tt',
												timeFormat : 'h(:mm)tt',
												slotMinutes : 15,
												aspectRatio : 0.9,
												firstHour : 8,
												minTime : variablemintime,
												maxTime : variablemaxtime,
												selectable : true,
												selectHelper : true,
												eventRender : function(event,
														element, view) {
													if (event.requested_image_path != null) {
														if (event.requested_image_path == 'yellow') {
															element
																	.find(
																			'.fc-event-time')
																	.addClass(
																			"afc-event-requested-yellow");
														}
														if (event.requested_image_path == 'red') {
															element
																	.find(
																			'.fc-event-time')
																	.addClass(
																			"afc-event-requested-red");
														}
													}
													element
															.bind(
																	'mouseover',
																	function() {

																		var tooltip = '<div style="width:200px;height:100px;background:yellow;color:blue;position:absolute;z-index:10001;" class="tooltipevetn">name: '
																				+ event.clientfirstname
																				+ ' '
																				+ event.clientlastname
																				+ '<br />service: '
																				+ event.servicename
																				+ '<br />home phone: '
																				+ event.clientphonenumber
																				+ '<br />work phone: '
																				+ event.clientworkphonenumber
																				+ '<br />cell phone: '
																				+ event.clientcellphonenumber
																				+ '</div>';
																		$(
																				"body")
																				.append(
																						tooltip);
																		$(this)
																				.mouseover(
																						function(
																								e) {
																							$(
																									this)
																									.css(
																											'z-index',
																											10000);
																							$(
																									'.tooltipevetn')
																									.fadeIn(
																											'500');
																							$(
																									'.tooltipevetn')
																									.fadeTo(
																											'10',
																											1.9);
																						})
																				.mousemove(
																						function(
																								e) {
																							$(
																									'.tooltipevetn')
																									.css(
																											'top',
																											e.pageY + 10);
																							$(
																									'.tooltipevetn')
																									.css(
																											'left',
																											e.pageX + 20);
																						});

																	});
													element
															.bind(
																	'mouseout',
																	function() {

																		$(this)
																				.css(
																						'z-index',
																						8);
																		$(
																				'.tooltipevetn')
																				.remove();

																	});

													element
															.bind(
																	'click',
																	function() {
																		var day = ($.fullCalendar
																				.formatDate(
																						event.start,
																						'dd'));
																		var month = ($.fullCalendar
																				.formatDate(
																						event.start,
																						'MM'));
																		var year = ($.fullCalendar
																				.formatDate(
																						event.start,
																						'yyyy'));
																		if (event.clientid == '') {
																			displayPersonalDialogForFCCalendar(
																					event,
																					true);
																		} else {
																			dijit
																					.byId(
																							"isThisEditAgendaViewFlag")
																					.set(
																							"value",
																							"true");
																			setEditApptDialogWithFCEvent(event);
																		}
																	});
												},
												// Clicked on day
												//dayClick: function(date, allDay, jsEvent, view) {

												//alert('entered day click');
												//if (allDay) {
												//alert('Clicked on the entire day: ' + date);
												//} else{
												//alert('Clicked on the slot: ' + date);

												//}

												////},
												// Selected a Time
												select : function(startDate,
														endDate, allDay,
														jsEvent, view,
														resourceObj) {
													//alert("Selected times: "+startDate + " to " +endDate + " staff: "+view.id);
													dijit
															.byId(
																	'avChooseTBorCADialog')
															.reset();
													dijit
															.byId(
																	"choosewhattodo_startdatetime")
															.set("value",
																	startDate);
													dijit
															.byId(
																	"choosewhattodo_enddatetime")
															.set("value",
																	endDate);
													dijit
															.byId(
																	"choosewhattodo_staffid")
															.set("value",
																	view.id);
													dijit
															.byId(
																	'isThisADDAgendaViewFlag')
															.set("value",
																	"true");
													setEditTab();
													dijit
															.byId(
																	"avChooseTBorCADialog")
															.show();

												},
												events : function(start, end,
														callback) {
													start = $.fullCalendar
															.formatDate(start,
																	"yyyy-MM-dd");
													end = $.fullCalendar
															.formatDate(end,
																	"yyyy-MM-dd");
													av1standby.show();
													$.ajaxSetup({
														cache : false
													});

													$
															.getJSON(
																	"myschedule/calendar?date="
																			+ start
																			+ "&enddate="
																			+ end,
																	function(
																			data) {
																		window.console
																				&& console
																						.log("the data: "
																								+ data);
																		var events = [];
																		var tdata = JSON
																				.stringify(data);
																		var parsedobjectdata;
																		var isJSON;
																		try {
																			window.console
																					&& console
																							.log(tdata);
																			parsedobjectdata = JSON
																					.parse(tdata);
																			window.console
																					&& console
																							.log(parsedobjectdata);
																			isJSON = true;
																		} catch (e) {
																			isJSON = false;
																		}

																		window.console
																				&& console
																						.log(parsedobjectdata);
																		if (parsedobjectdata.constructor == Array) {
																			customServicesPricesArray = [];
																			var eventcolorbackground = 'yellow';
																			var cntr = 0;
																			for ( var key in parsedobjectdata) {
																				if (global_selected_staff != '') {
																					if (parsedobjectdata[key].staff.id != global_selected_staff) {
																						continue;
																					}
																				}
																				if (parsedobjectdata[key].status == 'CANCELED') {
																					continue;
																				}
																				if (parsedobjectdata[key].status == 'DELETED') {
																					continue;
																				}
																				if (parsedobjectdata[key].status == 'ACTIVE') {
																					eventcolorbackground = 'active';
																				}
																				if (parsedobjectdata[key].status == 'NO_SHOW') {
																					eventcolorbackground = 'no_show';
																				}
																				if (parsedobjectdata[key].status == 'CHECKED_OUT') {
																					eventcolorbackground = 'checked_out';
																				}

																				var month = parsedobjectdata[key].month_ApptDate;
																				var day = parsedobjectdata[key].day_ApptDate;
																				var year = parsedobjectdata[key].year_ApptDate;
																				var bhour = data[key].fc_beginHour;
																				var bminute = data[key].fc_beginMinute;
																				var ehour = data[key].fc_endHour;
																				var eminute = data[key].fc_endMinute;

																				var apptdate = new Date(
																						year,
																						month - 1,
																						day,
																						bhour,
																						bminute);
																				var enddate = new Date(
																						year,
																						month - 1,
																						day,
																						ehour,
																						eminute);
																				var titledesc = "";
																				var staffid = "";
																				var clientid = "";
																				var clientfirstname = "";
																				var clientlastname = "";
																				// BEGIN OF DOAJAX CODE
																				var sbeginetimex = parsedobjectdata[key].s_beginDateTime;
																				var sendetimex = parsedobjectdata[key].s_endDateTime;
																				var iscancelled = false;
																				if (parsedobjectdata[key].cancelled == null
																						|| parsedobjectdata[key].cancelled == 'false') {
																					iscancelled = false;
																				} else {
																					iscancelled = parsedobjectdata[key].cancelled;
																				}
																				var yearapptdate = apptdate
																						.getFullYear();
																				var monthapptdate = apptdate
																						.getMonth() + 1;
																				var dayapptdate = apptdate
																						.getDate();
																				// the realdate is used to set the calendar widget
																				var realdate = new Date(
																						apptdate
																								.getUTCFullYear(),
																						apptdate
																								.getUTCMonth(),
																						apptdate
																								.getUTCDate());
																				var endtime = new Date(
																						parsedobjectdata[key].endDateTime.time);
																				var endhour = endtime
																						.getHours();
																				var endmin = endtime
																						.getMinutes();
																				var eap = "am";
																				if (endhour > 11) {
																					eap = "pm";
																				}
																				if (endhour > 12) {
																					endhour = endhour - 12;
																				}
																				if (endhour == 0) {
																					endhour = 12;
																				}

																				var begintime = new Date(
																						parsedobjectdata[key].beginDateTime.time);
																				var beginhour = begintime
																						.getHours();
																				var beginmin = begintime
																						.getMinutes();
																				var ap = "am";
																				if (beginhour > 11) {
																					ap = "pm";
																				}
																				if (beginhour > 12) {
																					beginhour = beginhour - 12;
																				}
																				if (beginhour == 0) {
																					beginhour = 12;
																				}

																				var coln = sbeginetimex
																						.indexOf(':');
																				// beginhour used to set the value in the begin hour select box
																				beginhour = sbeginetimex
																						.substring(
																								0,
																								coln);
																				beginmin = sbeginetimex
																						.substring(
																								coln + 1,
																								coln + 3);
																				if (beginmin == 0) {
																					beginmin = '00';
																				}
																				// the begin am pm value
																				ap = sbeginetimex
																						.substring(
																								sbeginetimex.length,
																								sbeginetimex.length - 2);

																				// end time
																				var coln = sendetimex
																						.indexOf(':');
																				endhour = sendetimex
																						.substring(
																								0,
																								coln);
																				endmin = sendetimex
																						.substring(
																								coln + 1,
																								coln + 3);
																				if (endmin == 0) {
																					endmin = '00';
																				}
																				eap = sendetimex
																						.substring(
																								sendetimex.length,
																								sendetimex.length - 2);
																				id = parsedobjectdata[key].id;
																				var svccost = "";
																				if (parsedobjectdata[key].service1cost == null) {
																					svccost = "0.00";
																				} else {
																					svccost = parsedobjectdata[key].service1cost;
																					svc1id = parsedobjectdata[key].service1id;
																					window.console
																							&& console
																									.log("loading events for fc calendar svccost: "
																											+ svccost);
																					var custserviceprice = new customservicepriceobject(
																							id,
																							svc1id,
																							svccost);
																					customServicesPricesArray
																							.push(custserviceprice);

																				}

																				if (parsedobjectdata[key].servicename1 == null) {
																				} else {
																					svcname = parsedobjectdata[key].servicename1;
																				}

																				var svctype = "";
																				if (parsedobjectdata[key].service1type == null) {
																				} else {
																					svctype = parsedobjectdata[key].service1type;
																				}

																				if (parsedobjectdata[key].service1id == null) {
																				} else {
																					svcid = parsedobjectdata[key].service1id;
																				}

																				var stateStore = null;
																				id = id
																						.substring(
																								id.length - 2,
																								id.length);

																				var id = "0";
																				id = parsedobjectdata[key].id;

																				var personallabel = '';
																				if (parsedobjectdata[key].personallabel != null) {
																					personallabel = parsedobjectdata[key].personallabel;
																				}

																				var notes = "";
																				if (parsedobjectdata[key].notes == null) {
																				} else {
																					notes = decodeURI(decodeURIComponent(parsedobjectdata[key].notes));
																					if (notes != null) {
																						notes = notes
																								.split(
																										'+')
																								.join(
																										' ');
																					}
																				}
																				// END OF DOAJAX
																				var clientphonenumber = "";
																				clientphonenumber = parsedobjectdata[key].clientphonenumber;
																				if (clientphonenumber == 'undefined') {
																					clientphonenumber = '';
																				}
																				var clientcellphonenumber = "";
																				clientcellphonenumber = parsedobjectdata[key].clientcellphonenumber;
																				if (clientcellphonenumber == 'undefined') {
																					clientcellphonenumber = '';
																				}
																				var clientworkphonenumber = "";
																				clientworkphonenumber = parsedobjectdata[key].clientworkphonenumber;
																				if (clientworkphonenumber == 'undefined') {
																					clientworkphonenumber = '';
																				}

																				if (parsedobjectdata[key].client != null) {
																					clientid = parsedobjectdata[key].client.id;

																					clientfirstname = parsedobjectdata[key].client.firstName;
																					clientlastname = parsedobjectdata[key].client.lastName;
																					titledesc = parsedobjectdata[key].client.firstName
																							+ " "
																							+ parsedobjectdata[key].client.lastName
																							+ " ";
																					titledesc = titledesc
																							+ parsedobjectdata[key].servicename1
																							+ " "
																							+ parsedobjectdata[key].service1cost;
																				} else {
																					titledesc = " TIME BLOCK "
																							+ parsedobjectdata[key].personallabel;
																					eventcolorbackground = "timeblock";
																				}
																				if (parsedobjectdata[key].staff != null) {
																					staffid = parsedobjectdata[key].staff.id;
																				}
																				var recur_parent = parsedobjectdata[key].recur_parent;
																				var requested_image_path = parsedobjectdata[key].requested_image_path;
																				window.console
																						&& console
																								.log("staffid: "
																										+ staffid);
																				window.console
																						&& console
																								.log(apptdate);
																				events
																						.push({
																							requested_image_path : requested_image_path,
																							clientphonenumber : clientphonenumber,
																							clientcellphonenumber : clientcellphonenumber,
																							clientworkphonenumber : clientworkphonenumber,
																							resourceId : parsedobjectdata[key].staff.id,
																							className : eventcolorbackground,
																							textColor : 'white',
																							title : titledesc,
																							realdate : realdate,
																							clientid : clientid,
																							clientfirstname : clientfirstname,
																							clientlastname : clientlastname,
																							appointmentid : id,
																							appointmentnotes : notes,
																							appointmentstatus : ''
																									+ parsedobjectdata[key].status,
																							appointmentdate : apptdate,
																							servicename : svcname,
																							servicetype : svctype,
																							serviceid : svcid,
																							staffid : ''
																									+ staffid,
																							stafffirstname : '',
																							stafflastname : '',
																							personallabel : personallabel,
																							personalreason : personalreason,
																							beginhour : beginhour,
																							beginmin : beginmin,
																							beginampm : ap,
																							endhour : endhour,
																							endmin : endmin,
																							endampm : eap,
																							price : svccost,
																							start : apptdate,
																							end : enddate,
																							editable : true,
																							allDay : false,
																							recur_parent : recur_parent
																						});
																			}

																			callback(events);

																		}
																		window.console
																				&& console
																						.log("after jsonify "
																								+ tdata);
																		av1standby
																				.hide();
																	});

													// when data is ready use callback(events);
													var edittab = dijit
															.byId("editTab");
													//edittab.set("style","height: 750px");

												},
											});
						}
					}
				</script>
				<style>
.afc-event-requested-yellow {
	font-size: 0.7em;
	margin-top: -.1em;
	padding: 2px;
	background: url('images/circular icons/star_yellow.png') no-repeat;
	padding-left: 16px;
}

.afc-event-requested-red {
	font-size: 0.7em;
	margin-top: -.1em;
	padding: 2px;
	background: url('images/circular icons/star_red.png') no-repeat;
	padding-left: 16px;
}

.timeblock,.fc-agend a .timeblock .fc-event-time,.timeblock a {
	background-color: orange; /* background color */
	border-color: Olive; /* border color */
	color: White; /* text color */
}

.timeblock div {
	background-color: orange;
	color: black;
}

.timeblock,.fc-agend a .timeblock .fc-event-time,.timeblock a {
	background-color: orange; /* background color */
	border-color: orange; /* border color DarkMagenta */
	color: White; /* text color */
}

.timeblock div {
	background-color: orange;
}
/* active */
.active,.fc-agend a .active .fc-event-time,.active a {
	background-color: green; /* background color */
	border-color: Olive; /* border color */
	color: White; /* text color */
}

.active div {
	background-color: green;
	color: #F0FFFF;
}

.active,.fc-agend a .active .fc-event-time,.active a {
	background-color: green; /* background color */
	border-color: green; /* border color DarkMagenta */
	color: White; /* text color */
}

.active div {
	background-color: green;
}
/* no_show */
.no_show,.fc-agend a .no_show .fc-event-time,.no_show a {
	background-color: yellow; /* background color */
	border-color: Olive; /* border color */
	color: White; /* text color */
}

.no_show div {
	background-color: yellow;
	color: black;
}

.no_show,.fc-agend a .no_show .fc-event-time,.no_show a {
	background-color: yellow; /* background color */
	border-color: yellow; /* border color DarkMagenta */
	color: White; /* text color */
}

.no_show div {
	background-color: yellow;
}
/* checked_out */
.checked_out,.fc-agend a .checked_out .fc-event-time,.checked_out a {
	background-color: red; /* background color */
	border-color: Olive; /* border color */
	color: White; /* text color */
}

.checked_out div {
	background-color: red;
	color: black;
}

.checked_out,.fc-agend a .checked_out .fc-event-time,.checked_out a {
	background-color: red; /* background color */
	border-color: red; /* border color DarkMagenta */
	color: White; /* text color */
}

.checked_out div {
	background-color: red;
}
/* cancelled */
.cancelled,.fc-agend a .cancelled .fc-event-time,.cancelled a {
	background-color: brown; /* background color */
	border-color: Olive; /* border color */
	color: White; /* text color */
}

.cancelled div {
	background-color: brown;
	color: #F0FFFF;
}

.cancelled,.fc-agend a .cancelled .fc-event-time,.cancelled a {
	background-color: brown; /* background color */
	border-color: brown; /* border color DarkMagenta */
	color: White; /* text color */
}

.cancelled div {
	background-color: brown;
}

agenda.t {
	float: left;
}

table {
	border: 1px solid black;
}

#clearit {
	clear: left;
}

agenda.tr {
	background-color: lightblue
}

.initial {
	background-color: orange;
}

.normal {
	background-color: yellowgreen;
}

.highlight {
	background-color: yellow !important;
	cursor: pointer
}
</style>
				<fieldset style="width: 95%;">
					<legend>Schedule</legend>
					<div id="generalstaff">
						<label for="_staffgeneral"
							class="dijit dijitReset dijitInlineTable dijitLeft ">Filter
							staff: </label><select id="staffgeneral"
							dojoType="dijit.form.FilteringSelect"
							value="{4603=Blue Clouds, 4508=Yellow Hat, 4584=Venus Flytrap, 4469=White Elephant, 4527=Silver Back, 10=Tim Jeffcoat, 4546=Refresh Anew, 5980=Dears Sears, 4450=Black Sheep, 4489=Hairy Monkey, 4565=Hard Times}"
							required="false"
							fetchProperties="{sort:[{attribute:&#39;description&#39;, ascending:true}]}"><option
								value="4603">Blue Clouds</option>
							<option value="4508">Yellow Hat</option>
							<option value="4584">Venus Flytrap</option>
							<option value="4469">White Elephant</option>
							<option value="4527">Silver Back</option>
							<option value="10">Tim Jeffcoat</option>
							<option value="4546">Refresh Anew</option>
							<option value="5980">Dears Sears</option>
							<option value="4450">Black Sheep</option>
							<option value="4489">Hairy Monkey</option>
							<option value="4565">Hard Times</option></select>
					</div>
					<br />
					<div style="height: 2500px; width: 99%;" id="myTabContainer">
						<div style="display: none; height: 2400px;" id="editTab">
							<div>
								<table valign="top" name="months_view_table"
									id="months_view_table">
									<tr>
										<td valign="middle" align="center"><div name="jCalTarget"
												id="jCalTarget">j</div></td>
									</tr>
								</table>
							</div>
							<div>
								<table valign="top" name="agenda_view_table"
									id="agenda_view_table" cellspacing="5" cellpadding="5"
									width="100%" height="100%">
									<tr>
										<td />
									</tr>
									<tr>
										<td><div name="agendaview1" id="agendaview1" /></td>
									</tr>
								</table>
							</div>
							<div style="width: 400px; display: none"
								execute="savePersonal(arguments[0]);" title="Time block"
								id="personalDialog" dojoType="dijit.Dialog">
								<input name="hPersonalSelectDate" id="hPersonalSelectDate"
									type="hidden" dojoType="dijit.form.TextBox" /><input
									name="isThisAgendaViewFlag" id="isThisAgendaViewFlag"
									type="hidden" dojoType="dijit.form.TextBox" /><input
									value="false" name="personaledit" id="personaledit"
									type="hidden" dojoType="dijit.form.TextBox" /><input
									value="false" name="editpersonalapptid" id="editpersonalapptid"
									type="hidden" dojoType="dijit.form.TextBox" />
								<p>
								<div>
									<label for="_personalselectdate_id">Select Date:</label>
								</div>
								<div>
									<input value="" name="c_personalselectdate"
										id="c_personalselectdate" />
								</div>
								<script type="text/javascript">
									Spring
											.addDecoration(new Spring.ElementDecoration(
													{
														elementId : "c_personalselectdate",
														widgetType : "dijit.Calendar",
														widgetAttrs : {
															value : new Date(),
															required : true,
															onValueSelected : function(
																	newValue) {
																document
																		.getElementById("hPersonalSelectDate").value = dojo.date.locale
																		.format(
																				newValue,
																				{
																					datePattern : "yyyy-MM-dd",
																					selector : "date"
																				});

															}
														}
													}));
									Spring
											.addDecoration(new Spring.AjaxEventDecoration(
													{
														elementId : "c_personalselectdate",
														formId : "dateForm",
														event : "onchange",
														params : {
															_eventId : "updateEntries"
														}
													}));
								</script>
								<br />
								<div id="staffstandby_personal">
									<label for="_fapptclient_personal"
										class="dijit dijitReset dijitInlineTable dijitLeft ">Staff
										: </label><select id="fapptstaff_personal"
										dojoType="dijit.form.FilteringSelect"
										value="{4603=Blue Clouds, 4508=Yellow Hat, 4584=Venus Flytrap, 4469=White Elephant, 4527=Silver Back, 10=Tim Jeffcoat, 4546=Refresh Anew, 5980=Dears Sears, 4450=Black Sheep, 4489=Hairy Monkey, 4565=Hard Times}"
										fetchProperties="{sort:[{attribute:&#39;description&#39;, ascending:true}]}"><option
											value="4603">Blue Clouds</option>
										<option value="4508">Yellow Hat</option>
										<option value="4584">Venus Flytrap</option>
										<option value="4469">White Elephant</option>
										<option value="4527">Silver Back</option>
										<option value="10">Tim Jeffcoat</option>
										<option value="4546">Refresh Anew</option>
										<option value="5980">Dears Sears</option>
										<option value="4450">Black Sheep</option>
										<option value="4489">Hairy Monkey</option>
										<option value="4565">Hard Times</option></select>
								</div>
								<br />
								<label for="_personalselecttime_id">Select begin time:</label><select
									style="width: 50px;" invalidMessage="Please select an hour."
									required="true" value="sel" autocomplete="true"
									id="personalhour" name="personalhour"
									dojoType="dijit.form.FilteringSelect"><option
										value="1">1</option>
									<option value="2">2</option>
									<option value="3">3</option>
									<option value="4">4</option>
									<option value="5">5</option>
									<option value="6">6</option>
									<option value="7">7</option>
									<option value="8">8</option>
									<option value="9">9</option>
									<option value="10">10</option>
									<option value="11">11</option>
									<option value="12">12</option></select><select style="width: 50px;"
									invalidMessage="Please select an minute." required="true"
									value="sel" autocomplete="true" id="personalminute"
									name="personalminute" dojoType="dijit.form.FilteringSelect"><option
										value="00">00</option>
									<option value="15">15</option>
									<option value="30">30</option>
									<option value="45">45</option></select><select style="width: 50px;"
									invalidMessage="Please select an am or pm." required="true"
									value="sel" autocomplete="true" id="personalampm"
									name="personalampm" dojoType="dijit.form.FilteringSelect"><option
										value="am">am</option>
									<option value="pm">pm</option></select>
								</p>
								<p>
									<label for="_personalendselecttime_id">Select end time:</label><select
										style="width: 50px;" invalidMessage="Please select an hour."
										required="true" value="sel" autocomplete="true"
										id="personalendhour" name="personalendhour"
										dojoType="dijit.form.FilteringSelect"><option
											value="1">1</option>
										<option value="2">2</option>
										<option value="3">3</option>
										<option value="4">4</option>
										<option value="5">5</option>
										<option value="6">6</option>
										<option value="7">7</option>
										<option value="8">8</option>
										<option value="9">9</option>
										<option value="10">10</option>
										<option value="11">11</option>
										<option value="12">12</option></select><select style="width: 50px;"
										invalidMessage="Please select an minute." required="true"
										value="sel" autocomplete="true" id="personalendminute"
										name="personalendminute" dojoType="dijit.form.FilteringSelect"><option
											value="00">00</option>
										<option value="15">15</option>
										<option value="30">30</option>
										<option value="45">45</option></select><select style="width: 50px;"
										invalidMessage="Please select am or pm." required="true"
										value="sel" autocomplete="true" id="personalendampm"
										name="personalendampm" dojoType="dijit.form.FilteringSelect"><option
											value="am">am</option>
										<option value="pm">pm</option></select>
								</p>
								<p>
									<label for="personalreason">Reason:</label>
								</p>
								<p>
									<input required="true" id="personalreason"
										name="personalreason" type="text"
										dojoType="dijit.form.TextBox" />
								</p>
								<p>
									<label for="personalnotes">Notes:</label>
								</p>
								<p>
									<input id="personalnotes" name="personalnotes" type="text"
										dojoType="dijit.form.SimpleTextarea" />
								</p>
								<div id="savepersonalbutton">
									<button id="personalsavebutton"
										onClick="if(dijit.byId('personalDialog').validate()){;savePersonal();dijit.byId('personalDialog').hide();}"
										type="button" dojoType="dijit.form.Button">Save
										changes</button>
								</div>
								<div style="display: none" id="updatepersonalbutton">
									<button
										onClick="if(dijit.byId('personalDialog').validate()){;updatePersonal();dijit.byId('personalDialog').hide();}"
										type="button" dojoType="dijit.form.Button">Update</button>
									<button
										onClick="dijit.byId('personalDialog').hide();deletePersonal();dijit.byId('personalDialog').reset();"
										type="button" dojoType="dijit.form.Button">Delete</button>
								</div>
							</div>
							<div style="display: none" title="Choose what to do"
								id="avChooseTBorCADialog" dojoType="dijit.Dialog">
								<input id="choosewhattodo_startdatetime" type="hidden"
									dojoType="dijit.form.TextBox" /><input
									id="choosewhattodo_enddatetime" type="hidden"
									dojoType="dijit.form.TextBox" /><input
									id="choosewhattodo_staffid" type="hidden"
									dojoType="dijit.form.TextBox" />
								<button
									onClick="addTimeBlockDialog();dijit.byId('avChooseTBorCADialog').hide();"
									type="button" id="addtimeblockbutton"
									dojoType="dijit.form.Button">Add time block</button>
								<button
									onClick="createAppointmentForAgendaView();dijit.byId('avChooseTBorCADialog').hide();"
									type="button" id="createappointmentbutton"
									dojoType="dijit.form.Button">Create an appointment</button>
							</div>
							<div style="display: none"
								execute="updateAppointment(arguments[0]);"
								title="Full Edit Appointment" id="editApptDialog"
								dojoType="dijit.Dialog">
								<div style="height: 800px; width: 640px;"
									id="myRecurTabContainer">
									<div id="editDialogTab1">
										<table>
											<tr>
												<td><input name="isThisEditAgendaViewFlag"
													id="isThisEditAgendaViewFlag" type="hidden"
													dojoType="dijit.form.TextBox" /><input
													name="isThisADDAgendaViewFlag" id="isThisADDAgendaViewFlag"
													type="hidden" dojoType="dijit.form.TextBox" /><input
													id="editdialogsvcid" type="hidden"
													dojoType="dijit.form.TextBox" /><input
													id="editdialogapptid" type="hidden"
													dojoType="dijit.form.TextBox" /><input
													id="editdialogservice" type="hidden"
													dojoType="dijit.form.TextBox" /><input
													id="edit_recur_parent" type="hidden"
													dojoType="dijit.form.TextBox" /><input
													id="editdialogservicetype" type="hidden"
													dojoType="dijit.form.TextBox" /><input
													name="hEditSelectDate" id="hEditSelectDate" type="hidden"
													dojoType="dijit.form.TextBox" />
												<div id="dropdownButtonContainer">Request indicator:</div>
													<div>
														<label for="_editselectdate_id">Select Date:</label>
													</div>
													<div>
														<input value="" name="c_editselectdate"
															id="c_editselectdate" />
													</div>
													<script type="text/javascript">
														Spring
																.addDecoration(new Spring.ElementDecoration(
																		{
																			elementId : "c_editselectdate",
																			widgetType : "dijit.Calendar",
																			widgetAttrs : {
																				value : new Date(),
																				required : true,
																				onValueSelected : function(
																						newValue) {

																					document
																							.getElementById("hEditSelectDate").value = dojo.date.locale
																							.format(
																									newValue,
																									{
																										datePattern : "yyyy-MM-dd",
																										selector : "date"
																									});

																				}
																			}
																		}));
													</script>
													<div id="staffstandby_personal">
														<label for="_fapptclient_edit"
															class="dijit dijitReset dijitInlineTable dijitLeft ">Staff
															: </label><select id="fapptstaff_edit"
															dojoType="dijit.form.FilteringSelect"
															value="{4603=Blue Clouds, 4508=Yellow Hat, 4584=Venus Flytrap, 4469=White Elephant, 4527=Silver Back, 10=Tim Jeffcoat, 4546=Refresh Anew, 5980=Dears Sears, 4450=Black Sheep, 4489=Hairy Monkey, 4565=Hard Times}"
															fetchProperties="{sort:[{attribute:&#39;description&#39;, ascending:true}]}"><option
																value="4603">Blue Clouds</option>
															<option value="4508">Yellow Hat</option>
															<option value="4584">Venus Flytrap</option>
															<option value="4469">White Elephant</option>
															<option value="4527">Silver Back</option>
															<option value="10">Tim Jeffcoat</option>
															<option value="4546">Refresh Anew</option>
															<option value="5980">Dears Sears</option>
															<option value="4450">Black Sheep</option>
															<option value="4489">Hairy Monkey</option>
															<option value="4565">Hard Times</option></select>
													</div>
													<p />
													<div>
														<label for="_editclientname_id">Client name:</label>
													</div>
													<p>
													<div>
														<select id="c_editclientname_id" tabindex="1"
															dojoType="dijit.form.FilteringSelect"
															value="{202=Hill Billy, 3=Jane Doe, =, 4443=Jacket Black, 1133=Tim Coat, 194=Sam Walton, 8200=jeremy benson, 934=Junior Sayes, 3421=Dallas Cowboy, 208=James Brown}"
															fetchProperties="{sort:[{attribute:&#39;description&#39;, ascending:true}]}"
															disabled="disabled"><option value="202">Hill
																Billy</option>
															<option value="3">Jane Doe</option>
															<option value=""></option>
															<option value="4443">Jacket Black</option>
															<option value="1133">Tim Coat</option>
															<option value="194">Sam Walton</option>
															<option value="8200">jeremy benson</option>
															<option value="934">Junior Sayes</option>
															<option value="3421">Dallas Cowboy</option>
															<option value="208">James Brown</option></select>
														<button
															data-dojo-props="label:'add new client',onClick:function(){addnewclient(arguments[0]);}"
															data-dojo-type="dijit.form.Button">add new
															client</button>
													</div>
													</p>
													<p>
														<label for="_editselecttime_id">Select begin time:</label><select
															style="width: 50px;" value="sel" autocomplete="true"
															id="fedithour" name="fedithour"
															dojoType="dijit.form.FilteringSelect"><option
																value="1">1</option>
															<option value="2">2</option>
															<option value="3">3</option>
															<option value="4">4</option>
															<option value="5">5</option>
															<option value="6">6</option>
															<option value="7">7</option>
															<option value="8">8</option>
															<option value="9">9</option>
															<option value="10">10</option>
															<option value="11">11</option>
															<option value="12">12</option></select><select
															style="width: 50px;" value="sel" autocomplete="true"
															id="editminute" name="editminute"
															dojoType="dijit.form.FilteringSelect"><option
																value="00">00</option>
															<option value="15">15</option>
															<option value="30">30</option>
															<option value="45">45</option></select><select
															style="width: 50px;" value="sel" autocomplete="true"
															id="editampm" name="editampm"
															dojoType="dijit.form.FilteringSelect"><option
																value="am">am</option>
															<option value="pm">pm</option></select>
													</p>
													<p>
														<label for="_editendselecttime_id">Select end time
															(optional):</label><select style="width: 50px;" value="sel"
															autocomplete="true" id="fendedithour" name="fendedithour"
															dojoType="dijit.form.FilteringSelect"><option
																value="select">Select</option>
															<option value="1">1</option>
															<option value="2">2</option>
															<option value="3">3</option>
															<option value="4">4</option>
															<option value="5">5</option>
															<option value="6">6</option>
															<option value="7">7</option>
															<option value="8">8</option>
															<option value="9">9</option>
															<option value="10">10</option>
															<option value="11">11</option>
															<option value="12">12</option></select><select
															style="width: 50px;" value="sel" autocomplete="true"
															id="endeditminute" name="endeditminute"
															dojoType="dijit.form.FilteringSelect"><option
																value="select">Select</option>
															<option value="00">00</option>
															<option value="15">15</option>
															<option value="30">30</option>
															<option value="45">45</option></select><select
															style="width: 50px;" value="sel" autocomplete="true"
															id="endeditampm" name="endeditampm"
															dojoType="dijit.form.FilteringSelect"><option
																value="select">Select</option>
															<option value="am">am</option>
															<option value="pm">pm</option></select>
													</p></td>
												<td><div id="editapptservicesdiv">
														<p>
															<label>Filter by Category</label><select
																id="editcategories"
																dojoType="dijit.form.FilteringSelect"
																fetchProperties="{sort:[{attribute:&#39;description&#39;, ascending:true}]}"><option
																	value="0">All</option></select>
														</p>
														<p>
															<label>Service</label><select id="editselect"
																tabindex="2" dojoType="dijit.form.FilteringSelect"
																fetchProperties="{sort:[{attribute:&#39;description&#39;, ascending:true}]}"><option
																	value="393223">Rest (0)</option>
																<option value=""></option>
																<option value="393224">Rest (0)</option>
																<option value="2">Rainbow Trout (45)</option>
																<option value="1">Haircut (30)</option>
																<option value="32774">Red Hair (15)</option>
																<option value="393216">Bluehair (90)</option>
																<option value="393227">Rest De (60)</option>
																<option value="393225">Orange (15)</option>
																<option value="393226">White Wash (15)</option>
																<option value="360457">Qst (15)</option></select>
														</p>
														<p>
															<label for="editdialogprice">Price:</label>
														</p>
														<p>
															<input id="editdialogprice" name="editdialogprice"
																type="text" dojoType="dijit.form.CurrencyTextBox" />
														</p>
														<p>
															<label for="editdialognotes">Notes:</label>
														</p>
														<p>
															<input id="editdialognotes" name="editdialognotes"
																type="text" dojoType="dijit.form.SimpleTextarea" />
														</p>
														<button style="color: Blue;" id="editsavebutton"
															onClick="if(dijit.byId('editApptDialog').validate()){updateAppointment();}"
															type="button" dojoType="dijit.form.Button" tabindex="3">Save
															changes</button>
														<button style="color: Green;"
															onClick="dijit.byId('editApptDialog').hide();saveAndCheckout();dijit.byId('editApptDialog').reset();dijit.byId('progButton').set('label','Select one');dijit.byId('progButton').set('value','');"
															type="button" id="editcobutton"
															dojoType="dijit.form.Button">Check out</button>
														<p />
														<button style="color: Chocolate;"
															onClick="dijit.byId('editApptDialog').hide();cancelAppointment();dijit.byId('editApptDialog').reset();dijit.byId('progButton').set('label','Select one');dijit.byId('progButton').set('value','');"
															type="button" id="editcancelbutton"
															dojoType="dijit.form.Button">Cancel appointment</button>
														<button style="color: Brown;"
															onClick="dijit.byId('editApptDialog').hide();noShowAppointment();dijit.byId('editApptDialog').reset();dijit.byId('progButton').set('label','Select one');dijit.byId('progButton').set('value','');"
															type="button" id="editnsbutton"
															dojoType="dijit.form.Button">No Show</button>
													</div></td>
											</tr>
										</table>
									</div>
									<script type="text/javascript">
										Spring
												.addDecoration(new Spring.ElementDecoration(
														{
															elementId : 'editDialogTab1',
															widgetType : 'dijit.layout.ContentPane',
															widgetAttrs : {
																title : 'Basic',
																selected : true
															}
														}));
									</script>
									<div id="editDialogTab2">
										<div style="display: none" id="editDialogTab2Message">
											Recurring is not available for edited appointments.</div>
										<div style="display: block" name="hideShowRecur"
											id="hideShowRecur">
											<fieldset style="width: 95%;">
												<div>
													<table>
														<tr>
															<td width="5%"><input
																data-dojo-props="checked: false"
																data-dojo-type="dijit.form.CheckBox" name="enable_recur"
																id="enable_recur" type="checkbox" /></td>
															<td>Enable recurring appointment</td>
														</tr>
													</table>
												</div>
												<div id="recur_div">
													<script type="text/javascript">
														dojo
																.require('dijit.TitlePane');
													</script>
													<div id="_title_recur_pattern_panel_id">
														<script type="text/javascript">
															Spring
																	.addDecoration(new Spring.ElementDecoration(
																			{
																				elementId : '_title_recur_pattern_panel_id',
																				widgetType : 'dijit.TitlePane',
																				widgetAttrs : {
																					title : 'Recurrence pattern',
																					open : true
																				}
																			}));
														</script>
														<table>
															<tr>
																<td><input data-dojo-props="disabled:true"
																	data-dojo-type="dijit.form.RadioButton" value="daily"
																	id="daily" name="group1" type="radio" />Daily</td>
																<td span="2"><input data-dojo-props="disabled:true"
																	data-dojo-type="dijit.form.RadioButton" value="every"
																	id="every" name="group1" type="radio" />Every <input
																	data-dojo-props="disabled:true" smallDelta="1"
																	value="1" required="false" id="everytext"
																	dojoType="dijit.form.NumberSpinner" />day(s)</td>
																<td><input data-dojo-props="disabled:true"
																	data-dojo-type="dijit.form.RadioButton" value="every"
																	id="everyweekday" name="group1" type="radio" />Every
																	weekday</td>
															</tr>
														</table>
														<table>
															<tr>
																<td><input data-dojo-props="disabled:true"
																	data-dojo-type="dijit.form.RadioButton" value="weekly"
																	id="weekly" name="group1" type="radio" />Weekly</td>
																<td span="3"><input data-dojo-props="disabled:true"
																	data-dojo-type="dijit.form.RadioButton"
																	value="weeklyevery" id="weeklyevery" name="group1"
																	type="radio" />Every <input
																	data-dojo-props="disabled:true" smallDelta="1"
																	value="1" required="false" id="weeklyeverytext"
																	dojoType="dijit.form.NumberSpinner" />week(s) on
																	<table>
																		<tr>
																			<td>Sunday<input
																				data-dojo-props="disabled:true,checked: false"
																				data-dojo-type="dijit.form.CheckBox" value="sunday"
																				id="everyweekdaysu" name="group3" type="checkbox" />
																				Monday<input
																				data-dojo-props="disabled:true,checked: false"
																				data-dojo-type="dijit.form.CheckBox" value="monday"
																				id="everyweekdaymo" name="group3" type="checkbox" />
																				Tuesday<input
																				data-dojo-props="disabled:true,checked: false"
																				data-dojo-type="dijit.form.CheckBox" value="tuesday"
																				id="everyweekdaytu" name="group3" type="checkbox" />
																				Wednesday<input
																				data-dojo-props="disabled:true,checked: false"
																				data-dojo-type="dijit.form.CheckBox"
																				value="wednesday" id="everyweekdaywe" name="group3"
																				type="checkbox" /> Thursday<input
																				data-dojo-props="disabled:true,checked: false"
																				data-dojo-type="dijit.form.CheckBox"
																				value="thursday" id="everyweekdaythu" name="group3"
																				type="checkbox" /> Friday<input
																				data-dojo-props="disabled:true,checked: false"
																				data-dojo-type="dijit.form.CheckBox" value="friday"
																				id="everyweekdayfri" name="group3" type="checkbox" />
																				Saturday<input
																				data-dojo-props="disabled:true,checked: false"
																				data-dojo-type="dijit.form.CheckBox"
																				value="saturday" id="everyweekdaysat" name="group3"
																				type="checkbox" /></td>
																		</tr>
																	</table></td>
															</tr>
														</table>
														<table>
															<tr>
																<td><input data-dojo-props="disabled:true"
																	data-dojo-type="dijit.form.RadioButton" value="monthly"
																	id="monthly" name="group1" type="radio" />Monthly</td>
																<td span="2"><table>
																		<tr>
																			<td><input data-dojo-props="disabled:true"
																				data-dojo-type="dijit.form.RadioButton"
																				value="everyday" id="everyday" name="group1"
																				type="radio" />Day <input
																				data-dojo-props="disabled:true" smallDelta="1"
																				value="1" required="false" id="everymonthdaytext"
																				dojoType="dijit.form.NumberSpinner" />of every <input
																				data-dojo-props="disabled:true" smallDelta="1"
																				value="1" required="false" id="everymonthtext"
																				dojoType="dijit.form.NumberSpinner" />month(s)</td>
																		</tr>
																		<tr>
																			<td span="2"><input
																				data-dojo-props="disabled:true"
																				data-dojo-type="dijit.form.RadioButton"
																				value="everyregex" id="everyregex" name="group1"
																				type="radio" />The <select disabled="disabled"
																				style="width: 100px;" value="sel"
																				autocomplete="true" id="everynthdaytext"
																				name="everynthdaytext"
																				dojoType="dijit.form.FilteringSelect"><option
																						selected="selected" value="sel">Select</option>
																					<option value="1">first</option>
																					<option value="2">second</option>
																					<option value="3">third</option>
																					<option value="4">fourth</option>
																					<option value="5">fifth</option></select><select
																				disabled="disabled" style="width: 100px;"
																				value="sel" autocomplete="true"
																				id="everynthmonthtext" name="everynthmonthtext"
																				dojoType="dijit.form.FilteringSelect"><option
																						selected="selected" value="sel">Select</option>
																					<option value="1">Sunday</option>
																					<option value="2">Monday</option>
																					<option value="3">Tuesday</option>
																					<option value="4">Wednesday</option>
																					<option value="5">Thursday</option>
																					<option value="6">Friday</option>
																					<option value="7">Saturday</option></select> of every <input
																				data-dojo-props="disabled:true" smallDelta="1"
																				value="1" required="false"
																				id="everyhowmanymonthtext"
																				dojoType="dijit.form.NumberSpinner" />month(s)</td>
																		</tr>
																	</table></td>
																<td />
															</tr>
														</table>
													</div>
													<script type="text/javascript">
														dojo
																.require('dijit.TitlePane');
													</script>
													<div id="_title_recur_range_panel_id">
														<script type="text/javascript">
															Spring
																	.addDecoration(new Spring.ElementDecoration(
																			{
																				elementId : '_title_recur_range_panel_id',
																				widgetType : 'dijit.TitlePane',
																				widgetAttrs : {
																					title : 'Range of recurrence',
																					open : true
																				}
																			}));
														</script>
														<form id="myform">
															<table>
																<tr>
																	<td><table>
																			<tr>
																				<td><input data-dojo-props="disabled:true"
																					data-dojo-type="dijit.form.RadioButton"
																					value="every" id="endafter" name="rangegroup"
																					type="radio" /> End after : <input
																					data-dojo-props="disabled:true" smallDelta="1"
																					value="1" required="false" id="endafterxoccur"
																					dojoType="dijit.form.NumberSpinner" /> ocurrences</td>
																			</tr>
																			<tr>
																				<td><input data-dojo-props="disabled:true"
																					data-dojo-type="dijit.form.RadioButton"
																					value="every" id="everydate" name="rangegroup"
																					type="radio" /> End by: <input
																					data-dojo-props="disabled: true,required: false"
																					data-dojo-type="dijit.form.DateTextBox"
																					name="rangerecurEndDate" type="text"
																					id="rangerecurEndDate" /></td>
																			</tr>
																		</table></td>
																</tr>
															</table>
														</form>
													</div>
												</div>
											</fieldset>
										</div>
									</div>
									<script type="text/javascript">
										Spring
												.addDecoration(new Spring.ElementDecoration(
														{
															elementId : 'editDialogTab2',
															widgetType : 'dijit.layout.ContentPane',
															widgetAttrs : {
																title : 'Recurring',
																selected : true
															}
														}));
									</script>
								</div>
							</div>
						</div>
						<script type="text/javascript">
							Spring.addDecoration(new Spring.ElementDecoration({
								elementId : 'editTab',
								widgetType : 'dijit.layout.ContentPane',
								widgetAttrs : {
									title : 'Create / Edit Appointments',
									selected : true
								}
							}));
						</script>
						<script type="text/javascript">
							/*
							creates a json object from the data input
							 */
							function Trax(response) {
								var isJSON;
								var data;
								try {
									//window.console && console.log(response);
									data = JSON.parse(response);
									window.console && console.log(data);
									isJSON = true;
								} catch (e) {
									isJSON = false;
								}

								if (isJSON) {
									// data is already parsed, so just use it
									// handle response codes
									// do something with returned data

									if (data.constructor == Array) {

										var cntr = 0;
										var myCars = new Array(); // regular array (add an optional integer
										for ( var key in data) {
											bigdata = new Object();
											bigdata.id = data[key].id;
											bigdata.description = data[key].description
													+ " ("
													+ data[key].amounttime
													+ ")";

											myCars[cntr] = bigdata;
											cntr = cntr + 1;
										}
										person = new Object();
										person.items = myCars;
										person.identifier = 'id';
										person.label = 'description';
										return person;

									} else {
										window.console && console.log(data.id);
										window.console
												&& console.log(data.value);
										bigdata = new Object();
										bigdata.id = data.id;
										bigdata.description = data.description;

										var myCars = new Array(); // regular array (add an optional integer
										myCars[0] = bigdata;

										person = new Object();
										person.items = myCars;
										person.identifier = 'id';
										person.label = 'description';
										return person;

									}
								}
							}
							function fillServices(id) {

								window.console && console.log("svcid " + id);

								standbydlg = new dojox.widget.Standby({
									target : "editApptDialog"
								});
								document.body.appendChild(standbydlg.domNode);
								standbydlg.show();
								var deferred = dojo
										.xhrGet({
											url : "myschedule/jsonapptsvc?apptid="
													+ id,
											handleAs : "json",
											preventCache : true,
											load : function(data, newValue) {
												window.console
														&& console
																.log("the data: "
																		+ data);
												var svcid = data[0].id;
												var svcname = data[0].amounttime;
												stateStore = data;
												var tdata = Trax(JSON
														.stringify(stateStore));

												var pstore = new dojo.data.ItemFileReadStore(
														{
															'data' : tdata
														});
												window.console
														&& console.log(tdata);

												try {
													var widg1 = dijit
															.byId('editApptDialog');
													var cwidget = dijit
															.byId("editselect");
													if (cwidget) {
														cwidget.reset();
														dijit
																.byId(
																		'progButton')
																.set('label',
																		'Select one');
														dijit
																.byId(
																		'progButton')
																.set('value',
																		'');
														cwidget.store = pstore;
														cwidget.setValue(svcid);
													} else {
														var box = new dijit.form.FilteringSelect(
																{
																	id : "editselect",
																	name : "service",
																	value : svcid,
																	displayedValue : svcname,
																	autocomplete : true,
																	required : true,
																	onChange : function(
																			action) {
																		setEditEndTime();
																	},
																	store : pstore,
																	searchAttr : "description"
																}, "editselect");
														box.setValue(svcid);
													}

													window.console
															&& console
																	.log(widg1);
												} catch (e) {
													var box = new dijit.form.FilteringSelect(
															{
																id : "editselect",
																name : "service",
																autocomplete : true,
																value : svcid,
																displayedValue : svcname,
																required : true,
																onChange : function(
																		action) {
																	setEditEndTime();
																},
																store : pstore,
																searchAttr : "description"
															}, "editselect");
													box.setValue(svcid);
												}
												standbydlg.hide();
												return data;
											},
											error : function(error) {
												window.console
														&& console
																.log("An unexpected error occurred: "
																		+ error);
												standbydlg.hide();
												window.location.reload();
											}
										});
								return deferred;
							}
							function addTimeBlockDialog() {
								var cwtd_startdatetime = dijit.byId(
										"choosewhattodo_startdatetime").attr(
										"value");
								var cwtd_enddatetime = dijit.byId(
										"choosewhattodo_enddatetime").attr(
										"value");
								var cwtd_staffid = dijit.byId(
										"choosewhattodo_staffid").attr("value");

								var id = cwtd_staffid;
								var newValue = new Date(cwtd_startdatetime);
								var timeblock_enddate = new Date(
										cwtd_enddatetime);
								var timeblockwidget = dijit
										.byId("c_personalselectdate");
								dijit.byId("isThisAgendaViewFlag").set("value",
										"true");
								var dayte = "";
								try {
									dayte = dojo.date.locale.format(newValue, {
										datePattern : "yyyy-MM-dd",
										selector : "date"
									});
								} catch (err) {
									dayte = newValue;
								}
								document.getElementById("hPersonalSelectDate").value = dayte;
								timeblockwidget.set("value", newValue);

								$('#updatepersonalbutton').hide();
								$('#savepersonalbutton').show();

								var iscancelled = false;

								var apptdate = newValue;
								var yearapptdate = apptdate.getFullYear();
								var monthapptdate = apptdate.getMonth() + 1;
								var dayapptdate = apptdate.getDate();

								var endhour = timeblock_enddate.getHours();
								var endmin = timeblock_enddate.getMinutes();
								var eap = "am";
								if (endhour > 11) {
									eap = "pm";
								}
								if (endhour > 12) {
									endhour = endhour - 12;
								}
								if (endhour == 0) {
									endhour = 12;
								}

								var beginhour = newValue.getHours();
								var beginmin = newValue.getMinutes();
								var ap = "am";
								if (beginhour > 11) {
									ap = "pm";
								}
								if (beginhour > 12) {
									beginhour = endhour - 12;
								}
								if (beginhour == 0) {
									beginhour = 12;
								}

								var staffforappt = cwtd_staffid;
								var staffwidget = dijit
										.byId("fapptstaff_personal");
								if (staffwidget) {
									staffwidget.set("value", staffforappt);
								}

								var fwidget = dijit.byId("personalhour");
								if (fwidget) {
									fwidget.setValue(beginhour);
								}

								var editmin = dijit.byId("personalminute");
								if (beginmin == 0 || beginmin == '0') {
									beginmin = '00';
								}
								if (beginmin) {
									editmin.setValue(new String(beginmin));
								}
								var editampm = dijit.byId("personalampm");
								if (editampm) {
									editampm.setValue(ap.toLowerCase());
								}

								// end time
								var fewidget = dijit.byId("personalendhour");
								if (fewidget) {
									fewidget.setValue(endhour);
								}

								var endeditmin = dijit
										.byId("personalendminute");
								if (endmin == 0 || endmin == '0') {
									endmin = '00';
								}
								if (endmin) {
									endeditmin.setValue(new String(endmin));
								}
								var endeditampm = dijit.byId("personalendampm");
								if (endeditampm) {
									endeditampm.setValue(eap.toLowerCase());
								}

								dijit.byId('personaledit')
										.set("value", "false");
								dijit.byId('personalDialog').show();

							}

							function createAppointmentForAgendaView() {
								dijit.byId("fedithour").setDisabled(false);
								dijit.byId("editminute").setDisabled(false);
								dijit.byId("editampm").setDisabled(false);
								dijit.byId("editdialogprice")
										.setDisabled(false);
								dijit.byId("editdialognotes")
										.setDisabled(false);
								dijit.byId("editsavebutton").setDisabled(false);
								dijit.byId("editcancelbutton").setDisabled(
										false);
								dijit.byId("editnsbutton").setDisabled(false);
								dijit.byId("editcobutton").setDisabled(false);

								var cwtd_startdatetime = dijit.byId(
										"choosewhattodo_startdatetime").attr(
										"value");
								var cwtd_enddatetime = dijit.byId(
										"choosewhattodo_enddatetime").attr(
										"value");
								var cwtd_staffid = dijit.byId(
										"choosewhattodo_staffid").attr("value");
								dijit.byId("c_editclientname_id").setAttribute(
										'disabled', false);
								dijit.byId('editApptDialog').reset();
								dijit.byId('progButton').set('label',
										'Select one');
								dijit.byId('progButton').set('value', '');
								dijit.byId("isThisEditAgendaViewFlag").set(
										"value", "true");
								dijit.byId('isThisADDAgendaViewFlag').set(
										"value", "true");
								setEditTab();
								var svcname = "";
								var svctype = "";
								var svcid = "";

								var dsrvselect = '';
								var iscancelled = false;

								var apptdate = new Date(cwtd_startdatetime);
								var apptenddate = new Date(cwtd_enddatetime);
								var yearapptdate = apptdate.getFullYear();
								var monthapptdate = apptdate.getMonth() + 1;
								var dayapptdate = apptdate.getDate();

								var calendar = dijit.byId("c_editselectdate");
								window.console
										&& console.log('calendar value: '
												+ calendar.value);
								calendar.set('value', apptdate);

								var staffforappt = cwtd_staffid;

								var endhour = apptenddate.getHours();
								var endmin = zeroFill(apptenddate.getMinutes(),
										2);
								var eap = "am";
								if (endhour > 11) {
									eap = "pm";
								}
								if (endhour > 12) {
									endhour = endhour - 12;
								}
								if (endhour == 0) {
									endhour = 12;
								}

								var beginhour = apptdate.getHours();
								var beginmin = apptdate.getMinutes();
								var ap = "am";
								if (beginhour > 11) {
									ap = "pm";
								}
								if (beginhour > 12) {
									beginhour = beginhour - 12;
								}
								if (beginhour == 0) {
									beginhour = 12;
								}

								var staffwidget = dijit.byId("fapptstaff_edit");
								if (staffwidget) {
									window.console
											&& console
													.log("STAFF FOR APPT IS: "
															+ staffforappt);
									staffwidget.set("value", staffforappt);
								}

								var fwidget = dijit.byId("fedithour");
								if (fwidget) {

									fwidget.set("value", beginhour);
								}

								var editmin = dijit.byId("editminute");
								if (beginmin == 0 || beginmin == '0') {
									beginmin = '00';
								}
								if (editmin) {
									editmin.set("value", new String(beginmin));
								}
								var editampm = dijit.byId("editampm");
								if (editampm) {
									editampm.set("value", ap.toLowerCase());
								}
								// end time
								var fewidget = dijit.byId("fendedithour");
								if (fewidget) {
									window.console
											&& console.log("endhour: "
													+ endhour);
									fewidget.set("value", endhour);
								}
								var endeditmin = dijit.byId("endeditminute");
								if (endmin == 0) {
									endmin = '00';
								}
								if (endeditmin) {
									window.console
											&& console.log("endmin: " + endmin);
									endeditmin.set("value", endmin);
								}
								var endeditampm = dijit.byId("endeditampm");
								if (endeditampm) {
									window.console
											&& console
													.log("eap.toLowerCase(): "
															+ eap.toLowerCase());
									endeditampm.set("value", eap.toLowerCase());
								}

								var edittabs = dijit
										.byId("myRecurTabContainer");
								edittabs.startup();
								edittabs.resize();

								var dlg = dijit.byId('editApptDialog');
								dlg.show();
								//dijit.byId("hideShowRecur").domNode.style.display = 'block'
								setEditTab();
							}
							function setEditTab() {
								var addAppt2 = dijit.byId(
										'isThisADDAgendaViewFlag').get("value");
								if (addAppt2 == "true") {
									dojo.style("hideShowRecur", 'display', '');
									dojo.style("editDialogTab2Message",
											'display', 'none');
								} else {
									dojo.style("hideShowRecur", 'display',
											'none');
									dojo.style("editDialogTab2Message",
											'display', '');
								}
							}
							function setEditApptDialogWithFCEvent(event) {
								dijit.byId('editApptDialog').reset();
								dijit.byId('progButton').set('label',
										'Select one');
								dijit.byId('progButton').set('value', '');
								dijit.byId("isThisEditAgendaViewFlag").set(
										"value", "true");
								dijit.byId('isThisADDAgendaViewFlag').set(
										"value", "false");
								setEditTab();
								var status = event.appointmentstatus;
								var firstname = "";
								var lastname = "";
								if (event.clientid != null) {
									firstname = event.clientfirstname;
									lastname = event.clientlastname;
									dijit.byId("c_editclientname_id").set(
											'value', event.clientid);
									dijit.byId("c_editclientname_id")
											.setAttribute('disabled', true);
								}

								if (status == 'CHECKED_OUT') {
									dijit.byId("fedithour").setDisabled(true);
									dijit.byId("editminute").setDisabled(true);
									dijit.byId("editampm").setDisabled(true);
									dijit.byId("editdialogprice").setDisabled(
											true);
									dijit.byId("editdialognotes").setDisabled(
											true);
									dijit.byId("editsavebutton").setDisabled(
											true);
									dijit.byId("editcancelbutton").setDisabled(
											true);
									dijit.byId("editnsbutton")
											.setDisabled(true);
									dijit.byId("editcobutton")
											.setDisabled(true);
								} else {
									dijit.byId("fedithour").setDisabled(false);
									dijit.byId("editminute").setDisabled(false);
									dijit.byId("editampm").setDisabled(false);
									dijit.byId("editdialogprice").setDisabled(
											false);
									dijit.byId("editdialognotes").setDisabled(
											false);
									dijit.byId("editsavebutton").setDisabled(
											false);
									dijit.byId("editcancelbutton").setDisabled(
											false);
									dijit.byId("editnsbutton").setDisabled(
											false);
									dijit.byId("editcobutton").setDisabled(
											false);

								}
								if (event.requested_image_path != null) {
									if (event.requested_image_path == 'yellow') {
										dijit.byId("progButton").set("label",
												"Yellow star");
										dijit.byId("progButton").set("value",
												"yellow");
									}
									if (event.requested_image_path == 'red') {
										dijit.byId("progButton").set("label",
												"Red star");
										dijit.byId("progButton").set("value",
												"red");
									}
								}
								if (event.servicename == null) {
								} else {
									svcname = event.servicename;
								}

								var svctype = "";
								if (event.servicetype == null) {
								} else {
									svctype = event.servicetype;
								}

								if (event.serviceid == null) {
								} else {
									svcid = event.serviceid;
								}

								var dsrvselect = '';
								dsrvselect = 'editselect';
								var srvselect = dijit.byId(dsrvselect);
								if (srvselect) {
									srvselect.set("value", svcid);
								}
								var iscancelled = false;
								if (status != 'CANCELED') {
									iscancelled = false;
								} else {
									iscancelled = true;
								}
								var apptdate = event.appointmentdate;//new Date(event.appointmentdate);
								var yearapptdate = apptdate.getFullYear();
								var monthapptdate = apptdate.getMonth() + 1;
								var dayapptdate = apptdate.getDate();

								var calendar = dijit.byId("c_editselectdate");
								window.console
										&& console.log('calendar value: '
												+ calendar.value);
								var realdate = event.realdate;
								calendar.set('value', realdate);

								var staffforappt = event.staffid;

								var endhour = event.endhour;
								var endmin = zeroFill(event.endmin, 2);
								var eap = event.endampm;

								var beginhour = event.beginhour;
								var beginmin = event.beginmin;
								var ap = event.beginampm;

								var staffwidget = dijit.byId("fapptstaff_edit");
								if (staffwidget) {
									window.console
											&& console
													.log("STAFF FOR APPT IS: "
															+ staffforappt);
									staffwidget.set("value", staffforappt);
								}

								var fwidget = dijit.byId("fedithour");
								if (fwidget) {

									fwidget.set("value", beginhour);
								}

								var editmin = dijit.byId("editminute");
								if (beginmin == 0 || beginmin == '0') {
									beginmin = '00';
								}
								if (editmin) {
									editmin.set("value", new String(beginmin));
								}
								var editampm = dijit.byId("editampm");
								if (editampm) {
									editampm.set("value", event.beginampm
											.toLowerCase());
								}

								// end time
								var fewidget = dijit.byId("fendedithour");
								if (fewidget) {

									fewidget.set("value", endhour);
								}

								var endeditmin = dijit.byId("endeditminute");
								if (endmin == 0) {
									endmin = '00';
								}
								if (endeditmin) {
									endeditmin.set("value", endmin);
								}
								var endeditampm = dijit.byId("endeditampm");
								if (endeditampm) {
									endeditampm.set("value", event.endampm
											.toLowerCase());
								}

								var svccost = "";
								if (event.price == null) {
									svccost = "0.00";
								} else {
									svccost = event.price;
								}

								var stateStore = null;

								var id = "0";
								id = event.appointmentid;

								var notes = "";
								if (event.appointmentnotes == null) {
								} else {
									notes = event.appointmentnotes;
								}

								var dapptid = '';
								dapptid = 'editdialogapptid';

								var d = dijit.byId(dapptid);
								d.set("value", id);

								var erp = "0";
								erp = event.recur_parent;
								var e_r_p = dijit.byId('edit_recur_parent');
								e_r_p.set("value", erp);

								var dsrv = '';
								dsrv = 'editdialogservice';

								var srv = dijit.byId(dsrv);
								srv.set("value", svcname);

								var dsrvt = '';
								dsrvt = 'editdialogservicetype';

								var srvtype = dijit.byId(dsrvt);
								srvtype.set("value", svctype);

								var dsrvti = '';
								dsrvti = 'editdialogsvcid';

								var servid = dijit.byId(dsrvti);
								servid.set("value", svcid);

								var dpr = '';
								dpr = 'editdialogprice';

								var pr = dojo.byId(dpr);
								window.console
										&& console
												.log("setEditApptDialogWithFCEvent svccost: "
														+ svccost);
								pr.value = formatCurrency(svccost);

								var dno = '';
								dno = 'editdialognotes';

								var dnotes = dojo.byId(dno);
								dnotes.value = notes;

								var dlg = dijit.byId('editApptDialog');
								dlg.show();

							}
							function noajax(aid) {
								StillNeedsValidating = false;
								standby.hide();

								if (appointmentsArray.length > 0) {
									dijit.byId('editApptDialog').reset();
									dijit.byId('progButton').set('label',
											'Select one');
									dijit.byId('progButton').set('value', '');
									dijit.byId("isThisEditAgendaViewFlag").set(
											"value", "false");
									dijit.byId('isThisADDAgendaViewFlag').set(
											"value", "false");
									setEditTab();
									for ( var key in appointmentsArray) {
										var findappt = appointmentsArray[key];
										if (findappt.appointmentid == aid) {
											var status = findappt.appointmentstatus;
											var firstname = "";
											var lastname = "";
											if (findappt.clientid != null) {
												firstname = findappt.firstname;
												lastname = findappt.lastname;
												dijit
														.byId(
																"c_editclientname_id")
														.set(
																'value',
																findappt.clientid);
												dijit.byId(
														"c_editclientname_id")
														.setAttribute(
																'disabled',
																true);
											}

											if (status == 'CHECKED_OUT') {
												dijit.byId("fedithour")
														.setDisabled(true);
												dijit.byId("editminute")
														.setDisabled(true);
												dijit.byId("editampm")
														.setDisabled(true);
												dijit.byId("editdialogprice")
														.setDisabled(true);
												dijit.byId("editdialognotes")
														.setDisabled(true);
												dijit.byId("editsavebutton")
														.setDisabled(true);
												dijit.byId("editcancelbutton")
														.setDisabled(true);
												dijit.byId("editnsbutton")
														.setDisabled(true);
												dijit.byId("editcobutton")
														.setDisabled(true);
											} else {
												dijit.byId("fedithour")
														.setDisabled(false);
												dijit.byId("editminute")
														.setDisabled(false);
												dijit.byId("editampm")
														.setDisabled(false);
												dijit.byId("editdialogprice")
														.setDisabled(false);
												dijit.byId("editdialognotes")
														.setDisabled(false);
												dijit.byId("editsavebutton")
														.setDisabled(false);
												dijit.byId("editcancelbutton")
														.setDisabled(false);
												dijit.byId("editnsbutton")
														.setDisabled(false);
												dijit.byId("editcobutton")
														.setDisabled(false);

											}
											if (findappt.servicename == null) {
											} else {
												svcname = findappt.servicename;
											}

											var svctype = "";
											if (findappt.servicetype == null) {
											} else {
												svctype = findappt.servicetype;
											}

											if (findappt.serviceid == null) {
											} else {
												svcid = findappt.serviceid;
											}

											var dsrvselect = '';
											dsrvselect = 'editselect';
											var srvselect = dijit
													.byId(dsrvselect);
											if (srvselect) {
												srvselect.set("value", svcid);
											}
											var iscancelled = false;
											if (status != 'CANCELED') {
												iscancelled = false;
											} else {
												iscancelled = true;
											}
											var apptdate = new Date(
													findappt.appointmentdate);
											var yearapptdate = apptdate
													.getFullYear();
											var monthapptdate = apptdate
													.getMonth() + 1;
											var dayapptdate = apptdate
													.getDate();

											var calendar = dijit
													.byId("c_editselectdate");
											window.console
													&& console
															.log('calendar value: '
																	+ calendar.value);
											var realdate = new Date(apptdate
													.getUTCFullYear(), apptdate
													.getUTCMonth(), apptdate
													.getUTCDate());
											calendar.set('value', realdate);

											var staffforappt = findappt.staffid;

											var endhour = findappt.endhr;
											var endmin = zeroFill(
													findappt.endmin, 2);
											var eap = findappt.endampm;

											var beginhour = findappt.beginhr;
											var beginmin = findappt.beginmin;
											var ap = findappt.beginampm;

											var staffwidget = dijit
													.byId("fapptstaff_edit");
											if (staffwidget) {
												window.console
														&& console
																.log("STAFF FOR APPT IS: "
																		+ staffforappt);
												staffwidget.set("value",
														staffforappt);
											}

											var fwidget = dijit
													.byId("fedithour");
											if (fwidget) {

												fwidget.set("value", beginhour);
											}

											var editmin = dijit
													.byId("editminute");
											if (beginmin == 0
													|| beginmin == '0') {
												beginmin = '00';
											}
											if (editmin) {
												editmin.set("value",
														new String(beginmin));
											}
											var editampm = dijit
													.byId("editampm");
											if (editampm) {
												editampm.set("value", ap
														.toLowerCase());
											}

											// end time
											var fewidget = dijit
													.byId("fendedithour");
											if (fewidget) {

												fewidget.set("value", endhour);
											}

											var endeditmin = dijit
													.byId("endeditminute");
											if (endmin == 0) {
												endmin = '00';
											}
											if (endeditmin) {
												endeditmin.set("value", endmin);
											}
											var endeditampm = dijit
													.byId("endeditampm");
											if (endeditampm) {
												endeditampm.set("value", eap
														.toLowerCase());
											}

											var svccost = "";
											if (findappt.price == null) {
												svccost = "0.00";
											} else {
												svccost = findappt.price;
											}

											var stateStore = null;

											var id = "0";
											id = findappt.appointmentid;

											var notes = "";
											if (findappt.notes == null) {
											} else {
												notes = findappt.notes;
											}

											var dapptid = '';
											dapptid = 'editdialogapptid';

											var d = dijit.byId(dapptid);
											d.set("value", id);

											var erp = "0";
											erp = findappt.recur_parent;
											var e_r_p = dijit
													.byId('edit_recur_parent');
											e_r_p.set("value", erp);

											var dsrv = '';
											dsrv = 'editdialogservice';

											var srv = dijit.byId(dsrv);
											srv.set("value", svcname);

											var dsrvt = '';
											dsrvt = 'editdialogservicetype';

											var srvtype = dijit.byId(dsrvt);
											srvtype.set("value", svctype);

											var dsrvti = '';
											dsrvti = 'editdialogsvcid';

											var servid = dijit.byId(dsrvti);
											servid.set("value", svcid);

											var dpr = '';
											dpr = 'editdialogprice';

											var pr = dojo.byId(dpr);
											pr.value = formatCurrency(svccost);

											var dno = '';
											dno = 'editdialognotes';

											var dnotes = dojo.byId(dno);
											dnotes.value = notes;
										}
									}
								}
							}
							function doAjax(id, whichdlg) {
								if (whichdlg == 'editApptDialog') {
									var donotdoget = true;
									if (donotdoget) {
										StillNeedsValidating = false;
										noajax(id);
										standby.hide();
									} else {
										fillServices(id);
										var deferred = dojo
												.xhrGet({
													url : "myschedule/appt?apptid="
															+ id,
													handleAs : "text",
													preventCache : true,
													load : function(response,
															newValue) {
														dijit
																.byId(
																		'editApptDialog')
																.reset();
														dijit
																.byId(
																		'progButton')
																.set('label',
																		'Select one');
														dijit
																.byId(
																		'progButton')
																.set('value',
																		'');
														// handle response codes
														// do something with returned data
														//window.console && console.log("the appointment object returned: "+response);
														var isJSON;
														var data;
														try {
															data = JSON
																	.parse(response);
															isJSON = true;
														} catch (e) {
															isJSON = false;
														}

														if (isJSON) {
															// data is already parsed, so just use it
															// handle response codes
															// do something with returned data

															if (data.constructor == Array) {

																for ( var key in data) {
																	var status = data[key].status;
																	var firstname = "";
																	var lastname = "";
																	if (data[key].client != null) {
																		firstname = data[key].client.firstName;
																		lastname = data[key].client.lastName;
																		dijit
																				.byId(
																						"c_editclientname_id")
																				.set(
																						'value',
																						data[key].client.id);
																		dijit
																				.byId(
																						"c_editclientname_id")
																				.setAttribute(
																						'disabled',
																						true);
																	}

																	if (status == 'CHECKED_OUT') {
																		dijit
																				.byId(
																						"fedithour")
																				.setDisabled(
																						true);
																		dijit
																				.byId(
																						"editminute")
																				.setDisabled(
																						true);
																		dijit
																				.byId(
																						"editampm")
																				.setDisabled(
																						true);
																		dijit
																				.byId(
																						"editdialogprice")
																				.setDisabled(
																						true);
																		dijit
																				.byId(
																						"editdialognotes")
																				.setDisabled(
																						true);
																		dijit
																				.byId(
																						"editsavebutton")
																				.setDisabled(
																						true);
																		dijit
																				.byId(
																						"editcancelbutton")
																				.setDisabled(
																						true);
																		dijit
																				.byId(
																						"editnsbutton")
																				.setDisabled(
																						true);
																		dijit
																				.byId(
																						"editcobutton")
																				.setDisabled(
																						true);
																	} else {
																		dijit
																				.byId(
																						"fedithour")
																				.setDisabled(
																						false);
																		dijit
																				.byId(
																						"editminute")
																				.setDisabled(
																						false);
																		dijit
																				.byId(
																						"editampm")
																				.setDisabled(
																						false);
																		dijit
																				.byId(
																						"editdialogprice")
																				.setDisabled(
																						false);
																		dijit
																				.byId(
																						"editdialognotes")
																				.setDisabled(
																						false);
																		dijit
																				.byId(
																						"editsavebutton")
																				.setDisabled(
																						false);
																		dijit
																				.byId(
																						"editcancelbutton")
																				.setDisabled(
																						false);
																		dijit
																				.byId(
																						"editnsbutton")
																				.setDisabled(
																						false);
																		dijit
																				.byId(
																						"editcobutton")
																				.setDisabled(
																						false);

																	}

																	var sbeginetimex = data[key].s_beginDateTime;

																	var sendetimex = data[key].s_endDateTime;

																	var iscancelled = false;
																	if (data[key].cancelled == null
																			|| data[key].cancelled == 'false') {
																		iscancelled = false;
																	} else {
																		iscancelled = data[key].cancelled;
																	}
																	var apptdate = new Date(
																			data[key].appointmentDate);
																	var yearapptdate = apptdate
																			.getFullYear();
																	var monthapptdate = apptdate
																			.getMonth() + 1;
																	var dayapptdate = apptdate
																			.getDate();

																	var calendar = dijit
																			.byId("c_editselectdate");
																	window.console
																			&& console
																					.log('calendar value: '
																							+ calendar.value);
																	var realdate = new Date(
																			apptdate
																					.getUTCFullYear(),
																			apptdate
																					.getUTCMonth(),
																			apptdate
																					.getUTCDate());
																	calendar
																			.set(
																					'value',
																					realdate);

																	var endtime = new Date(
																			data[key].endDateTime.time);
																	var endhour = endtime
																			.getHours();
																	var endmin = endtime
																			.getMinutes();
																	var eap = "am";
																	if (endhour > 11) {
																		eap = "pm";
																	}
																	if (endhour > 12) {
																		endhour = endhour - 12;
																	}
																	if (endhour == 0) {
																		endhour = 12;
																	}

																	var begintime = new Date(
																			data[key].beginDateTime.time);
																	var beginhour = begintime
																			.getHours();
																	var beginmin = begintime
																			.getMinutes();
																	var ap = "am";
																	if (beginhour > 11) {
																		ap = "pm";
																	}
																	if (beginhour > 12) {
																		beginhour = beginhour - 12;
																	}
																	if (beginhour == 0) {
																		beginhour = 12;
																	}

																	var fwidget = dijit
																			.byId("fedithour");
																	var coln = sbeginetimex
																			.indexOf(':');
																	beginhour = sbeginetimex
																			.substring(
																					0,
																					coln);
																	if (fwidget) {

																		fwidget
																				.setValue(beginhour);
																	}

																	var editmin = dijit
																			.byId("editminute");
																	beginmin = sbeginetimex
																			.substring(
																					coln + 1,
																					coln + 3);
																	if (beginmin == 0) {
																		beginmin = '00';
																	}
																	if (editmin) {
																		editmin
																				.setValue(new String(
																						beginmin));
																	}
																	var editampm = dijit
																			.byId("editampm");
																	ap = sbeginetimex
																			.substring(
																					sbeginetimex.length,
																					sbeginetimex.length - 2);
																	if (editampm) {
																		editampm
																				.setValue(ap
																						.toLowerCase());
																	}

																	// end time
																	var fewidget = dijit
																			.byId("fendedithour");
																	var coln = sendetimex
																			.indexOf(':');
																	endhour = sendetimex
																			.substring(
																					0,
																					coln);
																	if (fewidget) {

																		fewidget
																				.setValue(endhour);
																	}

																	var endeditmin = dijit
																			.byId("endeditminute");
																	endmin = sendetimex
																			.substring(
																					coln + 1,
																					coln + 3);
																	if (endmin == 0) {
																		endmin = '00';
																	}
																	if (endeditmin) {
																		endeditmin
																				.setValue(new String(
																						endmin));
																	}
																	var endeditampm = dijit
																			.byId("endeditampm");
																	eap = sendetimex
																			.substring(
																					sendetimex.length,
																					sendetimex.length - 2);
																	if (endeditampm) {
																		endeditampm
																				.setValue(eap
																						.toLowerCase());
																	}

																	var svccost = "";
																	if (data[key].service1cost == null) {
																		svccost = "0.00";
																	} else {
																		svccost = data[key].service1cost;
																	}

																	id = data[key].id;
																	if (data[key].servicename1 == null) {
																	} else {
																		svcname = data[key].servicename1;
																	}

																	var svctype = "";
																	if (data[key].service1type == null) {
																	} else {
																		svctype = data[key].service1type;
																	}

																	if (data[key].service1id == null) {
																	} else {
																		svcid = data[key].service1id;
																	}

																	var dsrvselect = '';
																	dsrvselect = 'editselect';

																	var stateStore = null;
																	id = id
																			.substring(
																					id.length - 2,
																					id.length);

																	var id = "0";
																	id = data[key].id;

																	var notes = "";
																	if (data[key].notes == null) {
																	} else {
																		notes = unescape(data[key].notes);
																	}

																	var dapptid = '';
																	dapptid = 'editdialogapptid';

																	var d = dijit
																			.byId(dapptid);
																	d
																			.set(
																					"value",
																					id);

																	var erp = "0";
																	erp = data[key].recur_parent;
																	var e_r_p = dijit
																			.byId('edit_recur_parent');
																	e_r_p
																			.set(
																					"value",
																					erp);

																	var dsrv = '';
																	dsrv = 'editdialogservice';

																	var srv = dijit
																			.byId(dsrv);
																	srv
																			.set(
																					"value",
																					svcname);

																	var dsrvt = '';
																	dsrvt = 'editdialogservicetype';

																	var srvtype = dijit
																			.byId(dsrvt);
																	srvtype
																			.set(
																					"value",
																					svctype);

																	var dsrvti = '';
																	dsrvti = 'editdialogsvcid';

																	var servid = dijit
																			.byId(dsrvti);
																	servid
																			.set(
																					"value",
																					svcid);

																	var dpr = '';
																	dpr = 'editdialogprice';

																	var pr = dojo
																			.byId(dpr);
																	pr.value = formatCurrency(svccost);

																	var dno = '';
																	dno = 'editdialognotes';

																	var dnotes = dojo
																			.byId(dno);
																	dnotes.value = notes;
																}

															} else {
																sometext = data[0].description;
																window.console
																		&& console
																				.log(sometext);
															}
														} else {
															// try treating it as XML
														}
														standbydlg.hide();
														return response;
													},
													error : function(error) {
														window.console
																&& console
																		.log("An unexpected error occurred: "
																				+ error);
														standbydlg.hide();
														window.location
																.reload();
													}
												});
									}

									//clearDialog();
									var dlg = dijit.byId(whichdlg);
									dlg.show();
								} else {
									// personal time
									displayPersonalDialog(id, true);

								}
							}

							function formatCurrency(num) {
								num = isNaN(num) || num === '' || num === null ? 0.00
										: num;
								return parseFloat(num).toFixed(2);
							}
							function remove(id) {
								window.console
										&& console.log("ENTERED remove() id: "
												+ id);
								return (elem = document.getElementById(id)).parentNode
										.removeChild(elem);
							}
							function deletePersonal() {
								standby.show();
								var id = dijit.byId("editpersonalapptid").get(
										"value");
								var isthisagendaviewflagval = "false";
								isthisagendaviewflagval = dijit.byId(
										"isThisAgendaViewFlag").get("value");
								window.console
										&& console
												.log("delete editpersonalapptid id : "
														+ id);
								dojo
										.xhrGet({
											url : "myschedule/delete?apptid="
													+ id,
											preventCache : true,
											handle : function(data) {
												window.console
														&& console
																.log("SUCCESS FROM DELETE PERSONAL");
												try {
													window.console
															&& console
																	.log("before entering displayEditTodaysAgenda deleteappointment ");
													var rawdate = dijit.byId(
															"c_editselectdate")
															.attr("value");
													window.console
															&& console
																	.log("c_editselectdate: "
																			+ rawdate);
													var postdate = dojo.date.locale
															.format(
																	rawdate,
																	{
																		datePattern : "yyyy-MM-dd",
																		selector : "date"
																	})
													if (isthisagendaviewflagval == "false") {
														displayEditTodaysAgenda(postdate);
													} else {
														window.console
																&& console
																		.log("UPDATE THE AGENDA VIEW FOR THE DELETED EVENT");
														loadAgenda1();
													}
													standby.hide();
												} catch (err) {
													window.console
															&& console
																	.log("deleteappointment could not display todays agenda error message :\n "
																			+ err);
													standby.hide();
												}
											},
											error : function(error) {
												window.console
														&& console
																.log("ERROR FROM DELETE PERSONAL");
												window.console
														&& console.log(error);
												window.location.reload();
											}
										}

										);
							}

							function deleteAppointment(dialogFields) {
								standby.show();
								var id = dijit.byId("editdialogapptid").attr(
										"value");
								var erp = dijit.byId("edit_recur_parent").attr(
										"value");
								var deletefuture = "false";
								if (erp != '') {
									var x = confirm("Do you wish to delete future appointments too?");
									if (x) {
										deletefuture = "true";
									} else {
										deletefuture = "false";
									}
								}
								var isThisEditAgendaViewFlag = "false";
								isThisEditAgendaViewFlag = dijit.byId(
										"isThisEditAgendaViewFlag").attr(
										"value");
								window.console
										&& console
												.log("delete editdialogapptid id : "
														+ id);
								dojo
										.xhrGet({
											url : "myschedule/delete?apptid="
													+ id + "&df="
													+ deletefuture,
											preventCache : true,
											handle : function(data) {
												window.console
														&& console
																.log("SUCCESS FROM DELETE APPOINTMENT");
												try {
													window.console
															&& console
																	.log("before entering displayEditTodaysAgenda deleteappointment ");
													var rawdate = dijit.byId(
															"c_editselectdate")
															.attr("value");
													window.console
															&& console
																	.log("c_editselectdate: "
																			+ rawdate);
													var postdate = dojo.date.locale
															.format(
																	rawdate,
																	{
																		datePattern : "yyyy-MM-dd",
																		selector : "date"
																	})
													if (isThisEditAgendaViewFlag == "false") {
														displayEditTodaysAgenda(postdate);
													} else {
														loadAgenda1();
													}
													standby.hide();
												} catch (err) {
													window.console
															&& console
																	.log("deleteappointment could not display todays agenda error message :\n "
																			+ err);
													standby.hide();
												}
											},
											error : function(error) {
												window.console
														&& console
																.log("ERROR FROM DELETE APPOINTMENT");
												window.console
														&& console.log(error);
												window.location.reload();
											}
										}

										);
							}

							function cancelAppointment() {
								var newDate = document
										.getElementById("hEditSelectDate").value;
								var isThisEditAgendaViewFlag = "false";
								isThisEditAgendaViewFlag = dijit.byId(
										"isThisEditAgendaViewFlag").attr(
										"value");
								standby.show();
								var id = dijit.byId("editdialogapptid").attr(
										"value");
								window.console
										&& console
												.log("cancel editdialogapptid id : "
														+ id);
								//Call the asynchronous xhrPost
								dojo
										.xhrGet({
											url : "myschedule/cancel?apptid="
													+ id,
											handleAs : "text",
											preventCache : true,
											load : function(data) {
												window.console
														&& console
																.log("SUCCESS FROM CANCEL APPOINTMENT");
												try {
													window.console
															&& console
																	.log("before entering displayEditTodaysAgenda cancel appointment ");
													var rawdate = dijit.byId(
															"c_editselectdate")
															.attr("value")
													window.console
															&& console
																	.log("c_editselectdate: "
																			+ rawdate);
													var postdate = dojo.date.locale
															.format(
																	rawdate,
																	{
																		datePattern : "yyyy-MM-dd",
																		selector : "date"
																	})
													if (isThisEditAgendaViewFlag == "false") {
														displayEditTodaysAgenda(postdate);
													} else {
														loadAgenda1();
													}
													standby.hide();
												} catch (err) {
													window.console
															&& console
																	.log("cancel appointment could not display todays agenda error message :\n "
																			+ err);
													standby.hide();
												}
											},
											error : function(error) {
												window.console
														&& console
																.log("ERROR FROM CANCEL APPOINTMENT");
												window.console
														&& console.log(error);
												window.location.reload();
											}
										}

										);

							}
							function noShowAppointment(dialogFields) {
								standby.show();
								var id = dijit.byId("editdialogapptid").attr(
										"value");
								var isThisEditAgendaViewFlag = "false";
								isThisEditAgendaViewFlag = dijit.byId(
										"isThisEditAgendaViewFlag").attr(
										"value");
								window.console
										&& console
												.log("noshow editdialogapptid id : "
														+ id);
								dojo
										.xhrGet({
											url : "myschedule/noshow?apptid="
													+ id,
											preventCache : true,
											handle : function(data) {
												window.console
														&& console
																.log("SUCCESS FROM NOSHOW APPOINTMENT");
												try {
													window.console
															&& console
																	.log("before entering displayEditTodaysAgenda noshow appointment ");
													var rawdate = dijit.byId(
															"c_editselectdate")
															.attr("value")
													window.console
															&& console
																	.log("c_editselectdate: "
																			+ rawdate);
													var postdate = dojo.date.locale
															.format(
																	rawdate,
																	{
																		datePattern : "yyyy-MM-dd",
																		selector : "date"
																	})
													if (isThisEditAgendaViewFlag == "false") {
														displayEditTodaysAgenda(postdate);
													} else {
														loadAgenda1();

													}
													standby.hide();
												} catch (err) {
													window.console
															&& console
																	.log("noshow could not display todays agenda error message :\n "
																			+ err);
													standby.hide();
												}
											},
											error : function(error) {
												window.console
														&& console
																.log("ERROR FROM NOSHOW APPOINTMENT");
												window.console
														&& console.log(error);
												window.location.reload();
											}
										}

										);
							}
							function saveAndCheckout() {
								var rawdate = dijit.byId("c_editselectdate")
										.attr("value")
								var nowdate = new Date();
								nowdate.setHours(0);
								nowdate.setSeconds(0);
								nowdate.setMinutes(0);
								nowdate.setMilliseconds(0);

								rawdate.setHours(0);
								rawdate.setSeconds(0);
								rawdate.setMinutes(0);
								rawdate.setMilliseconds(0);
								var dothis = false;
								if (rawdate.valueOf() != nowdate.valueOf()) {
									var conf = confirm("The Checkout date is different from todays date. Are you sure you want to Check Out?");

									if (conf == true) {
										window.console
												&& console
														.log("dothis is true");
										dothis = true;
									} else {
										window.console
												&& console
														.log("dothis is false");
									}
								} else {
									window.console
											&& console.log("dothis is true");
									dothis = true;
								}
								if (dothis) {
									var nextdeferred = new dojo.Deferred();
									updateAppointment(nextdeferred);
									nextdeferred.then(function(res) {
										checkOutAppointment(res);

									}, function(err) {
										// This will be called when the deferred
										// is rejected
										window.console
												&& console.log("ERROR " + err);
									});
								}
							}
							function checkOutAppointment(res) {
								standby.show();

								var isJSON;
								var id = res;
								var isThisEditAgendaViewFlag = "false";
								isThisEditAgendaViewFlag = dijit.byId(
										"isThisEditAgendaViewFlag").attr(
										"value");
								//window.console && console.log("the appointment object returned: "+res);
								var data;
								try {
									data = JSON.parse(res);
									isJSON = true;
								} catch (e) {
									isJSON = false;
								}
								if (isJSON) {
									if (data.constructor == Array) {
										for ( var key in data) {
											id = data[key].id;

										}
									}
								}
								window.console
										&& console
												.log("checkout editdialogapptid id : "
														+ id);
								dojo
										.xhrGet({
											url : "myschedule/checkout?apptid="
													+ id,
											preventCache : true,
											handle : function(data) {
												window.console
														&& console
																.log("SUCCESS FROM NOSHOW APPOINTMENT");
												try {
													window.console
															&& console
																	.log("before entering displayEditTodaysAgenda checkout appointment ");
													var rawdate = dijit.byId(
															"c_editselectdate")
															.attr("value")
													window.console
															&& console
																	.log("c_editselectdate: "
																			+ rawdate);
													var postdate = dojo.date.locale
															.format(
																	rawdate,
																	{
																		datePattern : "yyyy-MM-dd",
																		selector : "date"
																	})
													if (isThisEditAgendaViewFlag == "false") {
														displayEditTodaysAgenda(postdate);
													} else {
														loadAgenda1();
													}
													standby.hide();
												} catch (err) {
													window.console
															&& console
																	.log("checkout could not display todays agenda error message :\n "
																			+ err);
													standby.hide();
												}
											},
											error : function(error) {
												window.console
														&& console
																.log("ERROR FROM NOSHOW APPOINTMENT");
												window.console
														&& console.log(error);
												window.location.reload();
											}
										}

										);
							}
							function displayEditTodaysAgenda(newValue) {
								window.console
										&& console
												.log("ENTERED displayEditTodaysAgenda");
								var dayte = "";
								var agendadate = "";
								try {
									window.console
											&& console.log("newValue: "
													+ newValue);
									dayte = dojo.date.locale.format(newValue, {
										datePattern : "yyyy-MM-dd",
										selector : "date"
									});
									agendadate = dojo.date.locale.format(
											newValue, {
												datePattern : "MM-dd-yyyy",
												selector : "date"
											});
								} catch (err) {
									window.console
											&& console
													.log("could not format the newValue date: "
															+ err);
									dayte = newValue;
									agendadate = newValue;
								}
								document.getElementById("hSelectDate").value = dayte;
								window.console
										&& console
												.log("displayEditTodaysAgenda dayte: "
														+ dayte);
								var deferred = dojo
										.xhrGet({
											url : "myschedule/agenda?date="
													+ document
															.getElementById("hSelectDate").value,
											preventCache : true,
											handle : function(response,
													newValue) {
												// handle response codes
												// do something with returned data
												window.console
														&& console
																.log("the appointment object returned: "
																		+ response);
												var isJSON;
												var data;
												try {
													data = JSON.parse(response);
													isJSON = true;
												} catch (e) {
													isJSON = false;
												}

												if (isJSON) {
													// data is already parsed, so just use it
													// handle response codes
													// do something with returned data

													var mytable = document
															.getElementById("agenda");
													window.console
															&& console
																	.log("past get id of agenda");

													var oldagendaheader = document
															.getElementById("agendadate");
													oldagendaheader.innerHTML = "Agenda for "
															+ agendadate;

													for (var i = document
															.getElementById("agenda").rows.length; i > 1; i--) {
														document
																.getElementById(
																		"agenda")
																.deleteRow(
																		i - 1);
													}
													var mycurrent_row, mycurrent_cell;
													mytable = document
															.getElementById("agenda");
													if (data.constructor == Array) {
														appointmentsArray = [];
														customServicesPricesArray = [];
														for ( var key in data) {
															if (global_selected_staff != '') {
																if (data[key].staff.id != global_selected_staff) {
																	continue;
																}
															}
															try {
																var sbeginetimex = data[key].s_beginDateTime;
																var sendetimex = data[key].s_endDateTime;
																window.console
																		&& console
																				.log("in for loop");

																var myTime = new Date(
																		data[key].beginDateTime.timeInMillis);
																var myEndTime = new Date(
																		data[key].endDateTime.timeInMillis);
																var endhh = myEndTime
																		.getHours();
																var endmm = myEndTime
																		.getMinutes();

																var hh = myTime
																		.getHours();
																var mm = myTime
																		.getMinutes();
																var ss = myTime
																		.getSeconds();
																var ms = myTime
																		.getMilliseconds();
																var ap = "am";
																var endap = "am";

																if (hh > 11) {
																	ap = "pm";
																}
																if (hh > 12) {
																	hh = hh - 12;
																}
																if (hh == 0) {
																	hh = 12;
																}

																if (endhh > 11) {
																	endap = "pm";
																}
																if (endhh > 12) {
																	endhh = endhh - 12;
																}
																if (endhh == 0) {
																	endhh = 12;
																}

																var timetext = "Begin: "
																		+ hh
																		+ ":"
																		+ mm
																		+ " "
																		+ ap;
																var endtimetext = "End: "
																		+ endhh
																		+ ":"
																		+ zeroFill(
																				endmm,
																				2)
																		+ " "
																		+ endap;

																mycurrent_row = document
																		.createElement("tr");

																mycurrent_row
																		.setAttribute(
																				"id",
																				"appointment"
																						+ data[key].id);
																mycurrent_row
																		.setAttribute(
																				"onMouseOver",
																				"this.className='highlight'");
																mycurrent_row
																		.setAttribute(
																				"onMouseOut",
																				"this.className='normal'");
																mycurrent_cell = document
																		.createElement("td");
																var svc = data[key].servicename1
																		+ " $"
																		+ formatCurrency(data[key].service1cost);
																if (data[key].client != null) {
																	mycurrent_row
																			.setAttribute(
																					"status",
																					data[key].status);
																	mycurrent_row
																			.setAttribute(
																					"onClick",
																					"doAjax("
																							+ data[key].id
																							+ ",'editApptDialog');");
																	sometext = "STATUS: "
																			+ data[key].status
																			+ " "
																			+ data[key].client.firstName
																			+ " "
																			+ data[key].client.lastName
																			+ " "
																			+ sbeginetimex
																			+ " "
																			+ sendetimex
																			+ " "
																			+ svc;
																} else {
																	mycurrent_row
																			.setAttribute(
																					"status",
																					"PERSONAL");
																	mycurrent_row
																			.setAttribute(
																					"onClick",
																					"doAjax("
																							+ data[key].id
																							+ ",'personalDialog');");
																	sometext = "STATUS: "
																			+ data[key].status
																			+ " TIME BLOCK  "
																			+ data[key].personallabel
																			+ " "
																			+ sbeginetimex
																			+ " "
																			+ sendetimex
																			+ " ";
																}
																var datatext = document
																		.createTextNode(" "
																				+ sometext);
																window.console
																		&& console
																				.log("before data.id");
																mycurrent_cell
																		.setAttribute(
																				"id",
																				"appointment"
																						+ data[key].id);
																window.console
																		&& console
																				.log("after data.id");
																mycurrent_cell
																		.appendChild(datatext);
																mycurrent_row
																		.appendChild(mycurrent_cell);
																var tbody = mytable
																		.getElementsByTagName('tbody')[0];
																tbody
																		.appendChild(mycurrent_row);
																mytable
																		.appendChild(tbody);
																var agendaobject = data[key];
																var clientobject = agendaobject.client;
																if (clientobject) {
																	window.console
																			&& console
																					.log("before data.id 2 "
																							+ clientobject);
																	var getappt = new appointmentobject(
																			data[key].staff.id,
																			""
																					+ agendaobject.status,
																			""
																					+ agendaobject.id,
																			agendaobject.appointmentDate,
																			""
																					+ agendaobject.service1id,
																			""
																					+ agendaobject.servicename1,
																			""
																					+ agendaobject.service1cost,
																			""
																					+ agendaobject.client.id,
																			""
																					+ agendaobject.client.firstName,
																			""
																					+ agendaobject.client.lastName,
																			""
																					+ agendaobject.notes,
																			""
																					+ hh,
																			""
																					+ mm,
																			""
																					+ ap,
																			""
																					+ endhh,
																			""
																					+ zeroFill(
																							endmm,
																							2),
																			""
																					+ endap,
																			data[key].recur_parent,
																			data[key].requested_image_path);
																	window.console
																			&& console
																					.log("after data.id 2");
																	appointmentsArray
																			.push(getappt);
																	window.console
																			&& console
																					.log("after append child");
																	var custserviceprice = new customservicepriceobject(
																			agendaobject.id,
																			agendaobject.service1id,
																			agendaobject.service1cost);
																	customServicesPricesArray
																			.push(custserviceprice);

																} else {
																	window.console
																			&& console
																					.log("before data.id 3 "
																							+ clientobject);
																	var getappt = new appointmentobject(
																			data[key].staff.id,
																			""
																					+ agendaobject.status,
																			""
																					+ agendaobject.id,
																			agendaobject.appointmentDate,
																			""
																					+ agendaobject.service1id,
																			""
																					+ agendaobject.servicename1,
																			""
																					+ agendaobject.service1cost,
																			"",
																			"",
																			"",
																			""
																					+ agendaobject.notes,
																			""
																					+ hh,
																			""
																					+ mm,
																			""
																					+ ap,
																			""
																					+ endhh,
																			""
																					+ zeroFill(
																							endmm,
																							2),
																			""
																					+ endap,
																			data[key].recur_parent);
																	window.console
																			&& console
																					.log("after data.id 3");
																	appointmentsArray
																			.push(getappt);
																	window.console
																			&& console
																					.log("after append child");
																	var custserviceprice = new customservicepriceobject(
																			agendaobject.id,
																			agendaobject.service1id,
																			agendaobject.service1cost);
																	customServicesPricesArray
																			.push(custserviceprice);

																}
															} catch (err) {
																window.console
																		&& console
																				.log(err);
															}
														}

													} else {
														sometext = data[0].description;
														alert(sometext);

													}
												} else {
													// try treating it as XML
												}
												window.console
														&& console
																.log("about to hide the standby");
												standby.hide();
												return response;
											}
										});
							}
							function fancy_confirm(title, message, onYes, onNo) {
								dijit.byId('id_dialog_button_1').attr("style",
										"color:crimson;font-weight:bold");
								dijit.byId('id_dialog_button_1').attr("label",
										"Yes, Delete");
								var p = dijit.byId('id_dialog');
								p.attr("title", title);
								dojo.byId('id_dialog_text').innerHTML = message;
								p.execute = dojo.hitch(p, function() {
									if (dojo.isObject(arguments)) {
										onYes();
									} else {
										onNo();
									}
								});
								p.show();
							}
							function saveAddDialog() {
								standby.show();
								var firstname = dijit.byId('firstname_dlg')
										.attr("value");
								firstname = toTitleCase(firstname);
								var lastname = dijit.byId('lastname_dlg').attr(
										"value");
								lastname = toTitleCase(lastname);
								var phonenumber = dijit.byId(
										'home_phonenumber_dlg').attr("value");

								var dob = '';
								var address1 = '';
								var address2 = '';
								var city = '';
								var state = '';
								var zip = '';
								var homephone = "";
								if (phonenumber != null) {
									homephone = phonenumber;
								}

								var workphone = '';
								var cellphone = '';
								var email = '';
								dojo
										.xhrGet({
											url : "clients/addclient?f="
													+ firstname + "&l="
													+ lastname + "&dob=" + dob
													+ "&a1=" + address1
													+ "&a2=" + address2 + "&c="
													+ city + "&s=" + state
													+ "&z=" + zip + "&wp="
													+ workphone + "&hp="
													+ homephone + "&cp="
													+ cellphone + "&e=" + email,
											handleAs : "json",
											timeout : 5000,
											preventCache : true,
											load : function(response, ioArgs) {
												if (response == "SUCCESS") {
													loadClientsList();
													var widg = document
															.getElementById('upgraderequired');
													if (widg) {
														widg.style.display = 'none';
													}
												} else if (response == "FAILURE") {
													var widg = document
															.getElementById('upgraderequired');
													if (widg) {
														widg.style.display = 'inline';
													}
												} else {
													alert("First name and last name already exists.");
												}
												standby.hide();
												return response;
											},
											error : function(response, ioArgs) {
												window.console
														&& console
																.log("HTTP status code: "
																		+ ioArgs.xhr.status);
												standby.hide();
												window.location.reload();
												return response;
											}
										});
							}
							function addnewclient() {
								try {
									var dlg = dijit.byId('addClientDialog');
									dlg.reset();
									dlg.show();
								} catch (e) {
									window.console && console.log(e);
								}
							}
							function isAlive() {
								dojo
										.xhrPost({
											url : "myschedule/isalive",
											content : {},
											handleAs : "json",
											load : function(data) {
												window.console
														&& console
																.log("SUCCESS FROM CHECKING alive");
												window.console
														&& console
																.log("IS THERE AN APPOINTMENT CONFLICT? "
																		+ data);
												if (data == "true") {
													window.console
															&& console
																	.log("still alive");
												}
											},
											error : function(error) {
												window.console
														&& console
																.log("NOT alive");
												window.console
														&& console
																.log("error: "
																		+ error);
												window.location.reload();
											}
										}

										);
							}
							function addAppointmentForFC(nextdeferredcheckout) {
								window.console
										&& console
												.log("SAVING APPOINTMENT FROM FORM");
								standby = new dojox.widget.Standby({
									target : "myTabContainer"
								});
								document.body.appendChild(standby.domNode);
								standby.show();

								// beginning of update appointment code : getting values from dialog
								var staff_edit_id = dijit.byId(
										"fapptstaff_edit").attr("value");
								var client_add_id = dijit.byId(
										"c_editclientname_id").attr("value");
								var edithourval = "";
								var editminval = "";
								var editampmval = "";
								var endedithourval = "";
								var endeditminval = "";
								var endeditampmval = "";
								var c_editselectdateval = "";
								var c_raw_editselectdateval = "";
								var svcid = "";
								var newsvcid = "";
								var svctype = "";
								var cancel = "false";
								var svcprice = "";
								var notes = "";
								var whichtable = "agenda";
								var whichtabledate = "agendadate";
								var whichselectdate = "hSelectDate";
								var whichdialog = "editApptDialog";

								newsvcid = dijit.byId("editselect").attr(
										"value");
								svcid = dijit.byId("editdialogsvcid").attr(
										"value");
								if (newsvcid != svcid) {
									svcid = newsvcid;
								}
								svctype = dijit.byId("editdialogservicetype")
										.attr("value");
								svcprice = formatCurrency(dijit.byId(
										"editdialogprice").attr("value"));
								notes = dijit.byId("editdialognotes").attr(
										"value");
								edithourval = dijit.byId("fedithour").get(
										"value");
								editminval = dijit.byId("editminute").get(
										"value");
								editampmval = dijit.byId("editampm").get(
										"value");
								endedithourval = dijit.byId("fendedithour")
										.get("value");
								endeditminval = dijit.byId("endeditminute")
										.get("value");
								endeditampmval = dijit.byId("endeditampm").get(
										"value");
								c_editselectdateval = dijit.byId(
										"c_editselectdate").attr("value");
								c_raw_editselectdateval = dijit.byId(
										"c_editselectdate").attr("value");
								c_editselectdateval = dojo.date.locale.format(
										c_editselectdateval, {
											datePattern : "yyyy-MM-dd",
											selector : "date"
										});
								notes = escape(notes);
								// end of update appointment code : getting values from dialog

								var rawdate = c_raw_editselectdateval;
								var postdate = dojo.date.locale.format(rawdate,
										{
											datePattern : "yyyy-MM-dd",
											selector : "date"
										})

								var rawstaffid = staff_edit_id;
								window.console
										&& console.log("fapptstaff: "
												+ rawstaffid);
								if (!rawstaffid) {
									alert("Please select a staff");
									dijit.byId("fapptstaff_edit").focus();
									standby.hide();
									return false;
								}
								var rawcid = client_add_id;
								if (!rawcid) {
									alert("Please select a client");
									dijit.byId("c_editclientname_id").focus();
									standby.hide();
									return false;
								}
								var rawsvcid = svcid;
								if (!rawsvcid) {
									alert("Please select a service");
									dijit.byId("editdialogsvcid").focus();
									standby.hide();
									return false;
								}
								var rawhour = edithourval;
								if (!rawhour) {
									alert("Please select a begin hour");
									dijit.byId("fedithour").focus();
									standby.hide();
									return false;
								}

								var rawminute = editminval;
								if (!rawminute) {
									alert("Please select a begin minute");
									dijit.byId("editminute").focus();
									standby.hide();
									return false;
								}

								var rawampm = editampmval;
								if (!rawampm) {
									alert("Please select a begin am / pm");
									dijit.byId("editampm").focus();
									standby.hide();
									return false;
								}

								var rawnotes = notes;

								var rawehour = endedithourval;
								var raweminute = endeditminval;
								var raweampm = endeditampmval;

								var deferred2 = dojo
										.xhrPost({
											url : "myschedule/checkdatetimestaff",
											content : {
												staff : rawstaffid,
												hSelectDate : postdate,
												hour : rawhour,
												minute : rawminute,
												ampm : rawampm,
												ehour : rawehour,
												eminute : raweminute,
												eampm : raweampm
											},
											handleAs : "json",
											load : function(data) {
												standby.hide();
												if (data == "true") {
													window.console
															&& console
																	.log("THERE IS AN APPOINTMENT CONFLICT. DO YOU WISH TO BOOK APPOINTMENT ANYWAY?");
												}
											},
											error : function(error) {
												window.console
														&& console
																.log("ERROR FROM CHECKING APPOINTMENT");
												window.console
														&& console.log(error);
												standby.hide();
												window.location.reload();
											}
										}

										);
								var nextdeferred = deferred2
										.then(
												function(res) {
													var scheduleanyways = "true";
													var deferredyn = new dojo.Deferred();
													if (res == "true") {

														var x = confirm("Requested appointment overlaps an existing one.  Do you want to schedule appointment anyway?");
														if (x) {
															return "true";
														} else {
															return "false";
														}
													} else {
														res = "true";
													}
													return res;

												},
												function(err) {
													// This will be called when the deferred
													// is rejected
													window.console
															&& console
																	.log("ERROR "
																			+ err);
												});
								nextdeferred
										.then(
												function(res) {
													if (res == "true") {
														scheduleanyways(
																nextdeferredcheckout,
																postdate,
																rawstaffid,
																rawcid,
																rawsvcid,
																rawhour,
																rawminute,
																rawampm,
																rawnotes,
																rawehour,
																raweminute,
																raweampm);

													} else {
														window.console
																&& console
																		.log("no scheduling");
													}
												},
												function(err) {
													// This will be called when the deferred
													// is rejected
													window.console
															&& console
																	.log("ERROR "
																			+ err);
												});

								// clear inputs from form
								//dijit.byId("apptform").reset();
								// display todays agenda

							}
							function saveFormAppointment(dialogFields) {
								window.console
										&& console
												.log("SAVING APPOINTMENT FROM FORM");
								standby = new dojox.widget.Standby({
									target : "myTabContainer"
								});
								document.body.appendChild(standby.domNode);
								standby.show();
								var rawdate = dijit.byId("c_editselectdate")
										.attr("value")
								window.console
										&& console.log("c_editselectdate: "
												+ rawdate);
								var postdate = dojo.date.locale.format(rawdate,
										{
											datePattern : "yyyy-MM-dd",
											selector : "date"
										})
								window.console
										&& console.log("postdate: " + postdate);

								var rawstaffid = dijit.byId("fapptstaff").attr(
										"value");
								window.console
										&& console.log("fapptstaff: "
												+ rawstaffid);
								if (!rawstaffid) {
									alert("Please select a staff");
									dijit.byId("fapptstaff").focus();
									standby.hide();
									return false;
								}
								var rawcid = dijit.byId("fapptclient").attr(
										"value");
								window.console
										&& console
												.log("fapptclient: " + rawcid);
								if (!rawcid) {
									alert("Please select a client");
									dijit.byId("fapptclient").focus();
									standby.hide();
									return false;
								}
								var rawsvcid = dijit.byId("formapptservice")
										.attr("value");
								window.console
										&& console.log("formapptservice: "
												+ rawsvcid);
								if (!rawsvcid) {
									alert("Please select a service");
									dijit.byId("formapptservice").focus();
									standby.hide();
									return false;
								}
								var rawhour = dijit.byId("desiredhour").attr(
										"value");
								window.console
										&& console.log("hour: " + rawhour);
								if (!rawhour) {
									alert("Please select a begin hour");
									dijit.byId("desiredhour").focus();
									standby.hide();
									return false;
								}

								var rawminute = dijit.byId("desiredminute")
										.attr("value");
								window.console
										&& console.log("minute: " + rawminute);
								if (!rawminute) {
									alert("Please select a begin minute");
									dijit.byId("desiredminute").focus();
									standby.hide();
									return false;
								}

								var rawampm = dijit.byId("desiredampm").attr(
										"value");
								window.console
										&& console.log("ampm: " + rawampm);
								if (!rawampm) {
									alert("Please select a begin am / pm");
									dijit.byId("desiredampm").focus();
									standby.hide();
									return false;
								}

								var rawnotes = dijit.byId("notes")
										.attr("value");
								window.console
										&& console.log("notes: " + rawnotes);

								var rawehour = dijit.byId("desiredehour").attr(
										"value");
								window.console
										&& console.log("ehour: " + rawehour);

								var raweminute = dijit.byId("desiredeminute")
										.attr("value");
								window.console
										&& console
												.log("eminute: " + raweminute);

								var raweampm = dijit.byId("desiredeampm").attr(
										"value");
								window.console
										&& console.log("eampm: " + raweampm);
								var deferred2 = dojo
										.xhrPost({
											url : "myschedule/checkdatetimestaff",
											content : {
												staff : rawstaffid,
												hSelectDate : postdate,
												hour : rawhour,
												minute : rawminute,
												ampm : rawampm,
												ehour : rawehour,
												eminute : raweminute,
												eampm : raweampm
											},
											handleAs : "json",
											load : function(data) {
												window.console
														&& console
																.log("SUCCESS FROM CHECKING APPOINTMENT");
												window.console
														&& console
																.log("IS THERE AN APPOINTMENT CONFLICT? "
																		+ data);
												standby.hide();
												if (data == "true") {
													window.console
															&& console
																	.log("THERE IS AN APPOINTMENT CONFLICT. DO YOU WISH TO BOOK APPOINTMENT ANYWAY?");
												}
											},
											error : function(error) {
												window.console
														&& console
																.log("ERROR FROM CHECKING APPOINTMENT");
												window.console
														&& console.log(error);
												standby.hide();
												window.location.reload();
											}
										}

										);
								var nextdeferred = deferred2
										.then(
												function(res) {
													var scheduleanyways = "true";
													var deferredyn = new dojo.Deferred();
													if (res == "true") {

														var x = confirm("Requested appointment overlaps an existing one.  Do you want to schedule appointment anyway?");
														if (x) {
															return "true";
														} else {
															return "false";
														}
													} else {
														res = "true";
													}
													return res;

												},
												function(err) {
													// This will be called when the deferred
													// is rejected
													window.console
															&& console
																	.log("ERROR "
																			+ err);
												});
								nextdeferred
										.then(
												function(res) {
													if (res == "true") {
														scheduleanyways(
																postdate,
																rawstaffid,
																rawcid,
																rawsvcid,
																rawhour,
																rawminute,
																rawampm,
																rawnotes,
																rawehour,
																raweminute,
																raweampm);
													} else {
														window.console
																&& console
																		.log("no scheduling");
													}
												},
												function(err) {
													// This will be called when the deferred
													// is rejected
													window.console
															&& console
																	.log("ERROR "
																			+ err);
												});

								// clear inputs from form
								//dijit.byId("apptform").reset();
								// display todays agenda

							}
							function scheduleanyways(nextdeferredcheckout,
									postdate, rawstaffid, rawcid, rawsvcid,
									rawhour, rawminute, rawampm, rawnotes,
									rawehour, raweminute, raweampm) {
								var isthisagendaviewflagval = "false";
								isthisagendaviewflagval = dijit.byId(
										"isThisAgendaViewFlag").get("value");

								var er_wdg = dijit.byId("enable_recur");
								var enable_recur = er_wdg.attr("checked");
								window.console
										&& console.log("enable_recur : "
												+ enable_recur);
								var weekly = dijit.byId("weekly").attr(
										"checked");
								window.console
										&& console.log("weekly : " + weekly);
								var weeklyevery = dijit.byId("weeklyevery")
										.attr("checked");
								window.console
										&& console.log("weeklyevery : "
												+ weeklyevery);
								var weeklyeverytext = dijit.byId(
										"weeklyeverytext").attr("value");
								window.console
										&& console.log("weeklyeverytext : "
												+ weeklyeverytext);
								var everyweekdaysu = dijit.byId(
										"everyweekdaysu").attr("checked");
								window.console
										&& console.log("everyweekdaysu : "
												+ everyweekdaysu);
								var everyweekdaymo = dijit.byId(
										"everyweekdaymo").attr("checked");
								window.console
										&& console.log("everyweekdaymo : "
												+ everyweekdaymo);
								var everyweekdaytu = dijit.byId(
										"everyweekdaytu").attr("checked");
								window.console
										&& console.log("everyweekdaytu : "
												+ everyweekdaytu);
								var everyweekdaywe = dijit.byId(
										"everyweekdaywe").attr("checked");
								window.console
										&& console.log("everyweekdaywe : "
												+ everyweekdaywe);
								var everyweekdaythu = dijit.byId(
										"everyweekdaythu").attr("checked");
								window.console
										&& console.log("everyweekdaythu : "
												+ everyweekdaythu);
								var everyweekdayfri = dijit.byId(
										"everyweekdayfri").attr("checked");
								window.console
										&& console.log("everyweekdayfri : "
												+ everyweekdayfri);
								var everyweekdaysat = dijit.byId(
										"everyweekdaysat").attr("checked");
								window.console
										&& console.log("everyweekdaysat : "
												+ everyweekdaysat);
								var daily = dijit.byId("daily").attr("checked");
								window.console
										&& console.log("daily : " + daily);
								var every = dijit.byId("every").attr("checked");
								window.console
										&& console.log("every : " + every);
								var everytext = dijit.byId("everytext").attr(
										"value");
								window.console
										&& console.log("everytext : "
												+ everytext);
								var everyweekday = dijit.byId("everyweekday")
										.attr("checked");
								window.console
										&& console.log("everyweekday : "
												+ everyweekday);
								var monthly = dijit.byId("monthly").attr(
										"checked");
								window.console
										&& console.log("monthly : " + monthly);
								var everyday = dijit.byId("everyday").attr(
										"checked");
								window.console
										&& console
												.log("everyday : " + everyday);
								var everymonthdaytext = dijit.byId(
										"everymonthdaytext").attr("value");
								window.console
										&& console.log("everymonthdaytext : "
												+ everymonthdaytext);
								var everymonthtext = dijit.byId(
										"everymonthtext").attr("value");
								window.console
										&& console.log("everymonthtext : "
												+ everymonthtext);
								var everyregex = dijit.byId("everyregex").attr(
										"checked");
								window.console
										&& console.log("everyregex : "
												+ everyregex);
								var everynthdaytext = dijit.byId(
										"everynthdaytext").attr("value");
								window.console
										&& console.log("everynthdaytext : "
												+ everynthdaytext);
								var everynthmonthtext = dijit.byId(
										"everynthmonthtext").attr("value");
								window.console
										&& console.log("everynthmonthtext : "
												+ everynthmonthtext);
								var everyhowmanymonthtext = dijit.byId(
										"everyhowmanymonthtext").attr("value");
								window.console
										&& console
												.log("everyhowmanymonthtext : "
														+ everyhowmanymonthtext);
								var endafter = dijit.byId("endafter").attr(
										"checked");
								window.console
										&& console
												.log("endafter : " + endafter);
								var endafterxoccur = dijit.byId(
										"endafterxoccur").attr("value");
								window.console
										&& console.log("endafterxoccur : "
												+ endafterxoccur);
								var everydate = dijit.byId("everydate").attr(
										"checked");
								window.console
										&& console.log("everydate : "
												+ everydate);
								var rangerecurEndDate = dijit.byId(
										"rangerecurEndDate").attr("value");
								var req_indicator = dijit.byId('progButton')
										.attr('value');

								if (rangerecurEndDate != null) {
									window.console
											&& console
													.log("rangerecurEndDate : "
															+ rangerecurEndDate);
									var erdate = dojo.date.locale.format(
											rangerecurEndDate, {
												datePattern : "yyyy-MM-dd",
												selector : "date"
											})
									window.console
											&& console
													.log("erdate : " + erdate);
									rangerecurEndDate = erdate;
								}
								standby.show();
								//Call the asynchronous xhrPost
								var deferred = dojo
										.xhrPost({
											url : "myschedule/createappt",
											content : {
												hSelectDate : postdate,
												staffid : rawstaffid,
												clientid : rawcid,
												svcid : rawsvcid,
												hour : rawhour,
												minute : rawminute,
												ampm : rawampm,
												notes : rawnotes,
												ehour : rawehour,
												eminute : raweminute,
												eampm : raweampm,
												enable_recur : enable_recur,
												weekly : weekly,
												weeklyevery : weeklyevery,
												weeklyeverytext : weeklyeverytext,
												everyweekdaysu : everyweekdaysu,
												everyweekdaymo : everyweekdaymo,
												everyweekdaytu : everyweekdaytu,
												everyweekdaywe : everyweekdaywe,
												everyweekdaythu : everyweekdaythu,
												everyweekdayfri : everyweekdayfri,
												everyweekdaysat : everyweekdaysat,
												daily : daily,
												every : every,
												everytext : everytext,
												everyweekday : everyweekday,
												monthly : monthly,
												everyday : everyday,
												everymonthdaytext : everymonthdaytext,
												everymonthtext : everymonthtext,
												everyregex : everyregex,
												everynthdaytext : everynthdaytext,
												everynthmonthtext : everynthmonthtext,
												everyhowmanymonthtext : everyhowmanymonthtext,
												endafter : endafter,
												endafterxoccur : endafterxoccur,
												everydate : everydate,
												rangerecurEndDate : rangerecurEndDate,
												ri : req_indicator
											},
											handleAs : "text",
											load : function(data) {
												window.console
														&& console
																.log("SUCCESS FROM CREATE APPOINTMENT");
												window.console
														&& console.log(data);
												try {
													dijit.byId("fapptclient")
															.reset();
												} catch (err) {
													window.console
															&& console
																	.log("could not reset inputs: "
																			+ err);
												}
												try {
													dijit.byId(
															"formapptservice")
															.reset();
												} catch (err) {
													window.console
															&& console
																	.log("could not reset inputs: "
																			+ err);
												}
												try {
													dijit.byId("desiredhour")
															.set("value", "1");
												} catch (err) {
													window.console
															&& console
																	.log("could not reset inputs: "
																			+ err);
												}
												try {
													dijit.byId("desiredminute")
															.set("value", "00");
												} catch (err) {
													window.console
															&& console
																	.log("could not reset inputs: "
																			+ err);
												}
												try {
													dijit.byId("desiredampm")
															.set("value", "am");
												} catch (err) {
													window.console
															&& console
																	.log("could not reset inputs: "
																			+ err);
												}
												try {
													dijit
															.byId("notes")
															.set("value",
																	"insert notes here");
												} catch (err) {
													window.console
															&& console
																	.log("could not reset inputs: "
																			+ err);
												}
												try {
													window.console
															&& console
																	.log("before entering displayEditTodaysAgenda postdate "
																			+ postdate);
													if (isthisagendaviewflagval == 'false') {
														displayEditTodaysAgenda(postdate);
													} else {
														loadAgenda1();
													}

												} catch (err) {
													window.console
															&& console
																	.log("save form appointment could not display todays agenda error message :\n "
																			+ err);
													standby.hide();
												}

												if (global_selected_staff != '') {
													var staffselectwidget = dijit
															.byId("fapptstaff");
													staffselectwidget
															.set("value",
																	global_selected_staff);
												}

												if (nextdeferredcheckout) {
													nextdeferredcheckout
															.resolve(data);
												}
												standby.hide();
											},
											error : function(error) {
												window.console
														&& console
																.log("ERROR FROM CREATE APPOINTMENT");
												window.console
														&& console.log(error);
												window.location.reload();
											}
										}

										);
							}
							function validateSelect(value, constraints) {
								var isValid = false;
								alert(value);
								window.console && console.log("value " + value);
								return isValid;
							}
							function savePersonal(dialogFields) {
								standby.show();
								var isthisagendaviewflagval = "false";
								var personalstaffval = "";
								var personalhourval = "";
								var personalminval = "";
								var personalampmval = "";
								var personalendhourval = "";
								var personalendminval = "";
								var personalendampmval = "";

								var personalreason = "";
								var personalnotes = "";

								var c_personalselectdateval = "";
								if (dijit.byId('personalDialog').isValid()) {
									isthisagendaviewflagval = dijit.byId(
											"isThisAgendaViewFlag")
											.get("value");

									personalstaffval = dijit.byId(
											"fapptstaff_personal").get("value");
									personalhourval = dijit
											.byId("personalhour").get("value");
									personalminval = dijit.byId(
											"personalminute").get("value");
									personalampmval = dijit
											.byId("personalampm").get("value");
									personalendhourval = dijit.byId(
											"personalendhour").get("value");
									personalendminval = dijit.byId(
											"personalendminute").get("value");
									personalendampmval = dijit.byId(
											"personalendampm").get("value");

									personalreason = dijit.byId(
											"personalreason").get("value");
									personalnotes = dijit.byId("personalnotes")
											.get("value");

									c_personalselectdateval = dijit.byId(
											"hPersonalSelectDate")
											.attr("value");

									var rawdate = dijit.byId(
											"c_personalselectdate").attr(
											"value")
									window.console
											&& console.log("c_editselectdate: "
													+ rawdate);
									var postdate = dojo.date.locale.format(
											rawdate, {
												datePattern : "yyyy-MM-dd",
												selector : "date"
											})
									window.console
											&& console.log("postdate: "
													+ postdate);

									//Call the asynchronous xhrPost
									var deferred = dojo
											.xhrPost({
												url : "myschedule/createpersonal",
												content : {
													hSelectDate : postdate,
													staff : personalstaffval,
													hour : personalhourval,
													minute : personalminval,
													ampm : personalampmval,
													notes : personalnotes,
													label : personalreason,
													ehour : personalendhourval,
													eminute : personalendminval,
													eampm : personalendampmval
												},
												handleAs : "text",
												load : function(data) {
													window.console
															&& console
																	.log("SUCCESS FROM CREATE PERSONAL APPOINTMENT");
													window.console
															&& console
																	.log(data);
													try {
														var postdate = dojo.date.locale
																.format(
																		rawdate,
																		{
																			datePattern : "yyyy-MM-dd",
																			selector : "date"
																		})
														window.console
																&& console
																		.log("about to enter displayEditTodaysAgenda from updateappointment date: "
																				+ postdate);
														if (isthisagendaviewflagval == 'false') {
															displayEditTodaysAgenda(postdate);
														} else {
															window.console
																	&& console
																			.log("THIS IS SUPPOSED TO UPDATE AGENDA VIEW WITH NEW TIME BLOCK");
															loadAgenda1();
														}
													} catch (err) {
														window.console
																&& console
																		.log("updateappointment could not display todays agenda error message :\n "
																				+ err);
														try {
															window.console
																	&& console
																			.log("before entering displayEditTodaysAgenda rawdate "
																					+ rawdate);
															if (isthisagendaviewflagval == 'false') {
																displayEditTodaysAgenda(rawdate);
															} else {
																window.console
																		&& console
																				.log("THIS IS SUPPOSED TO UPDATE AGENDA VIEW WITH NEW TIME BLOCK");
																loadAgenda1();
															}

														} catch (err) {
															window.console
																	&& console
																			.log("updateappointment again could not display todays agenda error message :\n "
																					+ err);
															standby.hide();
														}

														standby.hide();
													}

													standby.hide();
												},
												error : function(error) {
													window.console
															&& console
																	.log("ERROR FROM CREATE PERSONAL APPOINTMENT");
													window.console
															&& console
																	.log(error);
													window.location.reload();
												}
											}

											);
								} else {
									alert("Fill out the form.");
								}
							}
							function updatePersonal(dialogFields) {
								standby.show();
								var personalhourval = "";
								var personalminval = "";
								var personalampmval = "";
								var personalendhourval = "";
								var personalendminval = "";
								var personalendampmval = "";
								var editpersonalapptid = "";
								var personalreason = "";
								var personalnotes = "";
								var personalstaffval = "";
								var isthisagendaviewflagval = "false";

								var c_personalselectdateval = "";

								editpersonalapptid = dijit.byId(
										"editpersonalapptid").get("value");
								if (editpersonalapptid != "") {
									isthisagendaviewflagval = dijit.byId(
											"isThisAgendaViewFlag")
											.get("value");
									window.console
											&& console
													.log("isthisagendaviewflagval: "
															+ isthisagendaviewflagval);
									personalhourval = dijit
											.byId("personalhour").get("value");
									personalstaffval = dijit.byId(
											"fapptstaff_personal").get("value");
									personalminval = dijit.byId(
											"personalminute").get("value");
									personalampmval = dijit
											.byId("personalampm").get("value");
									personalendhourval = dijit.byId(
											"personalendhour").get("value");
									personalendminval = dijit.byId(
											"personalendminute").get("value");
									personalendampmval = dijit.byId(
											"personalendampm").get("value");

									personalreason = dijit.byId(
											"personalreason").get("value");
									personalnotes = dijit.byId("personalnotes")
											.get("value");

									c_personalselectdateval = dijit.byId(
											"hPersonalSelectDate")
											.attr("value");
									var rawdate = dijit.byId(
											"c_personalselectdate").attr(
											"value");
									var agendadate = dijit.byId(
											"c_editselectdate").attr("value");
									window.console
											&& console
													.log("c_personalselectdate: "
															+ rawdate);
									var postdate = dojo.date.locale.format(
											rawdate, {
												datePattern : "yyyy-MM-dd",
												selector : "date"
											})
									window.console
											&& console.log("postdate: "
													+ postdate);

									//Call the asynchronous xhrPost
									var deferred = dojo
											.xhrPost({
												url : "myschedule/updatepersonal",
												content : {
													appointmentid : editpersonalapptid,
													staff : personalstaffval,
													hSelectDate : postdate,
													hour : personalhourval,
													minute : personalminval,
													ampm : personalampmval,
													notes : personalnotes,
													label : personalreason,
													ehour : personalendhourval,
													eminute : personalendminval,
													eampm : personalendampmval
												},
												handleAs : "text",
												load : function(data) {
													window.console
															&& console
																	.log("SUCCESS FROM UPDATE PERSONAL APPOINTMENT");
													window.console
															&& console
																	.log(data);
													try {
														var postdate = dojo.date.locale
																.format(
																		agendadate,
																		{
																			datePattern : "yyyy-MM-dd",
																			selector : "date"
																		})
														window.console
																&& console
																		.log("about to enter displayEditTodaysAgenda from updateappointment date: "
																				+ postdate);
														if (isthisagendaviewflagval == "false") {
															displayEditTodaysAgenda(postdate);
														} else {
															window.console
																	&& console
																			.log("UPDATE THE AGENDA VIEW EVENT");
															loadAgenda1();
														}
													} catch (err) {
														window.console
																&& console
																		.log("updateappointment could not display todays agenda error message :\n "
																				+ err);
														try {
															window.console
																	&& console
																			.log("before entering displayEditTodaysAgenda rawdate "
																					+ agendadate);
															if (isthisagendaviewflagval == "false") {
																displayEditTodaysAgenda(rawdate);
															} else {
																window.console
																		&& console
																				.log("UPDATE THE AGENDA VIEW EVENT");
																loadAgenda1();
															}
														} catch (err) {
															window.console
																	&& console
																			.log("updateappointment again could not display todays agenda error message :\n "
																					+ err);
															standby.hide();
														}

														standby.hide();
													}

													standby.hide();
												},
												error : function(error) {
													window.console
															&& console
																	.log("ERROR FROM UPDATE PERSONAL APPOINTMENT");
													window.console
															&& console
																	.log(error);
													window.location.reload();
												}
											}

											);
								} else {
									alert("This is not a valid Personal Time.");
								}
							}
							function updateAppointment(nextdeferred) {
								var addAppt = dijit.byId(
										'isThisADDAgendaViewFlag').get("value");
								if (addAppt == "true") {

									if (dijit.byId("enable_recur").get(
											"checked")) {

										if (!dijit.byId("weekly")
												.get("checked")
												&& !dijit.byId("weeklyevery")
														.get("checked")
												&& !dijit.byId("daily").get(
														"checked")
												&& !dijit.byId("every").get(
														"checked")
												&& !dijit.byId("everyweekday")
														.get("checked")
												&& !dijit.byId("monthly").get(
														"checked")
												&& !dijit.byId("everyday").get(
														"checked")
												&& !dijit.byId("everyregex")
														.get("checked")) {
											alert("You need to select at least one option from daily, weekly or monthly.  For Recurring.");
											return;
										}
										if (!dijit.byId("endafter").get(
												"checked")
												&& !dijit.byId("everydate")
														.get("checked")) {
											alert("You need to select at least one ending type. Either by occurrence or date. For Recurring.");
											return;
										}

										if (dijit.byId("everydate").get(
												"checked")) {
											var rangerecurEndDate = dijit.byId(
													"rangerecurEndDate").attr(
													"value");
											if (rangerecurEndDate == null) {
												alert("Please select a end date for recurring.");
												dijit.byId("rangerecurEndDate")
														.focus();
												return;
											}
										}
										if (dijit.byId("weeklyevery").get(
												"checked")) {
											var su = dijit.byId(
													"everyweekdaysu").get(
													"checked");
											var mo = dijit.byId(
													"everyweekdaymo").get(
													"checked");
											var tu = dijit.byId(
													"everyweekdaytu").get(
													"checked");
											var we = dijit.byId(
													"everyweekdaywe").get(
													"checked");
											var th = dijit.byId(
													"everyweekdaythu").get(
													"checked");
											var fri = dijit.byId(
													"everyweekdayfri").get(
													"checked");
											var sat = dijit.byId(
													"everyweekdaysat").get(
													"checked");
											if (!su && !mo && !tu && !we && !th
													&& !fri && !sat) {
												alert("Please select at least one weekday for recurring.");
												return;
											}

										}
										if (dijit.byId("everyregex").get(
												"checked")) {
											var everynthdaytext = dijit.byId(
													"everynthdaytext").attr(
													"value");
											var everynthmonthtext = dijit.byId(
													"everynthmonthtext").attr(
													"value");
											if (everynthdaytext == 'sel'
													|| everynthmonthtext == 'sel') {
												alert("Please select from the monthly selection for recurring.");
												return;
											}
										}
									}

									window.console
											&& console
													.log("validate editApptDialog: "
															+ dijit
																	.byId(
																			'editApptDialog')
																	.validate());
									if (dijit.byId('editApptDialog').validate()) {
										var isthistrueorfalse = addAppointmentForFC(nextdeferred);
										if (isthistrueorfalse != false) {
											dijit.byId('editApptDialog').hide();
										}
									}

								} else {
									var erp = dijit.byId("edit_recur_parent")
											.attr("value");
									var updatefuture = "false";
									if (erp != '') {
										var x = confirm("Do you wish to update future appointments too?");
										if (x) {
											updatefuture = "true";
										} else {
											updatefuture = "false";
										}
									}

									standby.show();

									var isThisEditAgendaViewFlag = "false";
									isThisEditAgendaViewFlag = dijit.byId(
											"isThisEditAgendaViewFlag").attr(
											"value");

									var id = dijit.byId("editdialogapptid")
											.attr("value");

									var staff_edit_id = dijit.byId(
											"fapptstaff_edit").attr("value");
									var edithourval = "";
									var editminval = "";
									var editampmval = "";
									var endedithourval = "";
									var endeditminval = "";
									var endeditampmval = "";
									var c_editselectdateval = "";
									var c_raw_editselectdateval = "";
									var svcid = "";
									var newsvcid = "";
									var svctype = "";
									var cancel = "false";
									var svcprice = "";
									var notes = "";
									var whichtable = "agenda";
									var whichtabledate = "agendadate";
									var whichselectdate = "hSelectDate";
									var whichdialog = "editApptDialog";

									newsvcid = dijit.byId("editselect").attr(
											"value");
									window.console
											&& console
													.log('the new service id : '
															+ newsvcid);
									svcid = dijit.byId("editdialogsvcid").attr(
											"value");
									if (newsvcid != svcid) {
										svcid = newsvcid;
									}
									svctype = dijit.byId(
											"editdialogservicetype").attr(
											"value");
									svcprice = formatCurrency(dijit.byId(
											"editdialogprice").attr("value"));
									notes = dijit.byId("editdialognotes").attr(
											"value");
									edithourval = dijit.byId("fedithour").get(
											"value");
									editminval = dijit.byId("editminute").get(
											"value");
									editampmval = dijit.byId("editampm").get(
											"value");
									endedithourval = dijit.byId("fendedithour")
											.get("value");
									endeditminval = dijit.byId("endeditminute")
											.get("value");
									endeditampmval = dijit.byId("endeditampm")
											.get("value");
									c_editselectdateval = dijit.byId(
											"c_editselectdate").attr("value");
									c_raw_editselectdateval = dijit.byId(
											"c_editselectdate").attr("value");
									c_editselectdateval = dojo.date.locale
											.format(c_editselectdateval, {
												datePattern : "yyyy-MM-dd",
												selector : "date"
											});

									var req_indicator = dijit
											.byId('progButton').attr('value');

									notes = escape(notes);

									var deferred = dojo
											.xhrGet({
												url : "myschedule/updateedit?staffid="
														+ staff_edit_id
														+ "&aid="
														+ id
														+ "&c="
														+ cancel
														+ "&sid="
														+ svcid
														+ "&st="
														+ svctype
														+ "&sp="
														+ svcprice
														+ "&n="
														+ notes
														+ "&hour="
														+ edithourval
														+ "&min="
														+ editminval
														+ "&ap="
														+ editampmval
														+ "&d="
														+ c_editselectdateval
														+ "&ehour="
														+ endedithourval
														+ "&emin="
														+ endeditminval
														+ "&eap="
														+ endeditampmval
														+ "&uf="
														+ updatefuture
														+ "&ri="
														+ req_indicator,
												preventCache : true,
												handleAs : "text",
												load : function(response,
														newValue) {

													if (isThisEditAgendaViewFlag == "false") {
														window.console
																&& console
																		.log("LOOK AT ME!!!");
														updateCustomPriceForService(
																svcid, id,
																svcprice);
														var isJSON;
														//window.console && console.log("the appointment object returned: "+response);
														var data;
														try {
															data = JSON
																	.parse(response);
															isJSON = true;
														} catch (e) {
															isJSON = false;
														}
														if (isJSON) {
															if (data.constructor == Array) {
																var mytable = document
																		.getElementById(whichtable);
																var oldagendaheader = document
																		.getElementById(whichtabledate);
																var rawdate = document
																		.getElementById("hSelectDate").value;
																if (rawdate == "") {
																	rawdate = dojo.date.locale
																			.format(
																					new Date(),
																					{
																						datePattern : "yyyy-MM-dd",
																						selector : "date"
																					});
																}
																oldagendaheader.innerHTML = "Agenda for "
																		+ rawdate;
																remove("appointment"
																		+ id);
																var mycurrent_row, mycurrent_cell;
																mytable = document
																		.getElementById(whichtable);

																for ( var key in data) {
																	var sbeginetimex = data[key].s_beginDateTime;
																	var sendetimex = data[key].s_endDateTime;

																	var myTime = new Date(
																			data[key].beginDateTime.timeInMillis);
																	var myEndTime = new Date(
																			data[key].endDateTime.timeInMillis);
																	var endhh = myEndTime
																			.getHours();
																	var endmm = myEndTime
																			.getMinutes();

																	var hh = myTime
																			.getHours();
																	var mm = myTime
																			.getMinutes();
																	var ss = myTime
																			.getSeconds();
																	var ms = myTime
																			.getMilliseconds();
																	var ap = "am";
																	var endap = "am";

																	if (hh > 11) {
																		ap = "pm";
																	}
																	if (hh > 12) {
																		hh = hh - 12;
																	}
																	if (hh == 0) {
																		hh = 12;
																	}

																	if (endhh > 11) {
																		endap = "pm";
																	}
																	if (endhh > 12) {
																		endhh = endhh - 12;
																	}
																	if (endhh == 0) {
																		endhh = 12;
																	}

																	var timetext = "Begin: "
																			+ hh
																			+ ":"
																			+ mm
																			+ " "
																			+ ap;
																	var endtimetext = "End: "
																			+ endhh
																			+ ":"
																			+ endmm
																			+ " "
																			+ endap;

																	mycurrent_row = document
																			.createElement("tr");

																	mycurrent_row
																			.setAttribute(
																					"id",
																					"appointment"
																							+ data[key].id);
																	mycurrent_row
																			.setAttribute(
																					"onMouseOver",
																					"this.className='highlight'");
																	mycurrent_row
																			.setAttribute(
																					"onMouseOut",
																					"this.className='normal'");
																	mycurrent_cell = document
																			.createElement("td");
																	var svc = data[key].servicename1
																			+ " $"
																			+ formatCurrency(data[key].service1cost);
																	if (data[key].client != null) {
																		mycurrent_row
																				.setAttribute(
																						"status",
																						data[key].status);
																		mycurrent_row
																				.setAttribute(
																						"onClick",
																						"doAjax("
																								+ data[key].id
																								+ ",'"
																								+ whichdialog
																								+ "');");
																		sometext = "STATUS: "
																				+ data[key].status
																				+ " "
																				+ data[key].client.firstName
																				+ " "
																				+ data[key].client.lastName
																				+ " "
																				+ sbeginetimex
																				+ " -- "
																				+ sendetimex
																				+ " "
																				+ svc;
																	} else {
																		mycurrent_row
																				.setAttribute(
																						"status",
																						"PERSONAL");
																		mycurrent_row
																				.setAttribute(
																						"onClick",
																						"doAjax("
																								+ data[key].id
																								+ ",'personalDialog');");
																		sometext = "STATUS: "
																				+ data[key].status
																				+ " TIME BLOCK "
																				+ data[key].personallabel
																				+ " "
																				+ sbeginetimex
																				+ " -- "
																				+ sendetimex
																				+ " ";
																	}
																	var datatext = document
																			.createTextNode(" "
																					+ sometext);

																	mycurrent_cell
																			.appendChild(datatext);
																	mycurrent_row
																			.appendChild(mycurrent_cell);
																	mytable
																			.appendChild(mycurrent_row);
																}
															} else {
																sometext = data[0].description;
																window.console
																		&& console
																				.log(sometext);

															}
															try {
																window.console
																		&& console
																				.log("1 LOOKING FOR DATE ERROR: rawdate : "
																						+ rawdate);
																var postdate = "";
																postdate = dojo.date.locale
																		.format(
																				rawdate,
																				{
																					datePattern : "yyyy-MM-dd",
																					selector : "date"
																				})
																window.console
																		&& console
																				.log("about to enter displayEditTodaysAgenda from updateappointment date: "
																						+ postdate);
																//displayEditTodaysAgenda(postdate);
																dijit
																		.byId(
																				"c_editselectdate")
																		.set(
																				"value",
																				rawdate);
															} catch (err) {
																window.console
																		&& console
																				.log("updateappointment could not display todays agenda error message :\n "
																						+ err);
																try {
																	window.console
																			&& console
																					.log("before entering displayEditTodaysAgenda c_editselectdateval "
																							+ c_editselectdateval);
																	dijit
																			.byId(
																					"c_editselectdate")
																			.set(
																					"value",
																					c_raw_editselectdateval);
																	//displayEditTodaysAgenda(c_raw_editselectdateval);
																} catch (err) {
																	window.console
																			&& console
																					.log("updateappointment again could not display todays agenda error message :\n "
																							+ err);
																	standby
																			.hide();
																}
																standby.hide();
															}
															dijit
																	.byId(
																			'editApptDialog')
																	.hide();

															dijit
																	.byId(
																			whichdialog)
																	.reset();
															dijit
																	.byId(
																			"progButton")
																	.set(
																			"label",
																			"Select one");
															dijit
																	.byId(
																			"progButton")
																	.set(
																			"value",
																			"");
														} else {
															// try treating it as XML
														}
													} else {
														loadAgenda1();
														dijit
																.byId(
																		'editApptDialog')
																.hide();

													}
													if (nextdeferred) {
														nextdeferred
																.resolve(id);
													}
													standby.hide();
													return response;
												},
												error : function(error) {
													window.console
															&& console
																	.log("ERROR FROM UPDATE APPOINTMENT");
													window.console
															&& console
																	.log(error);
													standby.hide();
													window.location.reload();
												}
											});
									return deferred;
								}

							}
						</script>
						<div id="weekTab">
							<div id="weekcalendar">_</div>
						</div>
						<script type="text/javascript">
							Spring.addDecoration(new Spring.ElementDecoration({
								elementId : 'weekTab',
								widgetType : 'dijit.layout.ContentPane',
								widgetAttrs : {
									title : 'Week at a glance',
									selected : true
								}
							}));
						</script>
						<div id="monthTab">
							<div id="monthcalendar">_</div>
						</div>
						<script type="text/javascript">
							Spring.addDecoration(new Spring.ElementDecoration({
								elementId : 'monthTab',
								widgetType : 'dijit.layout.ContentPane',
								widgetAttrs : {
									title : 'Month at a glance',
									selected : true
								}
							}));
						</script>
						<script type="text/javascript">
							Spring.addDecoration(new Spring.ElementDecoration({
								elementId : 'myTabContainer',
								widgetType : 'dijit.layout.TabContainer'
							}));
						</script>
						<script type="text/javascript">
							Spring.addDecoration(new Spring.ElementDecoration({
								elementId : 'myRecurTabContainer',
								widgetType : 'dijit.layout.TabContainer'
							}));
						</script>
						<script type="text/javascript">
							/*
							creates a json object from the data input
							 */
							function convertToJsonObject(response) {
								var isJSON;
								var data;
								try {
									//window.console && console.log(response);
									data = JSON.parse(response);
									window.console && console.log(data);
									isJSON = true;
								} catch (e) {
									isJSON = false;
								}

								if (isJSON) {
									// data is already parsed, so just use it
									// handle response codes
									// do something with returned data

									if (data instanceof Array) {

										var cntr = 0;
										var myCars = new Array(); // regular array (add an optional integer
										for ( var key in data) {
											bigdata = new Object();
											bigdata.id = data[key].id;
											bigdata.name = data[key].description
													+ " ("
													+ data[key].amounttime
													+ ")";
											bigdata.amounttime = data[key].amounttime;

											myCars[cntr] = bigdata;
											cntr = cntr + 1;
										}
										person = new Object();
										person.items = myCars;
										person.identifier = 'id';
										person.label = 'name';
										return person;

									} else {
										window.console && console.log(data.id);
										window.console
												&& console.log(data.value);
										bigdata = new Object();
										bigdata.id = data.id;
										bigdata.name = data.description;

										var myCars = new Array(); // regular array (add an optional integer
										myCars[0] = bigdata;

										person = new Object();
										person.items = myCars;
										person.identifier = 'id';
										person.label = 'name';
										return person;

									}
								}
							}
							/*
							creates a json object from the clients data input
							 */
							function convertClientsToJsonObject(response) {
								var isJSON;
								var data;
								try {
									data = JSON.parse(response);
									isJSON = true;
								} catch (e) {
									isJSON = false;
								}

								if (isJSON) {
									// data is already parsed, so just use it
									// handle response codes
									// do something with returned data

									if (data instanceof Array) {

										var cntr = 0;
										var myCars = new Array(); // regular array (add an optional integer
										for ( var key in data) {
											bigdata = new Object();
											bigdata.id = data[key].id;
											bigdata.name = data[key].firstName
													+ " " + data[key].lastName;

											myCars[cntr] = bigdata;
											cntr = cntr + 1;
										}
										person = new Object();
										person.items = myCars;
										person.identifier = 'id';
										person.label = 'name';
										return person;

									} else {
										bigdata = new Object();
										bigdata.id = data.id;
										bigdata.name = data.firstName + " "
												+ data.lastName;

										var myCars = new Array(); // regular array (add an optional integer
										myCars[0] = bigdata;

										person = new Object();
										person.items = myCars;
										person.identifier = 'id';
										person.label = 'name';
										return person;

									}
								}
							}
							function loadClientsList() {
								standby.hide();
								standby.show();
								var deferred = dojo
										.xhrGet({
											url : "myschedule/jsonclients",
											handleAs : "json",
											preventCache : true,
											load : function(response) {
												var XstateStore = new Array();
												XstateStore = response;
												var convertedjsonobject = convertClientsToJsonObject(JSON
														.stringify(XstateStore));

												usethisstore = new dojo.data.ItemFileReadStore(
														{
															data : convertedjsonobject
														});
												var isclientlistexists = dijit
														.byId("fapptclient");
												var iseditclientlistexists = dijit
														.byId("c_editclientname_id");

												if (iseditclientlistexists) {
													iseditclientlistexists.store = usethisstore;

												} else {
													var testeditobject = new dijit.form.FilteringSelect(
															{
																store : usethisstore,
																autoComplete : true,

																id : "c_editclientname_id"
															},
															"c_editclientname_id");

												}

												if (isclientlistexists) {
													isclientlistexists.store = usethisstore;

												} else {
													var testobject = new dijit.form.FilteringSelect(
															{
																store : usethisstore,
																autoComplete : true,

																id : "fapptclient"
															}, "fapptclient");
												}
												standby.hide();
											},
											error : function(error) {
												standby.hide();
												window.location.reload();
											}
										});

							}

							function zeroFill(number, width) {
								width -= number.toString().length;
								if (width > 0) {
									return new Array(width
											+ (/\./.test(number) ? 2 : 1))
											.join('0')
											+ number;
								}
								return number;
							}

							function toggleVis(btn, do_show) {
								cells = document
										.getElementsByName('tcol' + btn);
								if (do_show) {
									$(
											"#agenda_view_table td:nth-child("
													+ btn + "),th:nth-child("
													+ btn + ")").show();

									$('#agendaview1').fullCalendar('destroy');
									loadAgenda1();

									$('#agendaview2').fullCalendar('destroy');
									loadAgenda2();

									$('#agendaview3').fullCalendar('destroy');
									loadAgenda3();

									$('#agendaview4').fullCalendar('destroy');
									loadAgenda4();

									$('#agendaview5').fullCalendar('destroy');
									loadAgenda5();

									$('#agendaview6').fullCalendar('destroy');
									loadAgenda6();

									$('#agendaview7').fullCalendar('destroy');
									loadAgenda7();

									$('#agendaview8').fullCalendar('destroy');
									loadAgenda8();

									$('#agendaview9').fullCalendar('destroy');
									loadAgenda9();

									$('#agendaview10').fullCalendar('destroy');
									loadAgenda10();

									$('#agendaview11').fullCalendar('destroy');
									loadAgenda11();

								} else {
									$(
											"#agenda_view_table td:nth-child("
													+ btn + "),th:nth-child("
													+ btn + ")").hide();

									if (btn != 1) {
										$('#agendaview1').fullCalendar(
												'destroy');
										loadAgenda1();
									}

									if (btn != 2) {
										$('#agendaview2').fullCalendar(
												'destroy');
										loadAgenda2();
									}

									if (btn != 3) {
										$('#agendaview3').fullCalendar(
												'destroy');
										loadAgenda3();
									}

									if (btn != 4) {
										$('#agendaview4').fullCalendar(
												'destroy');
										loadAgenda4();
									}

									if (btn != 5) {
										$('#agendaview5').fullCalendar(
												'destroy');
										loadAgenda5();
									}

									if (btn != 6) {
										$('#agendaview6').fullCalendar(
												'destroy');
										loadAgenda6();
									}

									if (btn != 7) {
										$('#agendaview7').fullCalendar(
												'destroy');
										loadAgenda7();
									}

									if (btn != 8) {
										$('#agendaview8').fullCalendar(
												'destroy');
										loadAgenda8();
									}

									if (btn != 9) {
										$('#agendaview9').fullCalendar(
												'destroy');
										loadAgenda9();
									}

									if (btn != 10) {
										$('#agendaview10').fullCalendar(
												'destroy');
										loadAgenda10();
									}

									if (btn != 11) {
										$('#agendaview11').fullCalendar(
												'destroy');
										loadAgenda11();
									}

								}

							}
							require(
									[ "dojo/ready", "dijit/registry",
											"dojox/mobile/ContentPane" ],
									function(ready, registry) { // not including ContentPane in the callback since its not used in the code below
										ready(function() { // note: ready() is not identical to domReady! plugin -- ready still takes into account parser if parseOnLoad is true 

											registry.byId("editApptDialog").onShow = function() {
												editservicecounter = 0;
											};
											dojo
													.connect(
															registry
																	.byId("editcategories"),
															"onChange",
															function(
																	selectedcatid) {
																window.console
																		&& console
																				.log('selectedcatid: '
																						+ selectedcatid);
																if (selectedcatid == '0') {
																	var cntr = 0;
																	var myCars = new Array(); // regular array (add an optional integer
																	for ( var key in servicesArray) {
																		var service = servicesArray[key];
																		window.console
																				&& console
																						.log('serviceid: '
																								+ service.serviceid);
																		window.console
																				&& console
																						.log('description: '
																								+ service.description);
																		window.console
																				&& console
																						.log('amountoftime: '
																								+ service.amountoftime);

																		bigdata = new Object();
																		bigdata.value = service.serviceid;
																		bigdata.name = service.description
																				+ " ("
																				+ service.amountoftime
																				+ ")";

																		myCars[cntr] = bigdata;
																		cntr = cntr + 1;
																	}
																	person = new Object();
																	person.items = myCars;
																	person.identifier = 'value';
																	person.label = 'description';
																	var pstore = new dojo.data.ItemFileReadStore(
																			{
																				'data' : person
																			});
																	var cwidget = registry
																			.byId("editselect");
																	if (editservicecounter != 0
																			&& cwidget) {
																		cwidget
																				.reset();
																		cwidget.store = pstore;
																	} else {
																		editservicecounter = editservicecounter + 1;
																	}
																} else {
																	if (categoryservicesArray.length > 0) {
																		var cntr = 0;
																		var myCars = new Array(); // regular array (add an optional integer
																		for ( var key in categoryservicesArray) {
																			var catservice = categoryservicesArray[key];
																			if (selectedcatid == catservice.categoryid) {
																				window.console
																						&& console
																								.log('categoryid: '
																										+ catservice.categoryid);
																				window.console
																						&& console
																								.log('serviceid: '
																										+ catservice.serviceid);
																				window.console
																						&& console
																								.log('description: '
																										+ catservice.description);
																				window.console
																						&& console
																								.log('amountoftime: '
																										+ catservice.amountoftime);

																				bigdata = new Object();
																				bigdata.value = catservice.serviceid;
																				bigdata.name = catservice.description
																						+ " ("
																						+ catservice.amountoftime
																						+ ")";

																				myCars[cntr] = bigdata;
																				cntr = cntr + 1;
																			}
																		}
																		person = new Object();
																		person.items = myCars;
																		person.identifier = 'value';
																		person.label = 'description';
																		var pstore = new dojo.data.ItemFileReadStore(
																				{
																					'data' : person
																				});
																		var cwidget = registry
																				.byId("editselect");
																		if (editservicecounter != 0
																				&& cwidget) {
																			cwidget
																					.reset();
																			cwidget.store = pstore;
																		} else {
																			editservicecounter = editservicecounter + 1;
																		}

																	}
																}
															});

											var tabs = registry
													.byId("myTabContainer");
											tabs.startup();
											tabs.resize();
											dojo
													.connect(
															registry
																	.byId("myTabContainer"),
															"selectChild",
															function(page) {
																if (page.id == 'weekTab') {
																	//if(week_already_loaded == 'false'){
																	loadWeek();
																	//week_already_loaded = 'true';
																	//}
																}
																if (page.id == 'monthTab') {
																	//if(month_already_loaded == 'false'){
																	loadMonth();
																	//month_already_loaded = 'true';
																	//}
																}
																if (page.id == 'editTab') {

																	loadAgenda1();

																	loadAgenda2();

																	loadAgenda3();

																	loadAgenda4();

																	loadAgenda5();

																	loadAgenda6();

																	loadAgenda7();

																	loadAgenda8();

																	loadAgenda9();

																	loadAgenda10();

																	loadAgenda11();

																}
																if (page.id == 'createTab') {
																	loadCreate();
																}

															});
											init();

											dojo.parser.parse();

											dojo
													.connect(
															registry
																	.byId("staffgeneral"),
															"onChange",
															function(staff) {
																var staffselectwidget = registry
																		.byId("fapptstaff");
																staffselectwidget
																		.set(
																				"value",
																				staff);
																global_selected_staff = staff;

																var rawdate = registry
																		.byId(
																				"c_editselectdate")
																		.attr(
																				"value")
																var postdate = dojo.date.locale
																		.format(
																				rawdate,
																				{
																					datePattern : "yyyy-MM-dd",
																					selector : "date"
																				})
																displayEditTodaysAgenda(postdate);
																if ($(
																		'#monthcalendar')
																		.children().length > 0) {
																	loadMonth();
																}

																if ($(
																		'#agendaview1')
																		.children().length > 0) {
																	loadAgenda1();
																}

																if ($(
																		'#agendaview2')
																		.children().length > 0) {
																	loadAgenda2();
																}

																if ($(
																		'#agendaview3')
																		.children().length > 0) {
																	loadAgenda3();
																}

																if ($(
																		'#agendaview4')
																		.children().length > 0) {
																	loadAgenda4();
																}

																if ($(
																		'#agendaview5')
																		.children().length > 0) {
																	loadAgenda5();
																}

																if ($(
																		'#agendaview6')
																		.children().length > 0) {
																	loadAgenda6();
																}

																if ($(
																		'#agendaview7')
																		.children().length > 0) {
																	loadAgenda7();
																}

																if ($(
																		'#agendaview8')
																		.children().length > 0) {
																	loadAgenda8();
																}

																if ($(
																		'#agendaview9')
																		.children().length > 0) {
																	loadAgenda9();
																}

																if ($(
																		'#agendaview10')
																		.children().length > 0) {
																	loadAgenda10();
																}

																if ($(
																		'#agendaview11')
																		.children().length > 0) {
																	loadAgenda11();
																}

																if ($(
																		'#weekcalendar')
																		.children().length > 0) {
																	loadWeek();
																}
															});

											var widget = registry
													.byId("formapptservice");
											dojo.connect(widget, "onChange",
													function() {
														setEndTime();
													});

											dojo
													.connect(
															registry
																	.byId('desiredhour'),
															'onChange',
															function(value) {
																window.console
																		&& console
																				.log("ONCHANGE: desiredhour The begin hour change value is: "
																						+ value);
																//the user has selected a new item
																//update the end time, 
																// get amount time from service add to begin time set end time
																setEndTime();
															});
											dojo
													.connect(
															registry
																	.byId('desiredminute'),
															'onChange',
															function(value) {
																window.console
																		&& console
																				.log("ONCHANGE: desiredminute The begin minute change value is: "
																						+ value);
																//the user has selected a new item
																//update the end time, 
																// get amount time from service add to begin time set end time
																setEndTime();
															});
											dojo
													.connect(
															registry
																	.byId('desiredampm'),
															'onChange',
															function(value) {
																window.console
																		&& console
																				.log("ONCHANGE: desiredampm The begin ampm change value is: "
																						+ value);
																//the user has selected a new item
																//update the end time, 
																// get amount time from service add to begin time set end time
																setEndTime();
															});
											//for editapptdialog

											dojo
													.connect(
															registry
																	.byId('editselect'),
															'onChange',
															function(value) {
																window.console
																		&& console
																				.log("ONCHANGE: editselect: ");
																//the user has selected a new item
																//update the end time, 
																// get amount time from service add to begin time set end time
																setEditEndTime();
															});
											dojo
													.connect(
															registry
																	.byId('fedithour'),
															'onChange',
															function(value) {
																window.console
																		&& console
																				.log("ONCHANGE: fedithour The begin edit hour change value is: "
																						+ value);
																//the user has selected a new item
																//update the end time, 
																// get amount time from service add to begin time set end time
																var dothis = registry
																		.byId(
																				"isThisEditAgendaViewFlag")
																		.attr(
																				"value");
																//if(dothis == 'false'){
																setEditEndTime();
																//}

															});
											dojo
													.connect(
															registry
																	.byId('editminute'),
															'onChange',
															function(value) {
																window.console
																		&& console
																				.log("ONCHANGE: editminute The begin edit minute change value is: "
																						+ value);
																//the user has selected a new item
																//update the end time, 
																// get amount time from service add to begin time set end time
																var dothis = registry
																		.byId(
																				"isThisEditAgendaViewFlag")
																		.attr(
																				"value");
																//if(dothis == 'false'){
																setEditEndTime();
																//}
															});
											dojo
													.connect(
															registry
																	.byId('editampm'),
															'onChange',
															function(value) {
																window.console
																		&& console
																				.log("ONCHANGE: editampm The begin edit ampm change value is: "
																						+ value);
																//the user has selected a new item
																//update the end time, 
																// get amount time from service add to begin time set end time
																var dothis = registry
																		.byId(
																				"isThisEditAgendaViewFlag")
																		.attr(
																				"value");
																//if(dothis == 'false'){
																setEditEndTime();
																//}
															});
											dojo
													.connect(
															registry
																	.byId("every"),
															"onChange",
															function(isChecked) {
																if (isChecked) {
																	registry
																			.byId(
																					"everytext")
																			.set(
																					"disabled",
																					false);
																} else {
																	registry
																			.byId(
																					"everytext")
																			.set(
																					"disabled",
																					true);
																}
															});
											dojo
													.connect(
															registry
																	.byId("weeklyevery"),
															"onChange",
															function(isChecked) {
																if (isChecked) {
																	registry
																			.byId(
																					"weeklyeverytext")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyweekdaysu")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyweekdaymo")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyweekdaytu")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyweekdaywe")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyweekdaythu")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyweekdayfri")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyweekdaysat")
																			.set(
																					"disabled",
																					false);
																} else {
																	registry
																			.byId(
																					"weeklyeverytext")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyweekdaysu")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyweekdaymo")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyweekdaytu")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyweekdaywe")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyweekdaythu")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyweekdayfri")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyweekdaysat")
																			.set(
																					"disabled",
																					true);

																}
															});
											dojo
													.connect(
															registry
																	.byId("everyday"),
															"onChange",
															function(isChecked) {
																if (isChecked) {
																	registry
																			.byId(
																					"everymonthdaytext")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everymonthtext")
																			.set(
																					"disabled",
																					false);
																} else {
																	registry
																			.byId(
																					"everymonthdaytext")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everymonthtext")
																			.set(
																					"disabled",
																					true);
																}
															});
											dojo
													.connect(
															registry
																	.byId("everyregex"),
															"onChange",
															function(isChecked) {
																if (isChecked) {
																	registry
																			.byId(
																					"everynthdaytext")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everynthmonthtext")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyhowmanymonthtext")
																			.set(
																					"disabled",
																					false);
																} else {
																	registry
																			.byId(
																					"everynthdaytext")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everynthmonthtext")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyhowmanymonthtext")
																			.set(
																					"disabled",
																					true);
																}
															});
											dojo
													.connect(
															registry
																	.byId("endafter"),
															"onChange",
															function(isChecked) {
																if (isChecked) {
																	registry
																			.byId(
																					"endafterxoccur")
																			.set(
																					"disabled",
																					false);
																} else {
																	registry
																			.byId(
																					"endafterxoccur")
																			.set(
																					"disabled",
																					true);
																}
															});
											dojo
													.connect(
															registry
																	.byId("everydate"),
															"onChange",
															function(isChecked) {
																if (isChecked) {
																	registry
																			.byId(
																					"rangerecurEndDate")
																			.set(
																					"disabled",
																					false);
																} else {
																	registry
																			.byId(
																					"rangerecurEndDate")
																			.set(
																					"disabled",
																					true);
																}
															});
											dojo
													.connect(
															registry
																	.byId("enable_recur"),
															"onChange",
															function(isChecked) {
																window.console
																		&& console
																				.log("entered onchange for enable_recur");
																var container = dojo
																		.query(
																				'div',
																				'recur_div');
																if (isChecked) {
																	window.console
																			&& console
																					.log("entered isChecked. so enable all inputs");
																	registry
																			.byId(
																					"weekly")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"weeklyevery")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"daily")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"every")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyweekday")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"monthly")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyday")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everyregex")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"endafter")
																			.set(
																					"disabled",
																					false);
																	registry
																			.byId(
																					"everydate")
																			.set(
																					"disabled",
																					false);
																} else {
																	window.console
																			&& console
																					.log("entered isChecked false. so disable all inputs");
																	registry
																			.byId(
																					"weekly")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"weeklyevery")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"daily")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"every")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyweekday")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"monthly")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyday")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everyregex")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"endafter")
																			.set(
																					"disabled",
																					true);
																	registry
																			.byId(
																					"everydate")
																			.set(
																					"disabled",
																					true);
																}
															});

											loadAgenda1();

											var menu = new registry.Menu({
												style : "display: none;"
											});
											//images/circular icons/star_yellow.png
											var menuItem1 = new registry.MenuItem(
													{
														label : "Yellow Star",
														onClick : function() {
															registry
																	.byId(
																			"progButton")
																	.set(
																			"label",
																			"Yellow star");
															registry
																	.byId(
																			"progButton")
																	.set(
																			"value",
																			"yellow");
														}
													});
											menuItem1.iconNode.style.cssText = "background: url('images/circular icons/star_yellow.png') no-repeat;";
											menu.addChild(menuItem1);

											var menuItem2 = new registry.MenuItem(
													{
														label : "Red star",
														onClick : function() {
															registry
																	.byId(
																			"progButton")
																	.set(
																			"label",
																			"Red star");
															registry
																	.byId(
																			"progButton")
																	.set(
																			"value",
																			"red");
														}
													});
											menuItem2.iconNode.style.cssText = "background: url('images/circular icons/star_red.png') no-repeat;";

											menu.addChild(menuItem2);

											var button = new registry.form.DropDownButton(
													{
														label : "Select one",
														name : "programmatic2",
														dropDown : menu,
														id : "progButton"
													});
											dojo
													.byId(
															"dropdownButtonContainer")
													.appendChild(button.domNode);

											var cal = $('#jCalTarget')
													.jCal(
															{
																day : new Date(),
																days : 1,
																showMonths : 2,
																monthSelect : true,
																callback : function(
																		day,
																		days) {
																	window.console
																			&& console
																					.log('selected '
																							+ days
																							+ ' days starting '
																							+ day);
																	jCalOnClick(day);
																}
															});
											var clickthisdate = new Date();
											var month = clickthisdate
													.getMonth();
											month = month + 1;
											var day = clickthisdate.getDate();

											var fyear = clickthisdate
													.getFullYear();
											window.console
													&& console.log('' + month
															+ '_' + day + '_'
															+ fyear);
											$(
													'#c2d_' + month + '_' + day
															+ '_' + fyear)
													.click();
										});
									});
							function jCalOnClick(day) {
								jCalTargetValue = day;
								loadAgenda1(day);
							}
							function setEditEndTimeNoPost(svcvalue) {
								var total = svcvalue;
								var hr = dijit.byId('fedithour').value;
								var min = dijit.byId('editminute').value;
								var ampm = dijit.byId('editampm').value;
								if (hr == 12) {
									if (ampm == 'am') {
										hr = parseInt('0');
									} else {
										hr = parseInt('12');
									}
								} else if (ampm == 'pm') {
									hr = parseInt(hr) + 12;
								}

								window.console
										&& console.log("end hour: " + hr);
								window.console
										&& console.log("end min: " + min);
								window.console
										&& console.log("end ampm: " + ampm);
								var rawdate = dijit.byId("c_editselectdate")
										.attr("value")
								var d = rawdate.getDate();
								var m = rawdate.getMonth();
								var y = rawdate.getFullYear();
								window.console && console.log("raw day: " + d);
								window.console
										&& console.log("raw month: " + m);
								window.console && console.log("raw year: " + y);

								var temp_hour_min = total * 60;//gives seconds
								var tmphr = Math.floor(temp_hour_min / 3600);
								var tmpmn = Math
										.floor((temp_hour_min % 3600) / 60);

								var d = new Date(y, m, d, hr, min, 0, 0);
								var newDateObj = new Date(d.getTime() + total
										* 60000);

								var endhour = newDateObj.getHours();
								var endmin = newDateObj.getMinutes();
								window.console
										&& console
												.log("setEditEndTimeNoPost revised end hour: "
														+ endhour);
								window.console
										&& console
												.log("setEditEndTimeNoPost revised end min: "
														+ endmin);
								var eap = "am";
								if (endhour > 11) {
									eap = "pm";
								}
								if (endhour > 12) {
									endhour = endhour - 12;
								}
								if (endhour == 0) {
									endhour = 12;
								}
								window.console
										&& console.log("2 revised end ampm: "
												+ eap);
								var ehr = dijit.byId('fendedithour');
								ehr.setValue(endhour);
								var emin = dijit.byId('endeditminute');
								if (endmin == "0") {
									endmin = "00";
								}
								emin.setValue(endmin);
								var eampm = dijit.byId('endeditampm');
								eampm.setValue(eap.toLowerCase());
							}
							function setEditEndTime() {
								if (StillNeedsValidating == false) {
									StillNeedsValidating = true;
									return;
								}
								if (dijit.byId('editselect')) {
									var svcid = dijit.byId('editselect').attr(
											"value");
									var srvtime = dijit.byId('editselect')
											.attr("displayedValue");
									var dopost = false;

									if (svcid != "") {
										if (dopost) {
											var deferred = dojo
													.xhrPost({
														url : "myschedule/svctime",
														content : {
															id : svcid,
														},
														handleAs : "json",
														load : function(
																response) {
															window.console
																	&& console
																			.log("SUCCESS FROM GET SERVICE TIME");
															var total = response.amounttime;
															var hr = dijit
																	.byId('fedithour').value;
															var min = dijit
																	.byId('editminute').value;
															var ampm = dijit
																	.byId('editampm').value;
															if (hr == 12) {
																if (ampm == 'am') {
																	hr = parseInt('0');
																} else {
																	hr = parseInt('12');
																}
															} else if (ampm == 'pm') {
																hr = parseInt(hr) + 12;
															}

															window.console
																	&& console
																			.log("end hour: "
																					+ hr);
															window.console
																	&& console
																			.log("end min: "
																					+ min);
															window.console
																	&& console
																			.log("end ampm: "
																					+ ampm);
															var rawdate = dijit
																	.byId(
																			"c_editselectdate")
																	.attr(
																			"value")
															var d = rawdate
																	.getDate();
															var m = rawdate
																	.getMonth();
															var y = rawdate
																	.getFullYear();
															window.console
																	&& console
																			.log("raw day: "
																					+ d);
															window.console
																	&& console
																			.log("raw month: "
																					+ m);
															window.console
																	&& console
																			.log("raw year: "
																					+ y);

															var temp_hour_min = total * 60;//gives seconds
															var tmphr = Math
																	.floor(temp_hour_min / 3600);
															var tmpmn = Math
																	.floor((temp_hour_min % 3600) / 60);

															var d = new Date(y,
																	m, d, hr,
																	min, 0, 0);
															var newDateObj = new Date(
																	d.getTime()
																			+ total
																			* 60000);

															var endhour = newDateObj
																	.getHours();
															var endmin = newDateObj
																	.getMinutes();
															window.console
																	&& console
																			.log("setEditEndTime revised end hour: "
																					+ endhour);
															window.console
																	&& console
																			.log("setEditEndTime revised end min: "
																					+ endmin);
															var eap = "am";
															if (endhour > 11) {
																eap = "pm";
															}
															if (endhour > 12) {
																endhour = endhour - 12;
															}
															if (endhour == 0) {
																endhour = 12;
															}
															window.console
																	&& console
																			.log("2 revised end ampm: "
																					+ eap);
															var ehr = dijit
																	.byId('fendedithour');
															ehr
																	.setValue(endhour);
															var emin = dijit
																	.byId('endeditminute');
															if (endmin == "0") {
																endmin = "00";
															}
															emin
																	.setValue(endmin);
															var eampm = dijit
																	.byId('endeditampm');
															eampm
																	.setValue(eap
																			.toLowerCase());
														},
														error : function(error) {
															svcstandbydlg
																	.hide();
															window.console
																	&& console
																			.log("ERROR FROM GET SERVICE TIME");
															window.console
																	&& console
																			.log(error);
															window.location
																	.reload();
														}
													});
										} else {
											var servicecoln2 = srvtime
													.indexOf('(');
											var servicecoln3 = srvtime
													.indexOf(')');
											var servicetime = srvtime
													.substring(
															servicecoln2 + 1,
															servicecoln3);

											setEditEndTimeNoPost(servicetime);

											var editdialogpricewdget = dijit
													.byId('editdialogprice');
											var editdialogapptidwdget = dijit
													.byId('editdialogapptid');
											var customprice;
											if (editdialogapptidwdget != null) {
												var apptid = editdialogapptidwdget
														.attr("value")
												customprice = getCustomPriceForService(
														svcid, apptid);
												window.console
														&& console
																.log("customprice: "
																		+ customprice);
											}
											var price = getPriceForService(svcid);
											if (customprice != null) {
												price = customprice;
											}
											window.console
													&& console
															.log("SETTING PRICE FOR SERVICE: "
																	+ price);
											editdialogpricewdget.set("value",
													formatCurrency(price));

										}
									}
								}
							}

							function getCustomPriceForService(svcid, apptid) {
								if (customServicesPricesArray.length > 0) {
									for ( var key in customServicesPricesArray) {
										var findservice = customServicesPricesArray[key];
										if (findservice.serviceid == svcid
												&& findservice.appointmentid == apptid) {
											return findservice.cost;
										}
									}
								}

							}
							function updateCustomPriceForService(svcid, apptid,
									cost) {
								if (customServicesPricesArray.length > 0) {
									for ( var key in customServicesPricesArray) {
										var findservice = customServicesPricesArray[key];
										if (findservice.serviceid == svcid
												&& findservice.appointmentid == apptid) {
											findservice.cost = cost;
											;
										}
									}
								}

							}

							function getPriceForService(id) {
								if (servicespricesArray.length > 0) {
									for ( var key in servicespricesArray) {
										var findservice = servicespricesArray[key];
										if (findservice.serviceid == id) {
											return findservice.cost;
										}
									}
								}

							}
							function setEndTimeNoPost(svcid) {
								if (servicesArray.length > 0) {
									for ( var key in servicesArray) {
										var findservice = servicesArray[key];
										if (findservice.serviceid == svcid) {
											var total = findservice.amountoftime;
											var hr = dijit.byId('desiredhour').value;
											var min = dijit
													.byId('desiredminute').value;
											var ampm = dijit
													.byId('desiredampm').value;

											if (hr == 12) {
												if (ampm == 'am') {
													hr = parseInt('0');
												} else {
													hr = parseInt('12');
												}
											} else if (ampm == 'pm') {
												hr = parseInt(hr) + 12;
											}
											window.console
													&& console
															.log("setEndTimeNoPost end hour: "
																	+ hr);
											window.console
													&& console
															.log("setEndTimeNoPost end min: "
																	+ min);
											window.console
													&& console
															.log("setEndTimeNoPost end ampm: "
																	+ ampm);
											var rawdate = dijit.byId(
													"c_editselectdate").attr(
													"value")
											var d = rawdate.getDate();
											var m = rawdate.getMonth();
											var y = rawdate.getFullYear();
											window.console
													&& console
															.log("setEndTimeNoPost raw day: "
																	+ d);
											window.console
													&& console
															.log("setEndTimeNoPost raw month: "
																	+ m);
											window.console
													&& console
															.log("setEndTimeNoPost raw year: "
																	+ y);

											var temp_hour_min = total * 60;//gives seconds
											var tmphr = Math
													.floor(temp_hour_min / 3600);
											var tmpmn = Math
													.floor((temp_hour_min % 3600) / 60);

											var d = new Date(y, m, d, hr, min,
													0, 0);
											var newDateObj = new Date(d
													.getTime()
													+ total * 60000);

											var endhour = newDateObj.getHours();
											var endmin = newDateObj
													.getMinutes();
											var eap = "am";
											if (endhour > 11) {
												eap = "pm";
											}
											if (endhour > 12) {
												endhour = endhour - 12;
											}
											if (endhour == 0) {
												endhour = 12;
											}
											window.console
													&& console
															.log("setEndTimeNoPost revised end hour: "
																	+ endhour);
											window.console
													&& console
															.log("setEndTimeNoPost revised end min: "
																	+ endmin);
											window.console
													&& console
															.log("1 revised end ampm: "
																	+ eap);
											var ehr = dijit
													.byId('desiredehour');
											ehr.setValue(endhour);
											var emin = dijit
													.byId('desiredeminute');
											if (endmin == "0") {
												endmin = "00";
											}
											emin.setValue(endmin);
											var eampm = dijit
													.byId('desiredeampm');
											eampm.setValue(eap);
										}
									}
								}
							}
							function setEndTime() {
								var donopost = true;
								var svcid = dijit.byId('formapptservice').attr(
										"value");
								if (donopost) {
									setEndTimeNoPost(svcid);
								} else {
									standby.show();
									var deferred = dojo
											.xhrPost({
												url : "myschedule/svctime",
												content : {
													id : svcid,
												},
												handleAs : "json",
												load : function(response) {
													window.console
															&& console
																	.log("SUCCESS FROM GET SERVICE TIME");
													var total = response.amounttime;
													var hr = dijit
															.byId('desiredhour').value;
													var min = dijit
															.byId('desiredminute').value;
													var ampm = dijit
															.byId('desiredampm').value;
													if (hr == 12) {
														if (ampm == 'am') {
															hr = parseInt('0');
														} else {
															hr = parseInt('12');
														}
													} else if (ampm == 'pm') {
														hr = parseInt(hr) + 12;
													}
													window.console
															&& console
																	.log("end hour: "
																			+ hr);
													window.console
															&& console
																	.log("end min: "
																			+ min);
													window.console
															&& console
																	.log("end ampm: "
																			+ ampm);
													var rawdate = dijit.byId(
															"c_editselectdate")
															.attr("value")
													var d = rawdate.getDate();
													var m = rawdate.getMonth();
													var y = rawdate
															.getFullYear();
													window.console
															&& console
																	.log("raw day: "
																			+ d);
													window.console
															&& console
																	.log("raw month: "
																			+ m);
													window.console
															&& console
																	.log("raw year: "
																			+ y);

													var temp_hour_min = total * 60;//gives seconds
													var tmphr = Math
															.floor(temp_hour_min / 3600);
													var tmpmn = Math
															.floor((temp_hour_min % 3600) / 60);

													var d = new Date(y, m, d,
															hr, min, 0, 0);
													var newDateObj = new Date(d
															.getTime()
															+ total * 60000);

													var endhour = newDateObj
															.getHours();
													var endmin = newDateObj
															.getMinutes();
													var eap = "am";
													if (endhour > 11) {
														eap = "pm";
													}
													if (endhour > 12) {
														endhour = endhour - 12;
													}
													if (endhour == 0) {
														endhour = 12;
													}
													window.console
															&& console
																	.log("setEndTime revised end hour: "
																			+ endhour);
													window.console
															&& console
																	.log("setEndTime revised end min: "
																			+ endmin);
													window.console
															&& console
																	.log("1 revised end ampm: "
																			+ eap);
													var ehr = dijit
															.byId('desiredehour');
													ehr.setValue(endhour);
													var emin = dijit
															.byId('desiredeminute');
													if (endmin == "0") {
														endmin = "00";
													}
													emin.setValue(endmin);
													var eampm = dijit
															.byId('desiredeampm');
													eampm.setValue(eap);
													standby.hide();
												},
												error : function(error) {
													window.console
															&& console
																	.log("ERROR FROM GET SERVICE TIME");
													window.console
															&& console
																	.log(error);
													standby.hide();
													window.location.reload();
												}
											});
								}
							}
							function displayPersonalDialog(id, edit) {
								dijit.byId("isThisAgendaViewFlag").set("value",
										"false");
								var newValue = dijit.byId("c_editselectdate")
										.attr("value");
								var timeblockwidget = dijit
										.byId("c_personalselectdate");
								window.console
										&& console.log("newValue " + newValue);
								var dayte = "";
								try {
									window.console
											&& console.log("newValue: "
													+ newValue);
									dayte = dojo.date.locale.format(newValue, {
										datePattern : "yyyy-MM-dd",
										selector : "date"
									});
								} catch (err) {
									window.console
											&& console
													.log("could not format the newValue date: "
															+ err);
									dayte = newValue;
								}
								document.getElementById("hPersonalSelectDate").value = dayte;
								timeblockwidget.set("value", newValue);
								if (edit == true) {
									standbydlg = new dojox.widget.Standby({
										target : "personalDialog"
									});
									document.body
											.appendChild(standbydlg.domNode);
									standbydlg.show();

									$('#updatepersonalbutton').show();
									$('#savepersonalbutton').hide();
									// grab the personl appointment and fill via json and ajax

									var deferred = dojo
											.xhrGet({
												url : "myschedule/appt?apptid="
														+ id,
												handleAs : "text",
												preventCache : true,
												load : function(response,
														newValue) {

													// handle response codes
													// do something with returned data
													//window.console && console.log("the appointment object returned: "+response);
													var isJSON;
													var data;
													try {
														data = JSON
																.parse(response);
														isJSON = true;
													} catch (e) {
														isJSON = false;
													}

													if (isJSON) {
														// data is already parsed, so just use it
														// handle response codes
														// do something with returned data

														if (data.constructor == Array) {

															for ( var key in data) {
																var status = data[key].status;
																var firstname = "";
																var lastname = "";
																if (data[key].client != null) {
																	firstname = data[key].client.firstName;
																	lastname = data[key].client.lastName;
																}

																var sbeginetimex = data[key].s_beginDateTime;

																var sendetimex = data[key].s_endDateTime;

																var iscancelled = false;
																if (data[key].cancelled == null
																		|| data[key].cancelled == 'false') {
																	iscancelled = false;
																} else {
																	iscancelled = data[key].cancelled;
																}
																var apptdate = new Date(
																		data[key].appointmentDate);
																var yearapptdate = apptdate
																		.getFullYear();
																var monthapptdate = apptdate
																		.getMonth() + 1;
																var dayapptdate = apptdate
																		.getDate();

																var endtime = new Date(
																		data[key].endDateTime.time);
																var endhour = endtime
																		.getHours();
																var endmin = endtime
																		.getMinutes();
																var eap = "am";
																if (endhour > 11) {
																	eap = "pm";
																}
																if (endhour > 12) {
																	endhour = endhour - 12;
																}
																if (endhour == 0) {
																	endhour = 12;
																}

																var begintime = new Date(
																		data[key].beginDateTime.time);
																var beginhour = begintime
																		.getHours();
																var beginmin = begintime
																		.getMinutes();
																var ap = "am";
																if (beginhour > 11) {
																	ap = "pm";
																}
																if (beginhour > 12) {
																	beginhour = beginhour - 12;
																}
																if (beginhour == 0) {
																	beginhour = 12;
																}

																var staffforappt = data[key].staff.id;
																var staffwidget = dijit
																		.byId("fapptstaff_personal");
																if (staffwidget) {
																	window.console
																			&& console
																					.log("STAFF FOR APPT IS: "
																							+ staffforappt);
																	staffwidget
																			.set(
																					"value",
																					staffforappt);
																}

																var fwidget = dijit
																		.byId("personalhour");
																var coln = sbeginetimex
																		.indexOf(':');
																beginhour = sbeginetimex
																		.substring(
																				0,
																				coln);
																if (fwidget) {

																	fwidget
																			.setValue(beginhour);
																}

																var editmin = dijit
																		.byId("personalminute");
																beginmin = sbeginetimex
																		.substring(
																				coln + 1,
																				coln + 3);
																if (beginmin == 0) {
																	beginmin = '00';
																}
																if (editmin) {
																	editmin
																			.setValue(new String(
																					beginmin));
																}
																var editampm = dijit
																		.byId("personalampm");
																ap = sbeginetimex
																		.substring(
																				sbeginetimex.length,
																				sbeginetimex.length - 2);
																if (editampm) {
																	editampm
																			.setValue(ap
																					.toLowerCase());
																}

																// end time
																var fewidget = dijit
																		.byId("personalendhour");
																var coln = sendetimex
																		.indexOf(':');
																endhour = sendetimex
																		.substring(
																				0,
																				coln);
																if (fewidget) {

																	fewidget
																			.setValue(endhour);
																}

																var endeditmin = dijit
																		.byId("personalendminute");
																endmin = sendetimex
																		.substring(
																				coln + 1,
																				coln + 3);
																if (endmin == 0) {
																	endmin = '00';
																}
																if (endeditmin) {
																	endeditmin
																			.setValue(new String(
																					endmin));
																}
																var endeditampm = dijit
																		.byId("personalendampm");
																eap = sendetimex
																		.substring(
																				sendetimex.length,
																				sendetimex.length - 2);
																if (endeditampm) {
																	endeditampm
																			.setValue(eap
																					.toLowerCase());
																}

																var dsrvselect = '';
																dsrvselect = 'editselect';

																var id = "0";
																id = data[key].id;

																var notes = "";
																if (data[key].notes == null) {
																} else {
																	notes = unescape(data[key].notes);
																}

																var personallabel = "";
																if (data[key].personallabel == null) {
																} else {
																	personallabel = data[key].personallabel;
																}
																var personreason = '';
																personreason = 'personalreason';
																var prd = dijit
																		.byId(personreason);
																prd
																		.set(
																				"value",
																				personallabel);

																var dapptid = '';
																dapptid = 'editpersonalapptid';

																var d = dijit
																		.byId(dapptid);
																d.set("value",
																		id);

																var dno = '';
																dno = 'personalnotes';

																var dnotes = dojo
																		.byId(dno);
																dnotes.value = notes;
															}
														} else {
															sometext = data[0].description;
															window.console
																	&& console
																			.log(sometext);
														}
													} else {
														// try treating it as XML
													}
													standbydlg.hide();
													return response;
												},
												error : function(error) {
													window.console
															&& console
																	.log("An unexpected error occurred: "
																			+ error);
													standbydlg.hide();
													window.location.reload();
												}
											});

								} else {
									$('#updatepersonalbutton').hide();
									$('#savepersonalbutton').show();
									dijit.byId('personalDialog').reset();
								}
								dijit.byId('personaledit').set("value", edit);
								dijit.byId('personalDialog').show();

							}
							function displayPersonalDialogForFCCalendar(event,
									edit) {
								var id = event.staffid;
								var newValue = event.appointmentdate;
								var status = event.appointmentstatus;
								var timeblockwidget = dijit
										.byId("c_personalselectdate");
								dijit.byId("isThisAgendaViewFlag").set("value",
										"true");
								var dayte = "";
								try {
									dayte = dojo.date.locale.format(newValue, {
										datePattern : "yyyy-MM-dd",
										selector : "date"
									});
								} catch (err) {
									dayte = newValue;
								}
								document.getElementById("hPersonalSelectDate").value = dayte;
								timeblockwidget.set("value", newValue);
								if (edit == true) {
									$('#updatepersonalbutton').show();
									$('#savepersonalbutton').hide();
									var status = event.appointmentstatus;
									var firstname = "";
									var lastname = "";
									if (event.clientid != '') {
										firstname = event.clientfirstname;
										lastname = event.clientlastname;
									}

									var iscancelled = false;
									if (status != 'CANCELED') {
										iscancelled = false;
									} else {
										iscancelled = true;
									}

									var apptdate = event.appointmentdate;
									var yearapptdate = apptdate.getFullYear();
									var monthapptdate = apptdate.getMonth() + 1;
									var dayapptdate = apptdate.getDate();

									var endhour = event.endhour;
									var endmin = event.endmin;
									var eap = "am";
									if (endhour > 11) {
										eap = "pm";
									}
									if (endhour > 12) {
										endhour = endhour - 12;
									}
									if (endhour == 0) {
										endhour = 12;
									}

									var beginhour = event.beginhour;
									var beginmin = event.beginmin;
									var ap = event.beginampm

									var staffforappt = event.staffid;
									var staffwidget = dijit
											.byId("fapptstaff_personal");
									if (staffwidget) {
										staffwidget.set("value", staffforappt);
									}

									var fwidget = dijit.byId("personalhour");
									beginhour = event.beginhour;
									if (fwidget) {
										fwidget.setValue(beginhour);
									}

									var editmin = dijit.byId("personalminute");
									if (editmin) {
										editmin.setValue(new String(beginmin));
									}
									var editampm = dijit.byId("personalampm");
									ap = event.beginampm;
									if (editampm) {
										editampm.setValue(ap.toLowerCase());
									}

									// end time
									var fewidget = dijit
											.byId("personalendhour");
									endhour = event.endhour;
									if (fewidget) {
										fewidget.setValue(endhour);
									}

									var endeditmin = dijit
											.byId("personalendminute");
									endmin = event.endmin;
									if (endeditmin) {
										endeditmin.setValue(new String(endmin));
									}
									var endeditampm = dijit
											.byId("personalendampm");
									eap = event.endampm;
									if (endeditampm) {
										endeditampm.setValue(eap.toLowerCase());
									}

									var dsrvselect = '';
									dsrvselect = 'editselect';

									var id = "0";
									id = event.appointmentid;

									var notes = "";
									if (event.appointmentnotes == null) {
									} else {
										notes = event.appointmentnotes;
									}

									var personallabel = "";
									if (event.personallabel == null) {
									} else {
										personallabel = event.personallabel;
									}
									var personreason = '';
									personreason = 'personalreason';
									var prd = dijit.byId(personreason);
									prd.set("value", personallabel);

									var dapptid = '';
									dapptid = 'editpersonalapptid';

									var d = dijit.byId(dapptid);
									d.set("value", id);

									var dno = '';
									dno = 'personalnotes';

									var dnotes = dojo.byId(dno);
									dnotes.value = notes;
								} else {
									$('#updatepersonalbutton').hide();
									$('#savepersonalbutton').show();
									dijit.byId('personalDialog').reset();
								}
								dijit.byId('personaledit').set("value", edit);
								dijit.byId('personalDialog').show();

							}
							function init() {
								standby = new dojox.widget.Standby({
									target : "myTabContainer"
								});
								document.body.appendChild(standby.domNode);
								//standby.show();
								setInterval(function() {
									isAlive();
								}, 660000); //11 minutes 660000				      
							}
							define(
									[ 'dojo/_base/lang', 'dojo/_base/declare',
											'dojo/dom-construct',
											'dojo/_base/Deferred',
											'dijit/Dialog',
											'dijit/form/Button',
											'dijit/form/CheckBox' ],
									function(lang, declare, construct,
											Deferred, Dialog, Button, CheckBox) {

										return declare(
												'snet.DialogConfirm',
												Dialog,
												{
													okButton : null,
													cancelButton : null,
													skipCheckBox : null,
													hasOkButton : true,
													hasCancelButton : true,
													hasSkipCheckBox : true,
													hasUnderlay : true,
													dfd : null,

													/**
													 * Instantiates the confirm dialog.
													 */
													constructor : function(
															props) {
														lang.mixin(this, props);
													},

													/**
													 * Creates the OK/Cancel buttons.
													 */
													postCreate : function() {
														this.inherited(
																'postCreate',
																arguments);

														var remember = false;
														var div = construct
																.create(
																		'div',
																		{
																			className : 'dialogConfirmButtons'
																		},
																		this.containerNode,
																		'last');
														if (this.hasSkipCheckBox) {
															this.skipCheckBox = new CheckBox(
																	{
																		checked : false
																	},
																	construct
																			.create('div'));
															div
																	.appendChild(this.skipCheckBox.domNode);
															var label = construct
																	.create(
																			'label',
																			{
																				'for' : this.skipCheckBox.id,
																				innerHTML : 'Remember my decision and do not ask again.<br />'
																			},
																			div);
														}
														if (this.hasOkButton) {
															this.okButton = new Button(
																	{
																		label : 'OK',
																		onClick : lang
																				.hitch(
																						this,
																						function() {
																							remember = this.hasSkipCheckBox ? this.skipCheckBox
																									.get('checked')
																									: false;
																							this
																									.hide();
																							this.dfd
																									.resolve(remember);
																						})
																	},
																	construct
																			.create('div'));
															div
																	.appendChild(this.okButton.domNode);
														}
														if (this.hasCancelButton) {
															this.cancelButton = new Button(
																	{
																		label : 'Cancel',
																		onClick : lang
																				.hitch(
																						this,
																						function() {
																							remember = this.hasSkipCheckBox ? this.skipCheckBox
																									.get('checked')
																									: false;
																							this
																									.hide();
																							this.dfd
																									.cancel(remember);
																						})
																	},
																	construct
																			.create('div'));
															div
																	.appendChild(this.cancelButton.domNode);
														}
													},

													/**
													 * Shows the dialog.
													 * @return {dojo/_base/Deferred}
													 */
													show : function() {
														this.inherited('show',
																arguments);
														if (!this.hasUnderlay) {
															construct
																	.destroy(this.id
																			+ '_underlay');
														}
														this.dfd = new Deferred();
														return this.dfd;
													}
												});
									});
						</script>
					</div>
				</fieldset>
				<div style="display: none" title="fidget" dojoType="dijit.Dialog"
					id="id_dialog">
					<div style="width: 300px; height: 150px">
						<div id="id_dialog_text" /></div>
						<div class="dijitDialogPaneActionBar">
							<button id="id_dialog_button_1" type="submit"
								dojoType="dijit.form.Button">Yes</button>
							<button id="id_dialog_button_2"
								onClick="dijit.byId('id_dialog').onCancel();" type="button"
								dojoType="dijit.form.Button">Cancel</button>
						</div>
					</div>
					<div style="height: 166px; width: 250px; display: none"
						execute="addClient(arguments[0]);" title="Add client"
						id="addClientDialog" dojoType="dijit.Dialog">
						<div>
							<label for="_firstname_dlg">First name:</label>
						</div>
						<br />
						<div>
							<div required="true" id="firstname_dlg"
								dojoType="dijit.form.ValidationTextBox">
								<script args="event" event="onKeyPress" type="dojo/connect">
								var firstname = dijit.byId('firstname_dlg').attr("value");
								dijit.byId('firstname_dlg').set("value", toTitleCase(firstname)); 
							</script>
							</div>
						</div>
						<div>
							<label for="_lastname_dlg">Last name:</label>
						</div>
						<br />
						<div>
							<div required="true" id="lastname_dlg"
								dojoType="dijit.form.ValidationTextBox">
								<script args="event" event="onKeyPress" type="dojo/connect">
								var lastname = dijit.byId('lastname_dlg').attr("value");
								dijit.byId('lastname_dlg').set("value", toTitleCase(lastname)); 
							</script>
							</div>
						</div>
						<div>
							<label for="_home_phonenumber_dlg">H. Ph.:</label>
						</div>
						<div>
							<div required="false" id="home_phonenumber_dlg"
								dojoType="dijit.form.ValidationTextBox" /></div>
							<button
								onClick="if(dijit.byId('addClientDialog').validate()){saveAddDialog();dijit.byId('addClientDialog').hide();}"
								type="button" dojoType="dijit.form.Button">Save</button>
						</div>
					</div>
					<div version="2.0" id="footer">
						<a href="/shop/">Home</a><span />
						<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-40547165-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
					</div>
				</div>
			</div>
			</